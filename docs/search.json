[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Theory of Potential Field Methods in Geophysics",
    "section": "",
    "text": "Prerequisites\nHere are the lecture notes for the 2025/2026 module covering the Theory of Potential Field Methods. These notes are tailored for Master’s students of Geophysics and Geoinformatics at the Institute of Geophysics and Geoinformatics, TU Bergakademie Freiberg.\nYou can access all the materials on the GitHub repository https://github.com/ruboerner/Potential_Theory.\nEnjoy studying!",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "index.html#background",
    "href": "index.html#background",
    "title": "Theory of Potential Field Methods in Geophysics",
    "section": "Background",
    "text": "Background\nThis course targets Master’s students in their first semester, with a recommended understanding of fundamental potential field applications, such as Gravity, Magnetics, and DC resistivity methods. Additionally, prior completion of the Theoretical Physics – Electrodynamics course is strongly advised as a prerequisite for this lecture.",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "index.html#code",
    "href": "index.html#code",
    "title": "Theory of Potential Field Methods in Geophysics",
    "section": "Code",
    "text": "Code\nThe website’s course material includes sections with embedded Python code.\nYou can easily copy the code and execute it in a compatible Python runtime environment.\nFor an optimal experience, we recommend installing Python via miniforge.\nMoreover, you have the freedom to explore your own concepts and delve deeper into the course content by creating your personalized Jupyter notebooks. You can utilize any of the following platforms:\n\nVisual Studio Code\nJupyterlab\nQuarto\nmarimo.\n\nWorking with Jupyter Notebooks in Visual Studio Code is exceptionally straightforward.",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "index.html#self-study",
    "href": "index.html#self-study",
    "title": "Theory of Potential Field Methods in Geophysics",
    "section": "Self study",
    "text": "Self study\nThere are individual small tasks for self-study that are scattered throughout the lecture.\n\n\n\n\n\n\nNoneSelf study\n\n\n\nYou can easily identify these callouts.",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "index.html#recommended-reading",
    "href": "index.html#recommended-reading",
    "title": "Theory of Potential Field Methods in Geophysics",
    "section": "Recommended Reading",
    "text": "Recommended Reading\nThe most important source of supplementary information is the book by Blakely (1995).",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "index.html#license",
    "href": "index.html#license",
    "title": "Theory of Potential Field Methods in Geophysics",
    "section": "License",
    "text": "License\nThis material is licensed under a Creative Commons License.\n\n\n\n\nBlakely, R.J., 1995. Potential Theory in Gravity and Magnetic Applications, 1st ed., Cambridge University Press. doi:10.1017/CBO9780511549816",
    "crumbs": [
      "Prerequisites"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "1.1 Why is Potential Theory important?\nThese lecture notes cover the following topics:\nWe will discover problems such as\nPotential theory is essential in geophysics because it provides a mathematical framework for understanding and analyzing natural physical fields, such as gravity and magnetism, that originate from the Earth’s subsurface. These fields are governed by the principles of potential theory, allowing geophysicists to interpret variations in these fields to infer the distribution of subsurface properties like density and magnetization. Potential theory forms the basis for various geophysical methods, such as gravity and magnetic surveys, which are non-invasive and cost-effective techniques for exploring natural resources, studying tectonic structures, and assessing geological hazards. Its mathematical tools, like Laplace’s and Poisson’s equations, also facilitate solving complex inverse problems to reconstruct the hidden subsurface structures from field data.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#what-are-fields",
    "href": "intro.html#what-are-fields",
    "title": "1  Introduction",
    "section": "1.2 What are fields?",
    "text": "1.2 What are fields?\nIn physics and geophysics, a field refers to a physical quantity that has a value at every point in space and time. Fields can be scalar, vector, or tensor quantities, depending on their nature. For example, temperature is a scalar field, while gravitational and magnetic fields are vector fields, meaning they have both magnitude and direction at each point. Fields represent how forces, like gravity or magnetism, extend through space and interact with matter. In geophysics, fields are used to describe the behavior of, e.g., Earth’s gravity and magnetic forces, which can be measured to study the properties of the subsurface.\nWe depart from a very general idea of a field:\nA field describes the spatial distribution of a physical quantity. Such quantities can be\n\npressure, density, temperature\nacceleration, velocity, flux, electric field, magnetic flux density, etc.\n\nWe observe an important difference between the two examples.\nThe first examples are representatives of scalar fields, while the second examples represent vector fields.\nScalar fields can be visualized by isoline maps.\nVector fields can be visualized by arrows or field lines.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#definitions",
    "href": "intro.html#definitions",
    "title": "1  Introduction",
    "section": "1.3 Definitions",
    "text": "1.3 Definitions\nPotential field methods are fundamental in geophysics for studying Earth’s subsurface using measurements of physical fields like gravity and magnetism. These methods often rely on solving potential field equations to interpret subsurface structures or properties.\n\n1.3.1 The Scalar Potential Function\n\nPotential Field: A potential field \\(\\mathbf{F}(\\mathbf{r})\\) is a vector field to which a scalar field \\(\\Phi(\\mathbf{r})\\) exists such that:\n\\[\n\\mathbf{F}(\\mathbf{r}) = -\\grad \\Phi(\\mathbf{r})\n\\] where \\(\\mathbf{F}(\\mathbf{r})\\) represents the force field (e.g., gravitational or magnetic), and \\(\\grad \\Phi(\\mathbf{r})\\) is the gradient of the potential function. \\(\\mathbf{F}(\\mathbf{r})\\) is also called gradient field or conservative vector field.\nGravitational Potential \\(\\Phi_g\\): The gravitational potential \\(\\Phi_g\\) at a point \\(\\mathbf{r}\\) due to a mass distribution \\(\\rho(\\mathbf{r})\\) is given by: \\[\n\\Phi_g(\\mathbf{r}) = f \\int_V \\frac{\\rho(\\mathbf{r'})}{|\\mathbf{r} - \\mathbf{r'}|} \\dd V'\n\\] where \\(f\\) is the gravitational constant, \\(\\rho(\\mathbf{r'})\\) is the density at point \\(\\mathbf{r'}\\), and \\(\\dd V'\\) is the volume element.\nMagnetic Scalar Potential \\(\\Phi_m\\): In the absence of currents, the magnetic field \\(\\mathbf{B}\\) can be represented by a magnetic scalar potential: \\[\n\\mathbf{B} = -\\grad \\Phi_m\n\\] where \\(\\Phi_m\\) is analogous to the gravitational potential.\n\n\n\n1.3.2 Laplace’s Equation\n\nIn regions where there are no sources (e.g., mass or magnetic charge), the potential satisfies Laplace’s equation: \\[\n\\laplacian \\Phi = 0\n\\] Laplace’s equation is central to potential field methods because it defines how potential behaves in source-free regions, like in free space above the Earth’s surface in gravity or magnetic surveys.\n\n\n\n1.3.3 Poisson’s Equation\n\nWhen sources are present (mass or magnetization), the potential satisfies Poisson’s equation:\n\nGravitational Potential: \\[\n\\laplacian \\Phi_g = 4\\pi f \\rho\n\\]\nMagnetic Potential: \\[\n\\laplacian \\Phi_m = -\\mu_0 \\div \\mathbf{M}\n\\] where \\(\\rho\\) is the density, \\(\\mu_0\\) is the magnetic permeability, and \\(\\mathbf{M}\\) is the magnetization.\n\n\n\n\n1.3.4 Boundary Conditions\n\nSolutions to the potential field equations must satisfy boundary conditions that depend on the physical properties of the medium and the field.\n\nFor gravity, the potential at infinity often approaches zero: \\[\n\\Phi_g(\\infty) = 0\n\\]\nFor the magnetic field, the tangential components of \\(\\mathbf{B}\\) and normal components of \\(\\mathbf{H}\\) must be continuous across boundaries.\n\n\n\n\n1.3.5 Green’s Function and the Inverse Problem\n\nGreen’s Function: For solving Poisson’s or Laplace’s equation in a specific geometry, Green’s functions are often used to represent the solution in terms of the source distribution. \\[\n\\Phi(\\mathbf{r}) = \\int_V G(\\mathbf{r}, \\mathbf{r'}) \\rho(\\mathbf{r'})\\, \\dd V'\n\\] where \\(G(\\mathbf{r}, \\mathbf{r'})\\) is the Green’s function for the particular boundary conditions of the problem.\nInverse Problem: In geophysical surveys, the goal is often to infer the source distribution (e.g., mass or magnetization) from potential field measurements. This involves solving the inverse problem, which is often ill-posed and requires regularization techniques like Tikhonov regularization or the use of constraints (e.g., smoothness or sparsity) to stabilize the solution.\n\n\n\n1.3.6 Spherical Harmonics for Global Representations\n\nWhen dealing with global geophysical fields, such as the Earth’s gravity or magnetic field, spherical harmonics are commonly used to express the potential, e.g.: \\[\n\\Phi(r, \\theta, \\phi) = \\sum_{l=0}^{\\infty} \\sum_{m=-l}^{l} \\left( a_{lm} r^l + \\frac{b_{lm}}{r^{l+1}} \\right) Y_{lm}(\\theta, \\phi)\n\\] where \\(Y_{lm}(\\theta, \\phi)\\) are the spherical harmonics, and \\(a_{lm}, b_{lm}\\) are the coefficients determined from measurements.\n\n\n\n1.3.7 Upward and Downward Continuation\n\nUpward Continuation: This is a technique used to smooth potential field data by calculating the field at a higher elevation than the measurement plane. It is commonly used to reduce noise and remove near-surface effects.\nDownward Continuation: The inverse of upward continuation, used to estimate the potential field at a lower elevation, which can be unstable due to noise amplification.\n\n\n\n1.3.8 Anomalies and Signal Separation\n\nResidual Field: The measured potential field typically consists of a regional (background) component and an anomalous (local) component. The anomaly is what is typically of interest, as it reflects subsurface structures. \\[\n\\Phi_{\\text{measured}} = \\Phi_{\\text{regional}} + \\Phi_{\\text{anomaly}}\n\\]\nSignal separation techniques like trend surface analysis or filtering in the Fourier domain are used to isolate the anomaly from the regional field.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#summary-of-key-equations",
    "href": "intro.html#summary-of-key-equations",
    "title": "1  Introduction",
    "section": "1.4 Summary of Key Equations",
    "text": "1.4 Summary of Key Equations\n\nGravitational Field: \\(\\mathbf{g} = -\\grad \\Phi_g\\)\nMagnetic Field: \\(\\mathbf{B} = -\\grad \\Phi_m\\)\nLaplace’s Equation: \\(\\laplacian \\Phi = 0\\)\nPoisson’s Equation (gravity): \\(\\laplacian \\Phi_g = 4\\pi f \\rho\\)\nPoisson’s Equation (magnetic): \\(\\laplacian \\Phi_m = -\\mu_0 \\div \\mathbf{M}\\)\n\nThese general formulations provide a robust theoretical framework for potential field methods in geophysics.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "fields.html",
    "href": "fields.html",
    "title": "2  Fields",
    "section": "",
    "text": "2.1 Potential fields",
    "crumbs": [
      "Mathematical foundations",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Fields</span>"
    ]
  },
  {
    "objectID": "fields.html#potential-fields",
    "href": "fields.html#potential-fields",
    "title": "2  Fields",
    "section": "",
    "text": "2.1.1 Definition of a vector field\nA vector field \\(\\vb  F : \\mathbb R^n \\mapsto \\mathbb R^n\\) defined on a subset \\(\\Omega \\subset \\mathbb R^n\\) assigns to each point \\(\\vb x \\in \\mathbb R^n\\) a vector \\(\\vb F(\\vb x) \\in \\Omega\\).\nA vector field \\(\\vb F\\) is a potential or conservative vector field if and only if there exists a scalar field \\(\\Phi: \\mathbb R^n \\mapsto \\mathbb R\\) such that it holds \\(\\vb F (\\vb x) = \\grad \\Phi(\\vb x)\\).\n\n\n2.1.2 Equivalent properties of conservative fields\n\nThe line integral \\(\\int_C\\) along any curve \\(C\\) within the field only depends on the start and the end points, but not on the path between them (path independence)\nThe closed line integral is zero for any curve \\(C\\): \\(\\oint_C \\grad \\Phi(\\vb x ) \\cdot \\dd{\\vb x} = \\oint \\vb F (\\vb x ) \\cdot \\dd{\\vb x} = 0\\)\nSuch vector fields are curl free (irrotational), i.e., \\(\\curl \\grad \\Phi(\\vb x ) = \\curl \\vb F (\\vb x ) \\equiv \\vb 0\\)\n\n\n\n2.1.3 Divergence theorem\nStatements about the sources and sinks of vector fields can be derived by applying the divergence theorem.\nThe dielectric displacement \\(\\vb D = \\varepsilon(\\vb x) \\vb E(\\vb x)\\) has its sources in a volume density of electric charges \\(\\rho_E (\\vb x)\\).\nIt holds\n\\(\\rho_E = \\div \\vb D = - \\div (\\varepsilon \\grad \\Phi).\\)\nFor homogeneous dielectrics we obtain the Poisson equation of electrostatics\n\\(-\\Delta \\Phi = \\rho_E/\\varepsilon.\\)\n\n\n2.1.4 Poisson equation\nPotential theory attempts to calculate the unknown potential (the potential function) \\(\\Phi\\) caused by a given physical quantity, e.g., a source distribution \\(\\rho(\\vb x)\\).\nThe potential function can generally be determined by integrating the Poisson equation.\nOften, only its spatial derivative is desired, because for physicists only the fields are a meaningful quantity.\n\n\n2.1.5 Laplace equation\nIn a region where sources are absent, i.e., \\(\\rho(\\vb x ) \\equiv 0\\), the Poisson equation becomes the Laplace equation\n\\(\\Delta \\Phi(\\vb x) = 0\\)\nwith the scalar function \\(\\Phi\\) (the potential) defined over a subset \\(\\Omega \\subset \\mathbb R^n\\).\nThis elliptic partial differential equation (or short, the potential equation) is the point of departure in the potential theory.\n\n\n2.1.6 Mathematical Tools\nThe potential theory makes use of the functional analysis and its tools, e.g.,\n\nvector spaces\ninner product\nnorm\ndifferentiability\ncontinuity\n\netc.\n\n\n\n\n\n\nTipSpaces\n\n\n\nWe consider spaces with a norm induced by the inner product.\nEuclidean space: Any vector space defined over \\(\\mathbb R^n\\) equipped with an inner product of any finite dimension is called Euclidean vector space.\nThe coordinate space \\(\\mathbb R^3\\) with standard dot product is a Euclidean space!\nHilbert space: A Hilbert space is a vector space \\(H\\) with an inner product \\(\\langle f,g \\rangle\\) such that the norm \\(|f| = \\langle f,f \\rangle^{1/2}\\) turns the space into a complete metric space.\nThe coordinate spaces \\(\\mathbb R^n\\) and \\(\\mathbb C^n\\) are Hilbert spaces!\n\n\n\n\n\n\n\n\nTipScalar product\n\n\n\nWith \\(\\vb x = (x_1, x_2, \\dots, x_n)^\\top\\) we denote an \\(n\\)-tuple of numbers or a point in \\(\\mathbb R^n\\), and define the scalar product in \\(\\mathbb R^n\\) given by the dot product\n\\[\n\\langle \\cdot,\\cdot \\rangle : \\mathbb R^n \\mapsto \\mathbb R,\n\\] e.g., \\[\n\\langle \\vb x , \\vb y \\rangle = \\sum_{i=1}^n x_i y_i\n\\] as well as the norm induced by the inner product \\[\nx = \\abs{\\vb x} = \\langle \\vb x , \\vb x  \\rangle^{1/2}\n\\] The norm \\(\\abs{\\cdot} : \\mathbb R^n \\mapsto \\mathbb R\\), as a function, assigns to \\(\\vb x\\) its length.\n\n\n\n\n\n\n\n\nTipDifferentiation\n\n\n\nLet \\(\\Omega \\subset \\mathbb R^n\\) be an open subset.\nA derivative of order \\(\\vb \\alpha\\) is defined by a differential operator \\(D: C^k (\\Omega) \\mapsto C(\\Omega)\\) represented by\n\\(D^{\\vb \\alpha} f(\\vb x) = \\dfrac{\\partial^{|\\vb \\alpha|} f(x_1, x_2, \\dots, x_n)}{\\partial x_1^{\\alpha_1} \\partial x_2^{\\alpha_2}\\, \\dots \\,\\partial x_n^{\\alpha_n}}\\)\nand a multi-index \\(\\vb(\\alpha = (\\alpha_1, \\alpha_2, \\dots, \\alpha_n) \\in \\mathbb N_0^n\\) with \\(|\\vb\\alpha| = \\sum_{i=1}^n \\alpha_i\\).\nOther notations derived from the above definition are:\n\n\\(f_x := \\pdv{f}{x}\\) where \\(n=1, \\alpha_1=1, |\\vb\\alpha|=1\\)\n\\(f_{x x} := \\pdv[2]{f}{x}\\) where \\(n=1, \\alpha_1=2, |\\vb\\alpha|=2\\)\n\\(f_{x z} := \\pdv{f}{x}{z}\\) where \\(n=3, \\alpha_1=1, \\alpha_2=0, \\alpha_3=1, |\\vb\\alpha||=2\\)\n\n\n\n\n\n\n\n\n\nTipDifferentiability classes\n\n\n\nWhat is \\(C^k(\\Omega)\\)?\nThe space of the continuous real valued functions in a domain \\(\\Omega\\) is of class \\(C(\\Omega)\\) or \\(C^0(\\Omega)\\).\nThis space contains all differentiable functions in \\(\\Omega \\subset \\mathbb R^n\\).\nFunctions whose (partial) derivatives are also continuous are called continuously differentiable. These functions are said to be of class \\(C^1(\\Omega)\\).\nCorrespondingly, \\(C^n (\\Omega)\\) is called the space of the functions which are \\(n\\)-differentiable, where the \\(n\\)-th derivative \\(D^{\\vb\\alpha} f(\\vb x), |\\vb\\alpha| \\le n\\) is continuous on \\(\\Omega\\).\nArbitrarily often differentiable (smooth) functions belong to \\(C^\\infty ( \\Omega)\\).\n\n\n\n\n\n\n\n\nTipHarmonic function\n\n\n\nWe define the harmonic function:\nA real-valued function \\(U(\\vb x) \\in C^2 (\\Omega)\\) is called harmonic or regular potential function in the subset \\(\\Omega \\subset \\mathbb R^n\\) if there holds\n\\[\n\\Delta U(\\vb x) = 0\n\\]\nfor \\(\\vb x \\in \\Omega\\).",
    "crumbs": [
      "Mathematical foundations",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Fields</span>"
    ]
  },
  {
    "objectID": "fields.html#solution-of-the-laplace-and-poisson-equations",
    "href": "fields.html#solution-of-the-laplace-and-poisson-equations",
    "title": "2  Fields",
    "section": "2.2 Solution of the Laplace and Poisson equations",
    "text": "2.2 Solution of the Laplace and Poisson equations\nWe consider the second-order differential equations\n\n\n\n\n\n\nTipLaplace equation\n\n\n\n\\[\n\\dv[2]{y}{x} = 0\n\\]\n\n\nand\n\n\n\n\n\n\nTipPoisson equation\n\n\n\n\\[\n\\dv[2]{y}{x} = -4\\cos(4x) - 8 \\sin(8 x)\n\\]\n\n\nfor \\(x \\in [0, 1]\\) subject to the boundary conditions \\(y(0)=1\\) and \\(y(1)=0\\).\nTo obtain the solution to the above PDEs, we employ the Python package sympy, which is a powerful library for symbolic mathematics.\nSymbolic functions which depend on symbolic variables have to be defined with the function Function.\nThe solution of the differential equations can be obtained by a call to the dsolve function.\nThe signature of the function can be understood as follows:\n\nSolve the symbolic equation given by the expressions eq_poisson and eq_laplace, resp.\nThe desired solution is y(x)\nBoundary conditions can be enforced by the values following the keyword ics. In the example, y(0)=1 and y(1)=0.\n\n\n\nShow the code\nfrom sympy import Function, dsolve, diff, cos, sin\nfrom sympy.abc import x\nfrom sympy.plotting import plot, PlotGrid\nimport matplotlib.pyplot as plt\n# plt.style.use('fivethirtyeight')\n\ny = Function('y')\neq_poisson = diff(y(x), x, 2) + 4 * cos(4 * x) + 8 * sin(8 * x)\neq_laplace = diff(y(x), x, 2)\nresult_poisson = dsolve(eq_poisson, y(x), ics={y(0): 1, y(1): 0})\nresult_laplace = dsolve(eq_laplace, y(x), ics={y(0): 1, y(1): 0})\np1 = plot(result_poisson.rhs, (x, 0, 1), \n      ylim=(-0.2, 1.2), \n      ylabel='y(x)', \n      axis_center='auto',\n      show=False,\n      title='Poisson equation');\np2 = plot(result_laplace.rhs, (x, 0, 1), \n      ylim=(-0.2, 1.2), \n      ylabel='y(x)', \n      axis_center='auto',\n      show=False,\n      title='Laplace equation');\nPlotGrid(1, 2, p1, p2, size=(7,3));",
    "crumbs": [
      "Mathematical foundations",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Fields</span>"
    ]
  },
  {
    "objectID": "fields.html#what-can-be-observed-in-the-1-d-case",
    "href": "fields.html#what-can-be-observed-in-the-1-d-case",
    "title": "2  Fields",
    "section": "2.3 What can be observed in the 1-D case?",
    "text": "2.3 What can be observed in the 1-D case?\n\nThe solution of the Laplace equation does not exhibit local extrema\n\nIt has no curvature\n\nThe solution of the Poisson equation has local minima and maxima\n\nIts extrema might get larger or smaller than those of the Dirichlet values at the boundary",
    "crumbs": [
      "Mathematical foundations",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Fields</span>"
    ]
  },
  {
    "objectID": "fields.html#mean-value-theorem",
    "href": "fields.html#mean-value-theorem",
    "title": "2  Fields",
    "section": "2.4 Mean value theorem",
    "text": "2.4 Mean value theorem\nWe observe an important property of harmonic functions:\nA continuous function \\(f: \\Omega \\subset \\mathbb R_{n} \\mapsto \\mathbb R\\) is a harmonic function, if there holds\n\\[\nf(\\mathbf{x}) = \\frac{1}{r^{n-1}s_{n}} \\int_{\\partial K(\\mathbf{x}, r)} f(\\mathbf{y}) \\, \\mathrm d \\sigma(\\mathbf{y})\n\\] for any sphere \\(K(\\mathbf{x}, r)\\) of radius \\(r\\) in \\(\\mathbf{x}\\) enclosed by \\(\\Omega\\). \\(s_{n}\\) is the surface measure of the n-dimansional unit sphere.\nIn \\(\\mathbb R^3\\) we have \\[\nf(\\mathbf{x}) = \\frac{1}{4 \\pi r^{2}} \\int_{\\partial K(\\mathbf{x}, r)} f(\\mathbf{y}) \\, \\mathrm d  \\sigma(\\mathbf{y})\n\\]\nThe value of a harmonic function at any given point \\(\\mathbf{x}\\) is the average of its neighboring values.\nFrom the definition of the second derivative we can infer an alternative approach for the 1-D case:\nFrom the definition of the second derivative \\[\n\\frac{\\mathrm d^{2}\\Phi(x)}{\\mathrm d x^{2}} = \\lim_{\\Delta x \\to 0}\n\\frac{\\Phi(x + \\Delta x) - 2 \\Phi(x) + \\Phi(x - \\Delta x)}{\\Delta x^{2}}\n\\] we obtain \\[\n\\lim_{\\Delta x \\to 0} \\frac{1}{\\Delta x^{2}} \\left(\n\\Phi(x) - \\frac{1}{2}(\\Phi(x - \\Delta x) + \\Phi(x + \\Delta x))\n\\right) = -\\frac{1}{2}\\frac{\\mathrm d^{2}\\Phi}{\\mathrm d x^{2}}\n\\] from which it follows that \\[\n\\Phi(x) = \\frac{1}{2} \\lim_{\\Delta x \\to 0}\n(\\Phi(x - \\Delta x) + \\Phi(x + \\Delta x)).\n\\]",
    "crumbs": [
      "Mathematical foundations",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Fields</span>"
    ]
  },
  {
    "objectID": "fields.html#min-max-property",
    "href": "fields.html#min-max-property",
    "title": "2  Fields",
    "section": "2.5 Min-Max Property",
    "text": "2.5 Min-Max Property\nFrom the mean value theorem follows the min-max property, which states that the solution \\(\\Phi\\) of the Laplace equation in a closed domain \\(\\Omega\\) never has its minimum and maximum values in its interior.\n\\[\n\\begin{align}\n\\max(\\Phi(x), x \\in \\Omega) & \\lt \\max(\\Phi(x), x \\in \\overline{\\Omega}) = \\max(\\Phi(x), x \\in \\partial \\Omega) \\\\\n\\min(\\Phi(x), x \\in \\partial \\Omega) & = \\min(\\Phi(x), x \\in \\overline{\\Omega}) \\lt \\min(\\Phi(x), x \\in \\Omega)\n\\end{align}\n\\]\nHere, \\(\\overline \\Omega\\) is the closure of \\(\\Omega\\), which is the smallest closed set containing \\(\\Omega\\).\nEquivalently, \\[\n\\overline\\Omega = \\Omega \\cup \\partial \\Omega\n\\] where \\(\\partial\\Omega\\) denotes the boundary of \\(\\Omega\\).\nOn the other hand, the domain \\(\\Omega\\) is an open subset of \\(\\mathbb R^{n}\\). Open means that every point \\(x \\in \\Omega\\) has a small ball \\(B_{\\varepsilon}(x)\\) that is still contained in \\(\\Omega\\). Thus, the boundary points are not included in \\(\\Omega\\).",
    "crumbs": [
      "Mathematical foundations",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Fields</span>"
    ]
  },
  {
    "objectID": "pointmass.html",
    "href": "pointmass.html",
    "title": "3  Point mass",
    "section": "",
    "text": "We introduce point sources.\nHowever, the difficulty is that, e.g., for a point mass there is no proper definition of a density in the sense of a mass per volume.\nDifficulties arise when we have to integrate the Poisson’s equation with point sources.\nTo this end, we introduce a generalized function with the desired property that it provides finite integral values for unbounded integrands.\nWe define\n\\[\n\\delta(\\vb x) = \\lim_{\\epsilon \\to 0} h_{\\epsilon}(\\vb x) =\n\\begin{cases}\n\\infty  & \\qif \\vb x = \\vb 0 \\\\\n0 & \\qif \\vb x \\ne \\vb 0\n\\end{cases}\n\\] with the function \\[\nh_{\\epsilon}(\\vb x) =\n\\begin{cases}\n\\frac{3}{4 \\pi \\epsilon^3}  & \\qif |\\vb x| \\le \\epsilon \\\\\n0 & \\qif |\\vb x| \\gt \\epsilon\n\\end{cases}\n\\] which describes a unit mass distributed over a small sphere of radius \\(\\epsilon\\).\n\\(\\delta(\\vb x)\\) is the limit of the sequence of functions \\(h_\\epsilon(\\vb x)\\) for \\(\\epsilon \\to 0\\).\nWe are now able to evaluate the density of the sphere as \\(\\rho(\\vb x) = m h_\\epsilon(\\vb x)\\).\nFurther, the integral over a domain \\(G\\) containing the point \\(\\vb x\\) is finite, i.e.,\n\\[\n\\int_G h_\\epsilon(\\vb x) \\, \\dd {\\vb x} = 1.\n\\]\nWe calculate the weak limit of the function sequence \\(h_\\epsilon(\\vb x)\\) for \\(\\epsilon \\to 0\\) and any continuous test function \\(\\Phi(\\vb x)\\)\n\\[\n\\lim_{\\epsilon \\to 0} \\int \\Phi(\\vb x) h_\\epsilon(\\vb x) \\, \\dd {\\vb x} = \\Phi(0)\n\\]\nThe functional which assigns to each continuous function \\(\\Phi(\\vb x)\\) its value at the point \\(\\vb x = 0\\), i.e., \\(\\Phi(0)\\), is called the weak limit of the function \\(h_\\epsilon(\\vb x), \\epsilon \\to 0\\). This functional can be used to define the density \\(\\delta(\\vb x)\\).\nIt holds \\[\n\\int_G \\delta(\\vb x) \\, \\dd {\\vb x} = 1 \\qif \\vb x = \\vb 0 \\in G.\n\\]",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Point mass</span>"
    ]
  },
  {
    "objectID": "mass_distribution.html",
    "href": "mass_distribution.html",
    "title": "4  Mass distribution",
    "section": "",
    "text": "The gravitational potential of a spatial mass distribution follows the principle of linear superposition.\n\n\n\n\n\n\nFigure 4.1\n\n\n\nThe potential can be composed as the sum of the individual potentials of point masses\n\\[\nV(\\vb r) = -f \\sum\\limits_{i=1}^N \\frac{m_i}{|\\vb r - \\vb r_i}, \\qfor |\\vb r - \\vb r'| \\ne 0.\n\\]\nFor a continuous mass distribution with density \\(\\rho(\\vb r)\\), a mass \\(\\dd m(\\vb r) = \\rho(\\vb r)  \\dd{^3 {\\vb r}}\\) must be assigned to each volume element. The summation gets replaced by an integration\n\\[\nV(\\vb r) = -f \\int\\limits_G \\frac{\\dd m (\\vb r')}{| \\vb r - \\vb r'|} = -f \\int\\limits_G \\frac{ \\rho(\\vb r')  \\dd{^3 {\\vb r'}}}{| \\vb r - \\vb r'|}\n\\]\nThis is Newton’s volume potential.\nIn practical applications the difficulty is to integrate over non-trivial, complicated geometries of the domain \\(G\\).\nIn the next section we demonstrate the integration over spherical shells and spheres.",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Mass distribution</span>"
    ]
  },
  {
    "objectID": "spherical_shells.html",
    "href": "spherical_shells.html",
    "title": "5  Newton’s shell theorem",
    "section": "",
    "text": "5.1 Density laws\nWe want to investigate spheres with an arbitrary radial density distribution \\(\\rho = \\rho(r)\\). The following results have been described 1687 in Newton’s Philosophiae Naturalis Principia Mathematica and have since then been known as Newton’s shell theorem.\nNewton stated that:\nThe potential outside of a solid sphere of radius \\(a\\) and density law \\(\\rho=\\rho(r)\\) can be obtained by integration over spherical shells using the law of cosines: \\[\nV(r)  = -f \\int_{r'=0}^a \\int_{\\theta=0}^\\pi \\int_{\\phi=0}^{2\\pi}\n    \\frac{\\rho(r') {r'}^2 \\, \\mathrm d r' \\sin\\theta \\, \\mathrm d \\theta \\, \\mathrm d \\phi}{[{r'}^2 + r^2 -2 r r' \\cos\\theta]^{1/2}}.\n\\]\nWe depart from the potential of one spherical shell of radius \\(a\\) with surface density \\(\\rho_F\\), which can be evaluated as \\[\nV^F(r) = -2 \\pi f \\rho_F \\int_{\\theta=0}^\\pi \\frac{a^2 \\sin\\theta \\, \\mathrm d \\theta}{\\sqrt{r^2 + a^2 - 2ar\\cos\\theta}}.\n\\]\nThe potential \\(V^F(r)\\) inside or outside of such a spherical shell with surface density \\(\\rho_F\\) and radius \\(a\\) is \\[\nV^F(r) = -2 \\pi f \\frac{a}{r} \\rho_F \\left[ r + a - |r - a| \\right].\n\\] Because \\(r\\) can be either less or greater than \\(a\\), we distinguish between \\[\nV^F(r) = \\begin{cases}\n-4 \\pi f \\rho_F \\frac{a^2}{r} & \\quad\\text{ if } r &gt; a \\\\\n-4 \\pi f \\rho_F a & \\quad\\text{ if } r &lt; a\n\\end{cases}\n\\]\nWe now introduce a solid sphere with a density law \\(\\rho = \\rho(r)\\). To obtain the potential \\(V(r)\\) outside this sphere, we integrate\n\\[\nV(r) = \\int_{r'=0}^a V^F(r') \\, \\mathrm d r' = -\\frac{2 \\pi f}{r } \\int_{r'=0}^{a} \\rho(r') [r + r' - |r - r'|] r' \\, \\mathrm d r'\n\\]\nTo illustrate this, we make use of SymPy, a Python library for symbolic mathematics.\nWe first define symbolic variables.\nSince \\[\n\\sqrt{r^2 + a^2 + 2 a r} = |r + a| = r + a\n\\] and \\[\n\\sqrt{r^2 + a^2 - 2 a r} = |r - a| =\n\\begin{cases}\nr - a & \\text{if } r &gt; a \\\\\na - r & \\text{if } r &lt; a\n\\end{cases}\n\\] we have to be careful with the integrand.\nThe potential outside of the sphere is\nWe recognize that this is just the potential of an equivalent point mass of \\(m = \\frac{4 \\pi a^{3} \\rho}{3}\\) concentrated at the center of the sphere.\nTo get the potential inside the sphere, i.e., for \\(r &lt; a\\), we have to decompose the integral into two contributions.\nFirst, we evaluate the potential due to an embedded sphere of radius \\(r\\), to which we add the contribution of a hollow sphere with inner radius \\(r\\) and outer radius \\(a\\): \\[\nV(r) = -\\frac{4 \\pi f}{r} \\left[ \\int_{r'=0}^r \\rho(r') {r'}^2 \\, \\mathrm d r' + \\int_r^a \\rho(r') r r' \\, \\mathrm d r'\\right]\n\\]\nIn the interior of a homogeneous sphere with an averaged mean density of \\(\\bar\\rho\\) we obtain for \\(0 \\le r \\le a\\) \\[\nV(r) = -\\frac{2 \\pi f \\bar\\rho}{3} \\left(3a^2 - r^2 \\right)\n\\]\nSymPy gets the same result:\nWe make some plots to illustrate the potential and its radial derivative. Note that in what follows, we have set \\(f \\rho = 1\\).\nFrom the plot we recognize that the potential is continuous at \\(r=a\\)!\nNow let’s study the gravitational attraction of our sphere.\nThe gravitational attraction is \\[\ng(r) = -\\frac{ \\partial V }{ \\partial r }\n\\]\nInside the sphere, we get\nOutside, we get\nWhen multiplied by the unit radial vector, the attraction acquires a direction that points radially inward, toward the center of the sphere.\nThe gravitational attraction is continuous but not continuously differentiable at \\(r = a\\). Within the sphere, it varies linearly with the distance from the center and vanishes at \\(r = 0\\). Outside the sphere, the attraction follows an inverse-square law, equivalent to that of a point mass located at the sphere’s center.\nNow, we introduce non-trivial density laws, such as a linear density law \\[\n\\rho(r) = \\rho(0) - b r, \\quad b &gt; 0.\n\\]\nShow the code\nrho_m, rho_0, rho_R, R_E, b = sp.symbols(\"rho_m rho_0 rho_R R_E b\", positive=True, real=True)\nWith the known mean density of the Earth we can evaluate Earth’s mass.\nShow the code\nm_E = rho_m * 4 * pi / 3 * R_E**3\nm_E\n\n\n\\(\\displaystyle \\frac{4 \\pi R_{E}^{3} \\rho_{m}}{3}\\)\nThis is not very helpful. Instead, we can evaluate Earth’s mass using a volume integral over a density function, e.g., \\[\nm_E = 4 \\pi \\int_0^{R_E} (\\rho_0 - br) r^2 \\, \\mathrm d r\n\\] Using SymPy we obtain the expression\nShow the code\nm_E_int = 4 * pi * sp.integrate((rho_0 - b * r) * r**2, (r, 0, R_E))\nm_E_int.simplify()\n\n\n\\(\\displaystyle \\frac{\\pi R_{E}^{3} \\left(- 3 R_{E} b + 4 \\rho_{0}\\right)}{3}\\)\nThis result still contains two unknown parameters \\(b\\) and \\(\\rho_0\\).\nWe exploit the fact that there must hold \\[\n\\rho(R_E) = \\rho(0) - b R_E.\n\\]\nThe density at the Earth’s surface is about \\(2700\\) \\(kg/m^3\\).\nShow the code\neq1 = m_E_int - m_E\neq2 = rho_0 - b * R_E - rho_R\nShow the code\ncoeffs = sp.solve((eq1, eq2), (rho_0, b),dict=True)\ncoeff_rho_0 = coeffs[0][rho_0]\ncoeff_b = coeffs[0][b]\nShow the code\ncoeff_rho_0\n\n\n\\(\\displaystyle - 3 \\rho_{R} + 4 \\rho_{m}\\)\nShow the code\ncoeff_b\n\n\n\\(\\displaystyle \\frac{- 4 \\rho_{R} + 4 \\rho_{m}}{R_{E}}\\)\nShow the code\nrho_num = coeff_rho_0.subs(rho_R, 2700).subs(rho_m, 5515)\nShow the code\nb_num = coeff_b.subs(rho_R, 2700).subs(rho_m, 5515).subs(R_E, 6.371e6)",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Newton's shell theorem</span>"
    ]
  },
  {
    "objectID": "spherical_shells.html#gravitational-attraction-inside-the-earth",
    "href": "spherical_shells.html#gravitational-attraction-inside-the-earth",
    "title": "5  Newton’s shell theorem",
    "section": "5.2 Gravitational attraction inside the Earth",
    "text": "5.2 Gravitational attraction inside the Earth\nIt is known that the gravitational potential inside a sphere with a radially symmetric density function is \\[\nV(r) = -\\frac{4 \\pi f}{r} \\left[ \\int_{r'=0}^r \\rho(r') {r'}^2 \\, \\mathrm d r' + \\int_r^{R_E} \\rho(r') r r' \\, \\mathrm d r'\\right]\n\\] The first integral amounts for the potential at the surface of a sphere with radius , whereas the second computes the potential taken at the inner surface of a hollow sphere.\nWith the constants derived above we want to evaluate these integrals.\n\n\nShow the code\ni1 = -4 * pi * f / r * sp.integrate((rho_0 - b * rp) * rp**2, (rp, 0, r))\ni1.simplify()\n\n\n\\(\\displaystyle \\frac{\\pi f r^{2} \\left(3 b r - 4 \\rho_{0}\\right)}{3}\\)\n\n\n\n\nShow the code\ni2 = -4 * pi * f * sp.integrate((rho_0 - b * rp) * rp, (rp, r, R_E))\ni2.simplify()\n\n\n\\(\\displaystyle \\frac{2 \\pi f \\left(2 R_{E}^{3} b - 3 R_{E}^{2} \\rho_{0} - 2 b r^{3} + 3 r^{2} \\rho_{0}\\right)}{3}\\)\n\n\nNext, we add both contributions to obtain the potential inside the Earth.\n\n\nShow the code\n#V = sp.Function(\"V\")\nV = i1 + i2\n\n\n\n\nShow the code\nV.simplify()\n\n\n\\(\\displaystyle \\frac{\\pi f \\left(4 R_{E}^{3} b - 6 R_{E}^{2} \\rho_{0} - b r^{3} + 2 r^{2} \\rho_{0}\\right)}{3}\\)\n\n\nWe obtain the gravitational attraction by taking the gradient of \\(V\\) in the direction of \\(\\mathbf r\\):\n\\[\ng(r) = -\\nabla V(r) \\cdot \\hat{\\mathbf r}\n\\]\n\n\nShow the code\ng = -sp.diff(V, r)\ng.simplify()\n\n\n\\(\\displaystyle \\frac{\\pi f r \\left(3 b r - 4 \\rho_{0}\\right)}{3}\\)",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Newton's shell theorem</span>"
    ]
  },
  {
    "objectID": "spherical_shells.html#visualization-of-the-result",
    "href": "spherical_shells.html#visualization-of-the-result",
    "title": "5  Newton’s shell theorem",
    "section": "5.3 Visualization of the result",
    "text": "5.3 Visualization of the result\nWe plot the curve of \\(g(r)\\) inside the Earth.\nFurther, we check if \\(g(r)\\) has an extremum inside the Earth.\n\n\nShow the code\nf_ = 6.674e-11\ng_num = lambda r: np.pi * f_ * r * (3 * b_num * r - 4 * rho_num) / 3\n\n\n\n\nShow the code\nrstar = sp.solve(sp.diff(g, r), (r))\nrstar[0]\n\n\n\\(\\displaystyle \\frac{2 \\rho_{0}}{3 b}\\)\n\n\n\n\nShow the code\nrextrem = rstar[0].subs(rho_0, rho_num).subs(b, b_num)\nrextrem / 1e6\n\n\n\\(\\displaystyle 5.26578804026051\\)\n\n\n\n\nShow the code\n6.371e6 - rextrem\n\n\n\\(\\displaystyle 1105211.95973949\\)\n\n\nThe extremal value of \\(g(r)\\) in the interior of the Earth appears at \\(r=5.26 \\times 10^6\\) m, i.e., at a depth of 1105 km.\n\n\nShow the code\nrr = np.linspace(0, 6.367e6, 41)\n\n\n\n\nShow the code\nplt.plot(rr, g_num(rr))\nplt.scatter(rextrem, g_num(rextrem), color='r')\nplt.grid(True)\nplt.xlabel(\"r in m\")\nplt.ylabel(\"g(r)\");",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Newton's shell theorem</span>"
    ]
  },
  {
    "objectID": "spherical_shells.html#moment-of-inertia",
    "href": "spherical_shells.html#moment-of-inertia",
    "title": "5  Newton’s shell theorem",
    "section": "5.4 Moment of inertia",
    "text": "5.4 Moment of inertia\nThere are two constraints for density models: The mass of the Earth, and its moment of inertia. Both are moments of the density distribution. The mass is the second moment of the radial density distribution, whereas the mean moment of inertia is the scaled fourth moment of the radial density distribution. The moment of inertia can be inferred from a thin spherical shell of radius \\(a\\),\n\\[\nI = \\frac{2}{3} m a^2.\n\\]\nThe contribution of a small mass \\(\\mathrm d m\\) is therefore \\[\n\\mathrm d I = \\frac{2}{3} a^2 \\, \\mathrm d m.\n\\] The total moment of intertia an be calculated with the integral \\[\nI=\\frac{2}{3} \\int\\limits_0^{R_E}  \\rho(r) r^2 \\, \\mathrm d V =\n\\frac{8\\pi}{3} \\int\\limits_0^{R_E}  \\rho(r) r^4 \\, \\mathrm d r,\n\\] with the help of which we compute the moment of inertia factor \\(\\alpha\\), a dimensionless number, where \\[\n\\alpha = \\frac{I}{mR_E^2}.\n\\] This factor is \\(0.4\\) for a solid sphere.\nCheck using SymPy:\n\n\nShow the code\n(8 * pi / 3 * \n    sp.integrate(rho_m * r**4, (r, 0, R_E)) / \n    m_E / R_E**2\n    ).subs(rho_m, 5515).subs(R_E, 6.371e6)\n\n\n\\(\\displaystyle \\frac{2}{5}\\)\n\n\n\\(\\alpha\\) should be smaller for a sphere when there is an increasing density with depth.\nFor our density model, we observe \\(\\alpha=0.3319\\), which is slightly more than reported in the literature, where \\(\\alpha=0.3307144\\) (Williams, 1994).\nCheck:\n\n\nShow the code\n(8 * pi / 3 * \n    sp.integrate((rho_num - b_num * r) * r**4, (r, 0, R_E)) / \n    m_E / R_E**2\n    ).subs(rho_m, 5515).subs(R_E, 6.371e6)\n\n\n\\(\\displaystyle 0.331943185252342\\)",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Newton's shell theorem</span>"
    ]
  },
  {
    "objectID": "PREM_.html",
    "href": "PREM_.html",
    "title": "6  PREM - Preliminary Reference Earth Model",
    "section": "",
    "text": "6.1 Density profile\nIn this notebook we demonstrate how to model the Earth’s density as piecewise quadratic functions, such that \\[\n\\rho(r) = a_i r^{2} + b_i r + c_i, \\quad r_{i-1}&lt;r \\le r_{i}\n\\] for any shell enclosed by the radii \\(r_{i-1}\\) and \\(r_i\\), \\(i=1,2,\\dots,11\\).\nThe coefficients \\(a_i, b_i, c_i\\) as well as the layer boundaries \\(r_i\\) have been published by Dziewonski & Anderson (1981).\nThe following Python code reads the content of the file PREM.csv into memory.\nWe define a function rho(r,a,b,c) which evaluates for any \\(r\\) a second order polynomial with the given coefficients \\(a,b,c\\):\nShow the code\nrho = lambda r, a, b, c: a * r**2 + b * r + c\nR_E = 6.371e6\n\nrr = np.linspace(0, R_E, 501)\n# Initialize myrho with zeros\nmyrho = np.zeros(len(rr))\n\nfor i in range(len(rr)):\n    # Find the first index where rr[i] &lt; h\n    ii = np.where(rr[i] &lt; h)[0]\n    if ii.size &gt; 0:\n        first_index = ii[0]  # Get the first index where the condition is met\n        # Ensure rr[i], an[first_index], bn[first_index], and cn[first_index] are scalars\n        myrho[i] = rho(float(rr[i]), float(an[first_index]), float(bn[first_index]), float(cn[first_index]))\n\n# Set the last element as in MATLAB\nmyrho[-1] = rho(float(R_E), float(an[10]), float(bn[10]), float(cn[10]))\n\nfig, ax = plt.subplots(figsize=(6,4))\nplt.plot(rr / 1000, myrho / 1000)\nplt.grid(True)\nplt.vlines(h / 1000, 1, 14, color='r', linewidth=0.2)\nplt.ylim(1, 14)\nplt.title('PREM density profile')\nplt.xlabel('km')\nplt.ylabel('density');",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>PREM - Preliminary Reference Earth Model</span>"
    ]
  },
  {
    "objectID": "PREM_.html#mass-distribution-inside-the-earth",
    "href": "PREM_.html#mass-distribution-inside-the-earth",
    "title": "6  PREM - Preliminary Reference Earth Model",
    "section": "6.2 Mass distribution inside the Earth",
    "text": "6.2 Mass distribution inside the Earth\nThe total mass of the Earth results from \\[\nm_E = 4 \\pi \\int\\limits_0^{R_E} \\rho(r) r^2 \\, \\mathrm dr.\n\\]\nHowever, there are density discontinuities which require a split of the integral at the jumps of \\(\\rho(r)\\). We integrate layer-wise, such that the mass of layer \\(i\\) is obtained by \\[\nm_i = 4 \\pi \\int_{r_{i-1}}^{r_i} \\rho(r) r^2 \\, \\mathrm d r ,\\quad 1 \\le i \\le 11.\n\\] We use Python’s Sympy library.\n\n\nShow the code\na, b, c, r, h_1, h_2 = sp.symbols('a b c r h_1 h_2', real=True)\n\n\nWe denote with i1 the following lambda function which is equivalent to the evaluation of the integral \\[\n4 \\pi \\int_{h_1}^{h_2} (a r^2 + b r + c) r^2 \\, \\mathrm d r\n\\]\n\n\nShow the code\ni1 = lambda h_1, h_2: 4 * pi * sp.integrate((a * r**2 + b * r + c) * r**2, (r, h_1, h_2))\n\nmass = np.zeros(len(an))\nmass[0] = i1(0, h[0]).subs(a, an[0]).subs(b, bn[0]).subs(c, cn[0]).subs(pi, np.pi)\n\nfor i in range(1, 11):\n    mass[i] = i1(h[i-1], h[i]).subs(a, an[i]).subs(b, bn[i]).subs(c, cn[i]).subs(pi, np.pi)\nmass\n\nM_Earth = np.sum(mass)\nprint('The mass of  the Earth is:') \nprint(M_Earth)\n\n\nThe mass of  the Earth is:\n5.972734577607561e+24\n\n\n\n\nShow the code\nfig, ax = plt.subplots(figsize=(6,4))\nplt.plot(np.concatenate(([0], h)) / 1e3, np.concatenate(([0], np.cumsum(mass))) / 1e24)\nplt.vlines(h / 1000, 0, 6.1, color='k', linewidth=0.2)\nplt.ylim(-0.2, 6.1)\nplt.title('Earth\\'s accumulated mass profile')\nplt.xlabel('km')\nplt.ylabel(r'Mass in 10$^{24}$ kg')\nplt.grid(True);",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>PREM - Preliminary Reference Earth Model</span>"
    ]
  },
  {
    "objectID": "PREM_.html#gravity-profile",
    "href": "PREM_.html#gravity-profile",
    "title": "6  PREM - Preliminary Reference Earth Model",
    "section": "6.3 Gravity profile",
    "text": "6.3 Gravity profile\n\n\nShow the code\n# Constants and assumptions\nG = 6.6743e-11  # Gravitational constant\nmyg = np.zeros(len(rr))  # Initialize myg as a zero array of the same length as rr\n\n# Loop through each element in rr\nfor i in range(1,len(rr)):\n    # Find the first index where rr[i] &lt; h\n    ii = np.where(rr[i] &lt; h)[0]\n    if ii.size &gt; 0:\n        ii = ii[0] + 1  # Adjusting for MATLAB's 1-based indexing\n\n        # Condition where ii == 1\n        if ii == 1:\n            M = i1(0, rr[i]).subs([(a, an[0]), (b, bn[0]), (c, cn[0])])\n        \n        # Condition where ii &gt; 1\n        elif ii &gt; 1:\n            # Calculating M as the sum of mass up to ii-1 plus the substituted function value\n            M = np.sum(mass[:ii-1]) + i1(h[ii-2], rr[i]).subs([(a, an[ii-1]), (b, bn[ii-1]), (c, cn[ii-1])])\n        \n        # Calculate myg[i] using the gravitational constant\n        myg[i] = G / rr[i]**2 * M\n\n# Set boundary conditions as in MATLAB\nmyg[0] = 0.0\nmyg[-1] = G / R_E**2 * M_Earth\n\n\n\n\nShow the code\nrext = np.linspace(R_E, 2*R_E, 41)\nfig, ax = plt.subplots(figsize=(6,4))\nplt.plot(rr / R_E, myg, color='b')\nplt.plot(rext / R_E, G * M_Earth / rext**2, color='r')\nplt.axvspan(0, 1, facecolor='g', alpha=0.2)\nplt.vlines(h / R_E, 0, 12, color='k', linewidth=0.2)\nplt.title('Acceleration profile')\nplt.xlabel('Earth radii')\nplt.ylabel(r'g in m$\\cdot s^{-2}$')\nplt.ylim(0, 12)\nplt.grid(True)\n\n\n\n\n\n\n\n\n\nThe results above do not agree well with the true surface acceleration due to the Earth’s ellipsoidal shape. The WGS84 gravity formula is valid for points at the Earth’s surface and accounts for the change of acceleration due to the ellipticity:\n\n\nShow the code\ng_equator = 9.7803253359\ng_pole = 9.8321849378\nsemi_axis_major = 6378137.0\nsemi_axis_minor = 6356752.3142\necc = np.sqrt(1 - semi_axis_minor**2 / semi_axis_major**2)\nk = semi_axis_minor / semi_axis_major * g_pole / g_equator - 1.0\n\ng_WGS = lambda phi: g_equator * (1 + k * np.sin(phi * np.pi / 180)**2) / np.sqrt(1 - ecc**2 * np.sin(phi * np.pi / 180)**2)\n\nlat = np.linspace(-90, 90, 101)\nfig, ax = plt.subplots(figsize=(6,4))\nplt.plot(lat, [g_WGS(v) for v in lat], label='WGS')\nplt.axhline(y=myg[-1], color='r', label='PREM')\nplt.grid(True)\nplt.ylabel('g')\nplt.xlabel('Latitude in degrees')\nplt.legend();\n\n\n\n\n\n\n\n\n\n\n\n\n\nDziewonski, A.M. & Anderson, D.L., 1981. Preliminary reference Earth model. Physics of the Earth and Planetary Interiors, 25, 297–356. doi:10.1016/0031-9201(81)90046-7",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>PREM - Preliminary Reference Earth Model</span>"
    ]
  },
  {
    "objectID": "Sphere_Potential_and_Attraction.html",
    "href": "Sphere_Potential_and_Attraction.html",
    "title": "7  Potential and gravitational attraction of a sphere",
    "section": "",
    "text": "7.1 Problem statement\n\\(\\require{physics}\\)\nWe consider a sphere of radius \\(a\\) centered at point \\((0,0,t)\\) , \\(t&gt;0\\) . The density contrast is \\(\\Delta \\rho\\) .\nThe excess mass caused by the sphere is therefore\n\\[\nm=\\frac{4\\pi }{3}a^3 \\Delta \\rho,\n\\]\nits potential is\n\\[\nV(x,y,z)=-f\\frac{m}{\\sqrt{x^2 +y^2 +(z-t)^2 }}.\n\\]\nWe restrict our measurements to profiles in the plane \\(x=0\\).\nShow the code\ny, z, t, f, m = sp.symbols(\"y z t f m\")\nV = sp.symbols(\"V\", cls=sp.Function)\nV = V(y)\nV = -f * m / sp.sqrt(y**2 + (z - t)**2)\nprint(\"V=\")\nV\n\n\nV=\n\n\n\\(\\displaystyle - \\frac{f m}{\\sqrt{y^{2} + \\left(- t + z\\right)^{2}}}\\)\nThe vertical component of the gravitational attraction is\n\\[\nV_z (y) := -\\pdv{V}{z}.\n\\]\nFor \\(z=0\\) we obtain the expression\nShow the code\nVz = -sp.diff(V, z).subs(z, 0)\nprint('Vz=')\nVz\n\n\nVz=\n\n\n\\(\\displaystyle \\frac{f m t}{\\left(t^{2} + y^{2}\\right)^{\\frac{3}{2}}}\\)\nThe horizontal component of the gravitational attraction in \\(z=0\\) is:\nShow the code\nVy = -sp.diff(V, y).subs(z, 0)\nprint('Vy=')\nVy.simplify()\n\n\nVy=\n\n\n\\(\\displaystyle - \\frac{f m y}{\\left(t^{2} + y^{2}\\right)^{\\frac{3}{2}}}\\)\nand its second derivative with respect to \\(y\\) evaluated at \\(z=0\\) is:\nShow the code\nVyy = -sp.diff(V, y, 2).subs(z, 0)\nprint('Vyy=')\nVyy.simplify()\n\n\nVyy=\n\n\n\\(\\displaystyle \\frac{f m \\left(- t^{2} + 2 y^{2}\\right)}{\\left(t^{2} + y^{2}\\right)^{\\frac{5}{2}}}\\)",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Potential and gravitational attraction of a sphere</span>"
    ]
  },
  {
    "objectID": "Sphere_Potential_and_Attraction.html#example",
    "href": "Sphere_Potential_and_Attraction.html#example",
    "title": "7  Potential and gravitational attraction of a sphere",
    "section": "7.2 Example",
    "text": "7.2 Example\nWe consider as example a sphere at a depth of \\(t=2000\\) m with radius \\(r=1000\\) m. The density contrast is \\(\\Delta \\rho =500\\) \\(kg/m^3\\) . The vertical and horizontal components of the gravitational attraction along a profile at \\(z=0\\) running from \\(-10^4 \\le y\\le 10^4\\) m have to be computed in units of mGal (milliGal).\n\n\nShow the code\nyy = np.linspace(-1e4, 1e4, 101)\ndrho = 500\ndepth = 2000\nradius = 1000\nmass = 4 * np.pi / 3 * radius**3 * drho\nVz_num = lambda y_: Vz.subs(y, y_).subs(t, depth).subs(f, 6.674e-11).subs(m, mass)\nVy_num = lambda y_: Vy.subs(y, y_).subs(t, depth).subs(f, 6.674e-11).subs(m, mass)\n\nfig, ax = plt.subplots(figsize=(6,4))\n\nplt.plot(yy, [1e5 * Vz_num(v) for v in yy], label=r'$V_z$')\nplt.plot(yy, [1e5 * Vy_num(v) for v in yy], label=r'$V_y$')\nplt.xlabel('y in m')\nplt.ylabel('mGal')\nplt.legend()\nplt.grid(True);\n\n\n\n\n\n\n\n\n\n\n7.2.1 Discusson of the anomaly curves\nWe observe a maximum centered above the sphere for \\(V_z\\) , whereas \\(V_y\\) has two extrema along the profile.\nAre there hidden information about the depth of the sphere?\nFirst, we study the local extrema of \\(V_y (y)\\) . The derivative \\(V_{yy}\\) must vanish at those points. We compute the derivative symbolically, set the result to zero and solve for \\(y\\) .\nThe local extrema of \\(V_y\\) are located at the solutions of\n\\[\n    \\pdv[2]{}{y}V(y)=0.\n\\]\n\n\nShow the code\nsol = sp.solve(Vyy, y, dict=True)\n[sol[v][y] for v in [0,1]]\n\n\n[-sqrt(2)*t/2, sqrt(2)*t/2]\n\n\nWe obtain as solution \\[\n\\displaystyle \\left(\\begin{array}{c} -\\frac{\\sqrt{2}\\,t}{2}\\newline \\frac{\\sqrt{2}\\,t}{2} \\end{array}\\right).\n\\]\nThe positions of the extrema of \\(V_y\\) only depend on the depth of the sphere. The horizontal distance between the extrema is \\(\\sqrt{2}t\\).\n\n\nShow the code\nyp = np.sqrt(2.0) / 2 * depth\nfig, ax = plt.subplots(figsize=(6,4))\n\nplt.plot(yy, [1e5 * Vy_num(v) for v in yy], label=r'$V_y$')\nplt.scatter([-yp, yp], [1e5*Vy_num(-yp), 1e5*Vy_num(yp)], color='r', label=r'$\\pm \\frac{\\sqrt{2}}{2}t$')\nplt.xlabel('y in m')\nplt.ylabel('mGal')\nplt.legend()\nplt.grid(True);\n\n\n\n\n\n\n\n\n\nThe relation between \\(V_z (y)\\) and \\(t\\) is not so obvious. There are two inflection points symmetric to \\(y=0\\). The necessary condition for the existence of an inflection point is that\n\\[\n\\dv[2]{}{y} V_z(y) = 0.\n\\]\n\n\nShow the code\nVzyy = sp.diff(Vz, y, 2)\nVzyy.simplify()\nsol = sp.solve(Vzyy, y, dict=True)\n[sol[v][y] for v in [0,1]]\n\n\n[-t/2, t/2]\n\n\nThe inflection points of \\(V_z\\) are at \\(\\pm t/2\\).\n\n\nShow the code\nfig, ax = plt.subplots(figsize=(6,4))\n\nplt.plot(yy, [1e5 * Vz_num(v) for v in yy], label=r'$V_z$')\nplt.scatter([-depth/2, depth/2], [1e5*Vz_num(-depth/2), 1e5*Vz_num(depth/2)], color='r', label=r'$\\pm t/2$')\nplt.xlabel('y in m')\nplt.ylabel('mGal')\nplt.legend()\nplt.grid(True);\n\n\n\n\n\n\n\n\n\n\n\n7.2.2 Deflection of a pendulum\nThe deflection of a pendulum from the vertical direction due to the mass of the sphere is \\[\n\\alpha =\\tan^{-1} \\frac{V_y }{\\gamma_0 +V_z },\n\\]\nwhere \\(\\gamma_0 =9.81\\) \\(m/s^2\\) is a good estimate of the normal gravitational attraction at the surface of the Earth.\nThis is the fundamental idea of the Eötvös torsion balance.\nWith the sphere introduced in the above example we obtain the following figure:\n\n\nShow the code\nVz_ = np.array([Vz_num(v) for v in yy], dtype=float)\nVy_ = np.array([Vy_num(v) for v in yy], dtype=float)\ndeflection = 3600 * 180 / np.pi * np.arctan(Vy_ / (9.81 + Vz_))\n\nfig, ax = plt.subplots(figsize=(6,4))\n\nplt.plot(yy, deflection);\nplt.ylabel('deflection in arcsec')\nplt.xlabel('y in m')\nplt.grid(True);\n\n\n\n\n\n\n\n\n\nThe maximum deflection in arc seconds of the pendulum is\n\n\nShow the code\nprint(np.max(deflection))\n\n\n0.2827865419859818\n\n\nTo put this into perspective:\nThe arc length \\(s\\) along the Earth’s equator corresponding to 1 arcsec is approximately 31 meters:\n\n\nShow the code\ns = np.pi / 180 / 3600 * 6.371e6\nprint(s)\n\n\n30.887479623488538",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Potential and gravitational attraction of a sphere</span>"
    ]
  },
  {
    "objectID": "circular_disc.html",
    "href": "circular_disc.html",
    "title": "8  Circular Disc",
    "section": "",
    "text": "8.1 Potential along the z axis\nWe consider the potential and gravitational attraction of a circular disc in the plane \\(z=0\\) aligned with the z axis.\nTo obtain the potential at the \\(z\\)-axis we integrate over the surface area of the disc: \\[\nV(z) = -f \\frac{m}{r} = -2 \\pi f \\rho_F \\int\\limits_{r=0}^a \\frac{r \\, \\dd r}{\\sqrt{ r^2 + z^2 }}\n\\] with \\(r^2 = x^2 + y^2\\).\nIntegration yields: \\[\nV(z) = 2 \\pi f \\rho_{F} (|z| - \\sqrt{ a^2 + z^2 })\n\\]\nSympy check:\nShow the code\nimport sympy as sp\nfrom sympy import pi, oo\nx, y, z = sp.symbols('x y z', real=True)\nr, f, a, rho = sp.symbols('r f a rho_F', real=True, positive=True)\n\nV = sp.integrate(-2 * pi * f *rho * r / sp.sqrt(r**2 + z**2), (r, 0, a))\nV.simplify()\n\n\n\\(\\displaystyle 2 \\pi f \\rho_{F} \\left(- \\sqrt{a^{2} + z^{2}} + \\left|{z}\\right|\\right)\\)\nShow the code\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nzz = np.linspace(-5, 5, 400)\nfig, ax = plt.subplots(figsize=(6,4))\nplt.scatter(zz, np.abs(zz) - np.sqrt(1 + zz**2),s=3)\nplt.grid(True)\nplt.xlabel('z')\nplt.ylabel('V(z)');\n\n\n\n\n\n\n\n\nFigure 8.2: Potential of a circular disc of radius \\(a\\) at \\(z=0\\).",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Circular Disc</span>"
    ]
  },
  {
    "objectID": "circular_disc.html#gravitational-attraction-along-the-z-axis",
    "href": "circular_disc.html#gravitational-attraction-along-the-z-axis",
    "title": "8  Circular Disc",
    "section": "8.2 Gravitational attraction along the z axis",
    "text": "8.2 Gravitational attraction along the z axis\nThe vertical component of the gravitational attraction is the projection of the field \\(\\vb g\\) onto the vertical direction \\(\\hat{\\vb e}_z\\)\n\\[\n\\vb g(z) = -\\grad V(z)\n\\]\n\\[\n-\\grad V(z) \\cdot \\hat{\\vb e}_z = -\\pdv{}{z}V(z) = 2 \\pi f \\rho_F \\left( \\frac{z}{\\sqrt{ a^2 + z^2 }} - \\text{sign}(z) \\right)\n\\]\nThis is the attraction of a disc of density \\(\\rho_{F}\\) aligned with the plane \\(z=0\\) observed at some point at the \\(z\\) axis.\nSympy check:\n\n\nShow the code\ng = -sp.diff(V, z)\ng.simplify()\n\n\n\\(\\displaystyle \\begin{cases} 0 & \\text{for}\\: z = 0 \\\\2 \\pi f \\rho_{F} z \\left(- \\frac{1}{\\left|{z}\\right|} + \\frac{1}{\\sqrt{a^{2} + z^{2}}}\\right) & \\text{otherwise} \\end{cases}\\)\n\n\n\n\n\n\n\n\nNote\n\n\n\nNote that\n\\[\n\\dv{|z|}{z} = \\text{sign}z.\n\\]\n\n\n\n\nShow the code\nfig, ax = plt.subplots(figsize=(6,4))\nplt.scatter(zz, 2 * np.pi * (zz / np.sqrt(1 + zz**2) - np.sign(zz)),s=3)\nplt.xlabel('z')\nplt.ylabel('g(z)')\nplt.grid(True);\n\n\n\n\n\n\n\n\nFigure 8.3: Vertical attraction of a circular disc of radius \\(a\\) coplanar with \\(z=0\\).\n\n\n\n\n\nThe vertical component of the gravitational attraction obviously has a jump, which equals \\(4 \\pi f \\rho_F\\).\n\n\nShow the code\nsp.limit(g, z, 0, '-') - sp.limit(g, z, 0, '+')\n\n\n\\(\\displaystyle 4 \\pi f \\rho_{F}\\)",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Circular Disc</span>"
    ]
  },
  {
    "objectID": "circular_disc.html#potential-and-attraction-of-a-vertical-cylinder",
    "href": "circular_disc.html#potential-and-attraction-of-a-vertical-cylinder",
    "title": "8  Circular Disc",
    "section": "8.3 Potential and attraction of a vertical cylinder",
    "text": "8.3 Potential and attraction of a vertical cylinder\nThe cylinder is composed of circular discs with infinitely small thickness and constant radius \\(a\\). The integration of an aligned stack of such discs yields a cylinder.\n\n\n\n\n\n\nFigure 8.4: A co-axial stack of circular discs from \\(z=\\) to \\(z=h\\) forming a vertical cylinder of length \\(h\\).\n\n\n\nWe note that\n\\[\n\\rho = \\int_0^h \\rho_F \\, \\dd z.\n\\]\nWe integrate over the attraction for circular discs and obtain for a cylinder enclosed by the two horizontal planes \\(z=0\\) and \\(z=h, h&gt;0\\): \\[\n\\begin{align}\ng(z) & = 2 \\pi f \\rho \\left(h + \\sqrt{ a^2 + z^2 } - \\sqrt{ a^2 + (h - z)^{2} }\\right) \\qfor z &lt; 0 \\\\\n& = 2 \\pi f \\rho \\left(h - 2z + \\sqrt{ a^{2} + z^{2}} - \\sqrt{ a^2 + (h-z)^{2} }\\right) \\qfor h &gt; z \\\\\n& = 2 \\pi f \\rho \\left(-h + \\sqrt{ a^2 + z^2 } - \\sqrt{ a^2 + (h - z)^{2} }\\right) \\quad\\text{otherwise}\n\\end{align}\n\\]\nSympy check:\n\n\nShow the code\nh = sp.symbols('h', real=True, positive=True)\nrho0 = sp.symbols('rho', real=True, positive=True)\ni1 = sp.integrate(-g, z).subs(rho, rho0)\nsp.simplify(i1.subs(z, z-h) - i1.subs(z, z-0))\n\n\n\\(\\displaystyle \\begin{cases} 2 \\pi f \\rho \\left(h + \\sqrt{a^{2} + z^{2}} - \\sqrt{a^{2} + \\left(h - z\\right)^{2}}\\right) & \\text{for}\\: z &lt; 0 \\\\2 \\pi f \\rho \\left(h - 2 z + \\sqrt{a^{2} + z^{2}} - \\sqrt{a^{2} + \\left(h - z\\right)^{2}}\\right) & \\text{for}\\: h &gt; z \\\\2 \\pi f \\rho \\left(- h + \\sqrt{a^{2} + z^{2}} - \\sqrt{a^{2} + \\left(h - z\\right)^{2}}\\right) & \\text{otherwise} \\end{cases}\\)\n\n\n\n\nShow the code\nhh = 1.0\nzabove = np.linspace(-5, 0, 51)\nzinside = np.linspace(0, hh, 51)\nzbelow = np.linspace(hh, 6, 51)\nfig, ax = plt.subplots(figsize=(6,4))\nplt.plot(zabove, \n         2*np.pi*(hh + np.sqrt(1+zabove**2) - \n                  np.sqrt(1 + (hh - zabove)**2)),c='C0',\n        label=r'z&lt;0')\nplt.plot(zinside, \n        2*np.pi*(hh - 2 * zinside + np.sqrt(1+zinside**2) - \n                 np.sqrt(1 + (hh - zinside)**2)),c='C1',\n        label=r'0&lt;z&lt;h')\nplt.plot(zbelow, \n         2*np.pi*(-hh + np.sqrt(1+zbelow**2) - \n                  np.sqrt(1 + (hh - zbelow)**2)),c='C2',\n        label=r'z&gt;h')\nplt.axvspan(0, hh, facecolor='b', alpha=0.1)\nplt.xlabel('z')\nplt.ylabel('g(z)')\nplt.legend()\nplt.grid(True);",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Circular Disc</span>"
    ]
  },
  {
    "objectID": "circular_disc.html#bouguer-plate-anomaly",
    "href": "circular_disc.html#bouguer-plate-anomaly",
    "title": "8  Circular Disc",
    "section": "8.4 Bouguer plate anomaly",
    "text": "8.4 Bouguer plate anomaly\nConsider the solution for \\(z&lt;0\\). What happens to \\(g(z)\\) when \\(a\\) goes to infinity, i.e., the cylinder turns into an infinite horizontal plate? We depart from the first of the above equations. In \\(z&lt;0\\) we have \\[\ng(z) = 2 \\pi f \\rho \\left( h + \\sqrt{ a^2 + z^2 } - \\sqrt{ a^2 + (h - z)^2 }\\right)\n\\] For \\(a \\to \\infty\\) we can expand the square root into a series, e.g. \\[\n\\sqrt{ a^2 + z^2 } = a \\sqrt{ 1 + \\frac{z^2}{a^2} } \\approx a \\left( 1 + \\frac{z^2}{2a^2} - \\dots\\right)\n\\] and \\[\n\\sqrt{ a^2 + (h-z)^2 } = a \\sqrt{ 1 + \\frac{(h-z)^2}{a^2} } \\approx a \\left( 1 + \\frac{(h-z)^2}{2a^2} - \\dots\\right)\n\\] After collecting terms we have \\[\ng(z) = 2 \\pi f \\rho \\left(h +  a \\left[ 1 + \\frac{z^2}{2a^2} - 1 - \\frac{(h-z)^2}{a^2}\\right]\\right) \\approx 2 \\pi f \\rho_{F}h\n\\] This is the well-known equation for the vertical attraction above an infinite horozontal plate of thickness \\(h\\) and density \\(\\rho\\) (Bouguer plate anomaly)\n\\[\ng_B(h) =  2 \\pi f \\rho h\n\\]",
    "crumbs": [
      "Newton potential",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Circular Disc</span>"
    ]
  },
  {
    "objectID": "line_of_mass.html",
    "href": "line_of_mass.html",
    "title": "9  2-D mass distributions",
    "section": "",
    "text": "9.1 A horizontal straight line of mass\nWe consider an elongated mass with a lateral extension that is much larger than any profile crossing it at a right angle. Those mass distributions are invariant along one of the horizontal Cartesian axes.\nIf we consider the \\(x\\)-direction as the strike direction, then we can restrict our derivations to a single arbitrary \\(x\\)-plane, e.g., the plane \\(x=0\\). Thus, any field configuration observed in the \\(y-z\\)-plane is invariant with respect to a shift in the \\(x\\)-direction.\nFirst, we derive an expression for the gravitational attraction of a simple horizontal line, e.g., an infinite wire.\nNext, we make the transition to a polar coordinate system which is much better suited for the purpose of numerical implementation. To this end, we follow the work of Hubbert (1948) and Talwani et al. (1959).\nAs usual, we depart from a simple geometry. Later we integrate over a cross section of arbitrary shape to obtain the potential and gravitational attraction of elongated bodies.\nFor an \\(x\\)-directed straight wire of density \\(\\rho_L\\) we obtain for the gravitational attraction in the plane \\(x=0\\)\n\\[\n\\vb g(0, y, z) = f \\rho_L \\int\\limits_{x'=-\\infty}^\\infty \\grad \\frac{1}{\\sqrt{{x'}^2 + (y - y')^2 + (z - z')^2}} \\, \\dd x'\n\\tag{9.1}\\]\nSymPy is a Python library for symbolic mathematics. It yields the following result for the \\(z\\)-component of \\(\\mathbf g\\), i.e.,\n\\[\ng_z(0, y, z) = \\mathbf g \\cdot \\mathbf e_z =  f \\rho_L \\int\\limits_{x'=-\\infty}^\\infty \\frac{\\partial}{\\partial z} \\frac{1}{\\sqrt{{x'}^2 + (y - y')^2 + (z - z')^2}} \\, \\dd x'\n\\]\nShow the code\nx, y, z, xprime, yprime, zprime, f, rho_L = symbols('x y z xprime yprime zprime f rho_L', real=True)\ng_z = integrate(f * rho_L * diff(1 / sqrt(xprime**2 + (y - yprime)**2 + (z - zprime)**2), z), (xprime, -oo, oo))\n# display(simplify(g_z))\ndisplay(Math(f' g_z(y,z) = {latex(simplify(g_z))}'))\n\n\n\\(\\displaystyle  g_z(y,z) = - \\frac{2 f \\rho_{L} \\left(z - {z}'\\right)}{\\left(y - {y}'\\right)^{2} + \\left(z - {z}'\\right)^{2}}\\)\nintegrate(-diff(-f * rho_L / sqrt(x**2 + y**2 + z**2), z), \n  (x, -oo, oo))\n\n\\[\\begin{equation}- \\frac{2 f \\rho_{L} z}{y^{2} + z^{2}}\\end{equation}\\]\nWe recognize that\n\\[\ng_z(y,z) = - 2 f \\rho_L \\frac{z - z'}{(y - y')^2 + (z - z')^2}\n\\]\nThe attraction of the infinite line of mass is inversely proportional to the distance from the line to the point of observation.\nThe interesting point is here that the numerator is the derivative of the denominator, i.e.,\n\\[\nf'(z) = 2(z - z')\n\\]\nand\n\\[\nf(z) = (y - y')^2 + (z - z')^2\n\\]\nWith the logarithmic derivative\n\\[\n\\int \\frac{f'(z)}{f(z)} \\dd z = \\ln f(z) + C\n\\]\nwe obtain the logarithmic potential by integrating with respect to \\(z\\), which yields\n\\[\nV(y,z) = -2 f \\rho_L \\ln \\sqrt{(y - y')^2 + (z - z')^2} + C\n\\]\nor\n\\[\nV(y,z) = 2 f \\rho_L \\ln \\frac{1}{r}\n\\]\nNote that we have set \\(C = 0 = 2 f \\rho_L \\ln 1\\).\nThus, with a proper choice of \\(C\\), we can shift the potential such that \\(V\\) takes a desired value at a given distance from the line of mass.\nIn our case, the potential is zero at the finite distance of \\(r=1\\), and not at infinity as it would be the case for finite bodies where \\(V \\sim 1/r\\). In the 2-D case, the masses extend to infinity.\nShow the code\nV = 2 * f * rho_L * log(1 / sqrt((y - yprime)**2 + (z - zprime)**2))\n# display(V)\nplot(V.subs([(f, 1), (rho_L, 1), (z, 0), (zprime, 0.5), (yprime, 0)]),\n  (y, -5, 5), size=(4, 3),\n  xlabel='y', ylabel=r'$V(y)$', ylim=(-4, 2), xlim=(-5, 5), axis_center=(-5, -4))\n\n\n\n\n\nPotential \\(V\\) of an infinite wire at \\(y=0\\) and \\(z=0.5\\), \\(f \\rho_L = 1\\).\nShow the code\nplot(g_z.subs([(f, 1), (rho_L, 1), (z, 0), (zprime, 0.5), (yprime, 0)]), \n  (y, -5, 5), size=(4, 3),\n  xlabel='y', ylabel=r'$g_z(y)$', axis_center=(-5, 0), ylim=(0,5), xlim=(-5,5))\n\n\n\n\n\nVertical attraction \\(g_z\\) of an infinite wire at \\(y=0\\) and \\(z=0.5\\), \\(f \\rho_L = 1\\).",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>2-D mass distributions</span>"
    ]
  },
  {
    "objectID": "line_of_mass.html#a-horizontal-straight-line-of-mass",
    "href": "line_of_mass.html#a-horizontal-straight-line-of-mass",
    "title": "9  2-D mass distributions",
    "section": "",
    "text": "Figure 9.1: An infinite horizontal line of mass.\n\n\n\n\n\n\n\n\n\n\n\n\n\nNoteIntegration by substitution\n\n\n\nWe solve this problem as follows:\nThe \\(z\\)-derivative of the integrand is \\[\n\\pdv{}{z} \\frac{1}{\\sqrt{{x'}^2 + (y - y')^2 + (z - z')^2}} = - \\frac{z - z'}{\\sqrt{x'^2 + (y - y')^2 + (z - z')^2}^3}\n\\] With the substitution \\[\nx' = \\sqrt{(y - y')^2 + (z - z')^2} \\tan\\alpha\n\\] we get \\[\n\\begin{align}\n\\dd x' & =  \\sqrt{(y - y')^2 + (z - z')^2} (1 + \\tan^2\\alpha) \\dd \\alpha \\\\\n& = \\sqrt{(y - y')^2 + (z - z')^2} \\frac{ 1 }{ \\cos^2\\alpha} \\dd \\alpha\n\\end{align}\n\\]\nSo, \\[\n\\begin{align}\ng(y,z) & = f \\rho_L \\int\\limits_{x'=-\\infty}^\\infty \\frac{\\partial}{\\partial z} \\frac{1}{\\sqrt{{x'}^2 + (y - y')^2 + (z - z')^2}} \\, \\dd x' \\\\\n& = -f \\rho_L \\int\\limits_{x'=-\\infty}^\\infty\\frac{z - z'}{\\sqrt{x'^2 + (y - y')^2 + (z - z')^2}^3} \\, \\dd x' \\\\\n\\end{align}\n\\]\nAfter substitution we see that the integrand gets \\[\n\\begin{align}\n-\\frac{  (z-z') \\sqrt{(y - y')^2 + (z - z')^2} (1 + \\tan^2\\alpha)}{\\sqrt{ ((y - y')^2 + (z - z')^2) \\tan^2\\alpha + (y - y')^2 + (z - z')^2   }^3 } = \\\\\n- \\frac{ (z-z') }{(y - y')^2 + (z - z')^2 } \\frac{ 1 + \\tan^2 \\alpha }{ \\sqrt{ 1 + \\tan^2 \\alpha }^3} = \\\\\n- \\frac{ (z-z') }{(y - y')^2 + (z - z')^2 } \\frac{ 1 }{ \\sqrt{ 1 + \\tan^2 \\alpha } } = \\\\\n- \\frac{ (z-z') }{(y - y')^2 + (z - z')^2 } \\cos\\alpha\n\\end{align}\n\\]\nwhich finally yields\n\\[\n\\begin{align}\ng(y,z) & = -f \\rho_L \\frac{ z-z' }{(y - y')^2 + (z - z')^2 } \\underbrace{\\int\\limits_{-\\pi/2}^{\\pi/2} \\cos\\alpha \\, \\dd \\alpha}_{=2} \\\\\n& = -2f \\rho_L \\frac{ z-z' }{(y - y')^2 + (z - z')^2 }\n\\end{align}\n\\]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\[\n\\ln r^2 = 2 \\ln r \\] \\[ \\ln r = -\\ln \\frac{1}{r}\n\\]",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>2-D mass distributions</span>"
    ]
  },
  {
    "objectID": "line_of_mass.html#attraction-of-a-plane-lamina",
    "href": "line_of_mass.html#attraction-of-a-plane-lamina",
    "title": "9  2-D mass distributions",
    "section": "9.2 Attraction of a plane lamina",
    "text": "9.2 Attraction of a plane lamina\nThe vertical component of attraction \\(\\dd g\\) due to an element of area \\(\\dd S\\) on an infinite horizontal plane lamina with density \\(\\rho\\) bounded by the planes \\(z\\) and \\(z+\\mathrm{d}z\\) is\n\\[\n\\mathrm{d}g = f \\rho \\mathrm{d}z \\mathrm{d}\\Omega\n\\]\nwhere \\(\\mathrm{d}\\Omega\\) is the solid angle subtended at the origin by the area \\(\\mathrm{d}S\\) (Figure 9.2).\n\n\n\n\n\n\nFigure 9.2: Attraction of an infinite plane lamina of thickness \\(\\dd z\\).\n\n\n\nIt holds with \\(\\dd m = \\rho \\dd z \\dd S\\) that\n\\[\n\\mathrm{d} g = \\frac{ f \\dd m }{ r^2} \\sin\\alpha = \\frac{f \\rho \\dd z \\dd S }{r^{2} }\\sin \\alpha.\n\\]\nFurther, \\[\n\\frac{ \\dd S \\sin\\alpha }{r^2 } = \\dd \\Omega.\n\\]\nis the solid angle subtended at the origin by the area \\(\\dd S\\).\nIf we now consider a finite area \\(S\\) of arbitrary shape, the attraction at the origin due to the enclosed mass will be\n\\[\ng = f \\mathrm{d}z \\int _{S} \\rho \\, \\mathrm{d}\\Omega\n\\]\nor, if \\(\\rho\\) is constant over \\(S\\), this simplifies to\n\\[\ng = f \\rho \\Omega \\mathrm{d}z.\n\\]\nFor a given solid angle \\(\\Omega\\), the attraction of the matter enclosed between two horizontal planes at \\(z=z_{1}\\) and \\(z=z_{2}\\) will be obtained by integrating\n\\[\ng = f \\Omega \\int_{z_{1}}^{z_{2}} \\rho \\, \\mathrm{d}z\n\\]\nan, if \\(\\rho=\\mathrm{const.}\\), this becomes\n\\[\ng = f \\rho \\Omega (z_{2} - z_{1})\n\\]\nFor the infinite horizontal plane the solid angle is \\(2 \\pi\\), such that the attraction of an infinite plate will be\n\\[\ng = 2 \\pi f \\rho (z_{2} - z_{1})\n\\]\nwhich is the vertical attraction of the Bouguer plate of thickness \\(z_{2} - z_{1}\\) and density \\(\\rho\\).",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>2-D mass distributions</span>"
    ]
  },
  {
    "objectID": "line_of_mass.html#the-mathrmdthetamathrmdz-solenoid",
    "href": "line_of_mass.html#the-mathrmdthetamathrmdz-solenoid",
    "title": "9  2-D mass distributions",
    "section": "9.3 The \\(\\mathrm{d}\\Theta\\mathrm{d}z\\) solenoid",
    "text": "9.3 The \\(\\mathrm{d}\\Theta\\mathrm{d}z\\) solenoid\nFirst, we consider the attraction at the origin which will result from a narrow linear strip of infinite length parallel to the \\(x\\)-axis. Such a strip will be defined by the area on the plane \\(z=const\\) lying between two inclined planes which intersect on the \\(x\\)-axis and make with the \\(y\\)-axis the angles of \\(\\Theta\\) and \\(\\Theta + \\mathrm{d}\\Theta\\).\n\n\n\n\n\n\nFigure 9.3: Illustration of the \\(\\dd \\Theta \\dd z\\)-solenoid.\n\n\n\nThe attraction of this strip is proportional to the solid angle subtended at the origin. The solid angle \\(\\mathrm{d}\\Omega\\) between two planes intersecting at an angle \\(\\mathrm{d}\\Theta\\) will bear the same ratio to the total solid angle which the plane angle \\(\\mathrm{d}\\Theta\\) bears to the total plane angle. The total solid angle is the ratio of the surface area of a sphere to the square of its radius, or \\(4 \\pi\\), and the total plane angle is \\(2 \\pi\\). Thus\n\\[\n\\frac{\\mathrm{d}\\Omega}{4 \\pi} = \\frac{\\mathrm{d}\\Theta}{2 \\pi}\n\\] or \\[\n\\mathrm{d}\\Omega = 2 \\mathrm{d}\\Theta.\n\\]\nIntroducing this to the result obtained above gives\n\\[\n\\mathrm{d}g = 2 f \\rho \\mathrm{d}\\Theta \\mathrm{d}z\n\\]\nwhich is the fundamental differential equation of the attraction of a two-dimensional mass. The intersection of the two planes \\(\\Theta\\) and \\(\\Theta + \\mathrm{d}\\Theta\\) with the planes \\(z\\) and \\(z+\\mathrm{d}z\\) defines an elementary prism or solenoid of infinite length and cross-section \\(\\mathrm{d}\\Theta\\mathrm{d}z\\). For a finite area in the plane of integration\n\\[\ng = 2 f \\iint \\rho \\mathrm{d}\\Theta \\mathrm{d}z\n\\]\nAround an elementary prism \\(\\mathrm{d}\\Theta\\mathrm{d}z\\) bounded by the lines \\(\\Theta\\) and \\(\\Theta + \\mathrm{d}\\Theta\\), and \\(z\\) and \\(z+\\mathrm{d}z\\), consider the line integral \\(\\oint \\Theta \\mathrm{d}z\\). Starting at the point \\((\\Theta, z)\\) and traversing the circuit in counter-clockwise direction, the resulting integral will be\n\\[\n\\oint \\Theta \\mathrm{d}z = 0 + (\\Theta + \\mathrm{d} \\Theta)\\mathrm{d}z + 0 - \\Theta \\mathrm{d}z = \\mathrm{d}\\Theta \\mathrm{d}z.\n\\]\nNote that in this circuit \\(\\dd z\\) is zero along the \\(z\\) and \\(z + \\dd z\\) sides.\n\n\n\n\n\n\nFigure 9.4: Sketch of the line integral about a \\(\\dd \\Theta \\dd z\\)-solenoidal.\n\n\n\nAlternatively one can evaluate the integral\n\\[\n\\oint z \\, \\dd \\Theta = 0 + (z + \\dd z) \\dd \\Theta + 0 - z \\dd \\Theta = \\dd z \\dd \\Theta\n\\]\nOver a finite area \\(S\\) we may evaluate the integral by\n\\[\n\\iint_{S} \\mathrm{d}\\Theta \\mathrm{d}z = \\iint_{S} \\left[\\oint \\Theta \\mathrm{d}z \\right] =\n\\iint_{S} \\left[\\oint z \\, \\dd \\Theta \\right].\n\\]\nWhen a separate line integral is taken around each of the elementary prisms of the area, each interior part is traversed twice, whereas the exterior parts are traversed but once and always in the same sense. Consequently,\n\\[\n\\iint_{S} \\mathrm{d}\\Theta \\mathrm{d}z = \\oint_{\\partial S} \\Theta \\mathrm{d}z = \\oint_{\\partial S} z \\, \\dd \\Theta.\n\\]\nThe attraction of a finite mass of constant density is obtained by\n\\[\ng = 2 f \\rho \\oint_{\\partial S} \\Theta \\mathrm{d}z = 2 f \\rho \\oint_{\\partial S} z \\, \\dd \\Theta.\n\\]\n\n\n\n\n\n\nFigure 9.5: Conversion of the surface integral into a line integral.\n\n\n\n\n\n\n\n\nHubbert, M.K., 1948. A LINE-INTEGRAL METHOD OF COMPUTING THE GRAVIMETRIC EFFECTS OF TWO-DIMENSIONAL MASSES. GEOPHYSICS, 13, 215–225. doi:10.1190/1.1437395\n\n\nTalwani, M., Worzel, J.L. & Landisman, M., 1959. Rapid gravity computations for two-dimensional bodies with application to the Mendocino submarine fracture zone. Journal of Geophysical Research, 64, 49–59. doi:10.1029/JZ064i001p00049",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>2-D mass distributions</span>"
    ]
  },
  {
    "objectID": "talwani.html",
    "href": "talwani.html",
    "title": "10  Gravitational attraction of a prism",
    "section": "",
    "text": "10.1 Problem description\nRecall that the vertical component of the gravitational attraction caused by an elongated prismatic body of cross section \\(S\\) is\n\\[\ng_z(x,z) = \\frac{\\partial}{\\partial z}V(x,z) = -2 f \\Delta \\rho \\int\\limits_S \\frac{(z - z')\\, dx' \\,dz'}{{(x-x')^2 + (z-z')^2}}.\n\\]\nIf the point of observation is at the origin, we obtain\n\\[\ng_z(0,0) = \\frac{\\partial}{\\partial z}V(0,0) = 2 f \\Delta \\rho \\int\\limits_S \\frac{z\\, dx \\, dz}{{x^2 + z^2}}.\n\\]\nIt can be shown that this surface integral can be equivalently replaced by a line integral taken along the periphery of \\(S\\).",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Gravitational attraction of a prism</span>"
    ]
  },
  {
    "objectID": "talwani.html#line-integral",
    "href": "talwani.html#line-integral",
    "title": "10  Gravitational attraction of a prism",
    "section": "10.2 Line integral",
    "text": "10.2 Line integral\nThe Stokes theorem states that, for any vector field \\(\\mathbf A = (A_x, 0, A_z)^\\top\\) there holds\n\\[\n\\int\\limits_S (\\nabla \\times \\mathbf A) \\cdot d\\mathbf s = \\oint\\limits_C \\mathbf A \\cdot d\\mathbf \\ell,\n\\]\nwhere \\(d\\mathbf\\ell = \\mathbf e_x dx + \\mathbf e_z dz\\) is the oriented line element tangential to the curve \\(C\\), and \\(d\\mathbf s = dx \\,dz \\, \\mathbf e_y\\) the oriented surface element normal to the cross section \\(S\\). It follows by inspection that\n\\[\n\\partial_z A_x - \\partial_x A_z = 2 f \\Delta \\rho \\frac{z}{x^2 + z^2}\n\\]\nsuch that, after making the ansatz (Zhou (2008))\n\\[\nA_x = 0, \\qquad A_z = -2 f \\Delta\\rho \\, z \\left(\\frac{1}{z} \\, \\tan^{-1}\\frac{x}{z}\\right) = -2 f \\Delta \\rho \\, \\theta\n\\]\nThe angle \\(\\theta\\) is taken from the positive \\(x\\)-axis towards the positive \\(z\\)-axis.\nTalwani et al. (1959) have shown that the vertical component of the gravitational attraction of a two-dimensional prismatic body is, at the origin, equal to\n\\[\ng_z(0, 0) = 2 f \\Delta \\rho \\oint\\limits_C z \\, d\\theta,\n\\]\ni.e., a line integral taken along its periphery.\nThe following sketch illustrates the situation (taken from the original Talwani paper).\n\nLet \\(ABCDEF\\) be a given polygon with \\(n\\) sides and let \\(P\\) be the point at which the gravitational attraction due to this body has to be computed.\nFurther, let \\(z\\) be defined positive downwards and let \\(\\theta\\) be measured from the positive \\(x\\)-axis towards the positive \\(z\\)-axis.\nLet us evaluate the integral \\(\\oint z\\, d\\theta\\) for the above polygon.\nWe consider here the contribution from the side \\(BC\\). The remaining sides have to be added to obtain the total gravitational attraction of the complete prism.\nAt the point \\(Q\\) the line \\(BC\\) meets the \\(x\\)-axis at an angle \\(\\phi_i\\).\nLet \\(PQ = a_i\\). For any arbitrary point \\(R = R(x,z)\\) on the side \\(BC\\) there hold the two equivalent equations\n\\[\nz = x \\tan\\theta\n\\]\nand\n\\[\nz = (x - a_i) \\tan\\phi_i.\n\\]\nAfter eliminating \\(x\\) we obtain an expression for \\(z = z(\\theta)\\):\n\\[\nz = \\frac{a_i \\tan\\phi_i \\tan\\theta}{\\tan\\phi_i - \\tan\\theta}\n\\]\nThe contribution of the segment \\(BC\\) to the above line integral can now be rewritten as\n\\[\n\\int_{BC} z \\, d\\theta = \\int\\limits_B^C \\frac{a_i \\tan\\phi_i \\tan\\theta}{\\tan\\phi_i - \\tan\\theta} \\, d\\theta =: Z_i.\n\\]\nThe vertical component of the gravitational attraction is\n\\[\ng_z(0, 0) = 2 f \\Delta \\rho \\sum_{i=1}^n Z_i.\n\\]\nIt remains to solve the integral in the expression for \\(Z_i\\). To this end, we use Sympy.",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Gravitational attraction of a prism</span>"
    ]
  },
  {
    "objectID": "talwani.html#implementation",
    "href": "talwani.html#implementation",
    "title": "10  Gravitational attraction of a prism",
    "section": "10.3 Implementation",
    "text": "10.3 Implementation\n\n\nShow the code\na, x, z, phi, theta, Z = symbols('a x z phi theta Z', real=True)\nZ = solve(\n    [tan(theta) * x - z, (x - a) * tan(phi) - z], \n    [x, z], dict=True)\n# Z[0][z]\nsimplify(integrate(Z[0][z], theta))\n\n\n\\[\\begin{equation}\\frac{a \\left(- 2 \\theta - 2 \\log{\\left(- \\tan{\\left(\\phi \\right)} + \\tan{\\left(\\theta \\right)} \\right)} \\tan{\\left(\\phi \\right)} + \\log{\\left(\\frac{1}{\\cos^{2}{\\left(\\theta \\right)}} \\right)} \\tan{\\left(\\phi \\right)}\\right) \\cos^{2}{\\left(\\phi \\right)} \\tan{\\left(\\phi \\right)}}{2}\\end{equation}\\]\n\n\nNote that with \\[\n\\log\\left( \\frac{1}{\\cos^2\\theta}\\right) = - 2 \\log \\cos\\theta\n\\] and after combining the \\(\\log\\) terms we obtain the desired integral taken in the limit of integration, i.e., \\(\\theta_i\\) and \\(\\theta_{i+1}\\) \\[\nZ_{i} =a_{1} \\sin \\phi_{i} \\cos \\phi_{i} \\left[ \\theta_{i}-\\theta_{i+1} +\\tan \\phi_{i} \\log _{s} \\frac{\\cos \\theta_{i}\\left(\\tan \\theta_{i}-\\tan \\phi_{j}\\right)}{\\cos \\theta_{i+1}\\left(\\tan \\theta_{i+1}-\\tan \\phi_{i}\\right)}\\right]\n\\] which is the equation for \\(Z_i\\) given in Talwani et al. (1959), p. 50. —\n\n\n\n\nTalwani, M., Worzel, J.L. & Landisman, M., 1959. Rapid gravity computations for two-dimensional bodies with application to the Mendocino submarine fracture zone. Journal of Geophysical Research, 64, 49–59. doi:10.1029/JZ064i001p00049\n\n\nZhou, X., 2008. 2D vector gravity potential and line integrals for the gravity anomaly caused by a 2D mass of depth-dependent density contrast. GEOPHYSICS, 73, I43–I50. doi:10.1190/1.2976116",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Gravitational attraction of a prism</span>"
    ]
  },
  {
    "objectID": "Talwani-Implementation.html",
    "href": "Talwani-Implementation.html",
    "title": "11  Implementation of the TALWANI approach",
    "section": "",
    "text": "11.1 Numerical experiment\nWe define a Python class Polygon which takes as argument a list of coordinates and a parameter. The purpose of this class is twofold:\nTo compare the numerical results, we provide here a simple function which computes the gravitational attraction of a horizontal cylinder of mass m that intersects the vertical plane at the coordinate given by the 2-D array axis. The point of observation is given by the coordinates in the 2-D array obs:\ng = cylinder(obs, mass, axis)\nThe following code implements the Talwani approach:\n\\[\nZ_{i} =a_{1} \\sin \\phi_{i} \\cos \\phi_{i} \\left[ \\theta_{i}-\\theta_{i+1} +\\tan \\phi_{i} \\log _{s} \\frac{\\cos \\theta_{i}\\left(\\tan \\theta_{i}-\\tan \\phi_{j}\\right)}{\\cos \\theta_{i+1}\\left(\\tan \\theta_{i+1}-\\tan \\phi_{i}\\right)}\\right]\n\\]\nWe define a cylinder of radius \\(r=1\\) that will be approximated in the \\(x-z\\)-plane by a sufficiently large number of line segments around its enclosing circle.\nShow the code\nn = 101\nxc = 0.0\nzc = 20.0\nradius = 1.0\nx = np.array([xc + radius * np.cos(0.01 + 2 * np.pi * k / n) for k in np.linspace(0, n-1, n)])\nz = np.array([zc + radius * np.sin(0.01 + 2 * np.pi * k / n) for k in np.linspace(0, n-1, n)])\npoly = Polygon(x, z, 500)\nShow the code\nfig, ax = plt.subplots()\nplt.plot(poly.x, poly.z, marker='.')\nax.set_aspect('equal', 'box');\nWe define a profile perpendicular to the strike of the cylinder.\nThe arrays gtal and gcyl store the values obtained by the Talwani method and the analytical solution for the cylinder, respectively.\nShow the code\nprofile = np.linspace(start=-40, stop=40, num=81)\nnpts = profile.size\ngtal = np.zeros(npts)\ngcyl = np.zeros(npts)\nmass = poly.density * np.pi * radius**2\nfor k in range(npts):\n    gtal[k] = talwani(np.array([profile[k], 0]), poly)\n    gcyl[k] = cylinder(np.array([profile[k], 0]), mass, np.array([xc, zc]))[1]\nThe following plots illustrate the accuracy of the Talwani approach.\nShow the code\nfig, (ax1, ax2) = plt.subplots(1, 2)\nax1.plot(profile, gtal, marker='.')\nax1.plot(profile, gcyl, marker='.')\nax2.plot(profile, gcyl - gtal, marker='.')\nax1.set_title('anomaly')\nax2.set_title('difference');\n\n\n\n\n\nComparison of analytical and numerical solutions (left) and absolute difference (right).\nThe relative error is\nShow the code\nprint(norm(gtal - gcyl) / norm(gcyl))\n\n\n0.0018837709519435105",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Implementation of the TALWANI approach</span>"
    ]
  },
  {
    "objectID": "complex.html",
    "href": "complex.html",
    "title": "12  Introduction to Complex Analysis",
    "section": "",
    "text": "12.1 2-D Problems in Potential Theory Solved Using Complex Analysis\n2-D problems in potential theory can be elegantly solved using complex analysis, the theory of differentiable complex-valued functions of complex variables.\nThe following tools from mathematics are used:",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Introduction to Complex Analysis</span>"
    ]
  },
  {
    "objectID": "complex.html#d-problems-in-potential-theory-solved-using-complex-analysis",
    "href": "complex.html#d-problems-in-potential-theory-solved-using-complex-analysis",
    "title": "12  Introduction to Complex Analysis",
    "section": "",
    "text": "Cauchy’s Integral Theorem\nCauchy’s Integral Formula\nCauchy-Riemann Differential Equations\nResidue Theorem of Complex Analysis",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Introduction to Complex Analysis</span>"
    ]
  },
  {
    "objectID": "complex.html#space-of-complex-numbers-mathbbc",
    "href": "complex.html#space-of-complex-numbers-mathbbc",
    "title": "12  Introduction to Complex Analysis",
    "section": "12.2 Space of Complex Numbers \\(\\mathbb{C}\\)",
    "text": "12.2 Space of Complex Numbers \\(\\mathbb{C}\\)\n\\(\\mathbb{C}\\) is a two-dimensional real vector space with the canonical basis \\((1, i)\\). A point \\(z \\in \\mathbb{C}\\) has real Cartesian coordinates \\(x := \\mathrm{Re}(z)\\), \\(y := \\mathrm{Im}(z) \\in \\mathbb{R}\\), briefly expressed as \\(z = x + i y\\).\nA complex-valued function \\(f: U \\subset \\mathbb{C} \\to \\mathbb{C}\\) on an open subset of \\(\\mathbb{C}\\) can therefore be expressed by decomposing it into its real and imaginary parts \\(f(x + i y) = u(x, y) + i v(x, y)\\), viewed as an \\(\\mathbb{R}^2\\)-valued function of two real variables \\((x, y) \\in \\tilde{U} := \\{(a, b) \\in \\mathbb{R}^2 \\ | \\ a + i b \\in U\\}\\).",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Introduction to Complex Analysis</span>"
    ]
  },
  {
    "objectID": "complex.html#cauchys-integral-theorem",
    "href": "complex.html#cauchys-integral-theorem",
    "title": "12  Introduction to Complex Analysis",
    "section": "12.3 Cauchy’s Integral Theorem",
    "text": "12.3 Cauchy’s Integral Theorem\nIn real analysis, the value of an integral depends on the integration bounds. For complex functions, the path also matters.\nLet \\(U \\subset \\mathbb{C}\\) be a simply connected (no holes) open domain (elementary domain), and \\(f: U \\mapsto \\mathbb{C}\\) a [[Holomorphy|holomorphic]] function. Furthermore, let \\(\\gamma : [a, b] \\to U\\) be a smooth, closed curve. Then: \\[\n\\oint_{\\gamma} f(z) \\, \\mathrm{d}z = 0.\n\\] Proof: With \\(f = u + i v\\) and \\(\\mathrm{d}z = \\mathrm{d}x + i \\mathrm{d}y\\), it follows: \\[\n\\oint_{\\gamma} f(z) \\, \\mathrm{d}z =\n\\oint_{\\gamma} (u + i v) (\\mathrm{d}x + i \\mathrm{d}y) =\n\\oint_{\\gamma} (u \\mathrm{d}x - v \\mathrm{d}y) +\ni \\oint_{\\gamma} (v \\mathrm{d}x + u \\mathrm{d}y).\n\\] Using Green’s Theorem: \\[\n\\iint_D \\left(\\frac{\\partial g}{\\partial x}(x,y) - \\frac{\\partial f}{\\partial y}(x,y)\\right)\\, \\mathrm{d}x \\, \\mathrm{d}y  = \\oint_{C} \\left(f(x,y)\\, \\mathrm{d}x + g(x,y)\\, \\mathrm{d}y\\right),\n\\] the line integrals are replaced by surface integrals over the region \\(D\\) enclosed by the curve \\(\\gamma\\): \\[\n\\begin{align}\n\\oint_\\gamma (u \\, \\mathrm{d}x - v \\, \\mathrm{d}y) & = \\iint_D \\left( -\\frac{\\partial v}{\\partial x} -\\frac{\\partial u}{\\partial y} \\right) \\, \\mathrm{d}x\\,\\mathrm{d}y, \\\\\n\\oint_\\gamma (v \\, \\mathrm{d}x + u \\, \\mathrm{d}y) & = \\iint_D \\left(  \\frac{\\partial u}{\\partial x} - \\frac{\\partial v}{\\partial y} \\right) \\, \\mathrm{d}x\\,\\mathrm{d}y.\n\\end{align}\n\\] For the real and imaginary parts \\(u\\) and \\(v\\) of holomorphic functions in the domain \\(D\\), the Cauchy-Riemann differential equations hold: \\[\n\\begin{align}\nu_x & = +v_y, \\\\\nu_y & = -v_x.\n\\end{align}\n\\] Thus, both integrands—and consequently the integral—are zero: \\[\n\\iint_D \\left( -\\frac{\\partial v}{\\partial x} -\\frac{\\partial u}{\\partial y} \\right) \\, \\mathrm{d}x\\,\\mathrm{d}y = \\iint_D \\left( \\frac{\\partial u}{\\partial y} -\\frac{\\partial u}{\\partial y} \\right) \\, \\mathrm{d}x\\,\\mathrm{d}y = 0,\n\\] and \\[\n\\iint_D \\left( \\frac{\\partial u}{\\partial x} -\\frac{\\partial v}{\\partial y} \\right) \\, \\mathrm{d}x\\,\\mathrm{d}y =\n\\iint_D \\left( \\frac{\\partial u}{\\partial x} -\\frac{\\partial u}{\\partial x} \\right) \\, \\mathrm{d}x\\,\\mathrm{d}y = 0.\n\\] Hence: \\[\n\\oint_{\\gamma} f(z) \\, \\mathrm{d}z = 0 \\qquad \\square\n\\]",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Introduction to Complex Analysis</span>"
    ]
  },
  {
    "objectID": "complex.html#cauchys-integral-formula-cif",
    "href": "complex.html#cauchys-integral-formula-cif",
    "title": "12  Introduction to Complex Analysis",
    "section": "12.4 Cauchy’s Integral Formula (CIF)",
    "text": "12.4 Cauchy’s Integral Formula (CIF)\nLet \\(U\\) be an open subset of the complex plane \\(\\mathbb{C}\\). Consider the closed disk \\(D\\) fully contained within \\(U\\), defined as: \\[\nD = \\{ z : |z - z_{0}| \\le r \\}.\n\\] Let \\(f: U \\mapsto \\mathbb{C}\\) be a holomorphic function, and \\(\\gamma\\) a counterclockwise-oriented circle along the boundary of \\(D\\). Then, for any point \\(a\\) inside \\(D\\): \\[\nf(a) = \\frac{1}{2 \\pi i} \\oint_{\\gamma} \\frac{f(z)}{z - a} \\, \\mathrm{d}z.\n\\] The CIF states that the values of a holomorphic function \\(f\\) inside a disk are fully determined by its values on the boundary of that disk.",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Introduction to Complex Analysis</span>"
    ]
  },
  {
    "objectID": "complex.html#residue-theorem",
    "href": "complex.html#residue-theorem",
    "title": "12  Introduction to Complex Analysis",
    "section": "12.5 Residue Theorem",
    "text": "12.5 Residue Theorem\nIf \\(f(z)\\) is holomorphic in the neighborhood of a point \\(z_{0}\\), then: \\[\n\\oint_{C} f(z) \\, \\mathrm{d}z = 0.\n\\] However, if \\(f(z)\\) has an isolated singularity at \\(z_{0}\\), the integral is generally nonzero and satisfies: \\[\n\\frac{1}{2 \\pi i} \\oint_{C} f(z) \\, \\mathrm{d}z = \\mathrm{Res} f(z).\n\\] For a simple pole: \\[\n\\mathrm{Res} f(z) = \\lim_{ z \\to z_{0} } (z - z_{0}) f(z).\n\\] Instead of computing contour integrals, one only needs to calculate residues, which is often simpler.",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Introduction to Complex Analysis</span>"
    ]
  },
  {
    "objectID": "hilbert.html",
    "href": "hilbert.html",
    "title": "13  Hilbert Transform",
    "section": "",
    "text": "13.1 Representation of the Potential Gradient in the Complex Plane\nLet \\(u\\) and \\(v\\) denote the real and imaginary parts of a complex-valued function of the complex variable \\(z = x + i y\\), with \\(f(x + iy) = u(x,y) + iv(x,y)\\). The functions \\(u\\) and \\(v\\) are real-valued and differentiable at every point in an open subset \\(\\Omega \\subset \\mathbb{C}\\). These functions map from \\(\\mathbb{R}^2\\) to \\(\\mathbb{R}\\).\nA function \\(f: \\mathbb{C} \\to \\mathbb{C}\\), \\(f(z) = u + iv\\), defined in a domain \\(\\Omega\\), is called holomorphic if the real-valued functions \\(u(x,y)\\) and \\(v(x,y)\\) are continuously differentiable in \\(\\Omega\\), and their partial derivatives satisfy the relations \\[\n\\begin{align}\nu_x & = +v_y, \\\\\nu_y & = -v_x,\n\\end{align}\n\\] at every point in \\(\\Omega\\). These are the Cauchy-Riemann differential equations (CRD).\nConsider a function \\(f: \\mathbb{C} \\mapsto \\mathbb{C}\\). We want to demonstrate that this function is complex differentiable and holomorphic.\nDefinition of the derivative:\n\\[\nf'(z) = \\lim_{ h \\to 0 } \\frac{f(z + h) - f(z)}{h}\n\\] What does this limit mean by thinking of the real and imaginary parts separately? Let’s replace \\(z\\) with \\(x+iy\\): \\[\nf'(x +iy) = \\lim_{ h \\to 0 } \\frac{f(x + iy + h) - f(x + iy)}{h}\n\\] Now \\(h\\) is also a complex number. Replace \\(h\\) by \\(a + ib\\) and take the limit as \\(a\\) and \\(b\\) together approach \\(0\\):\n\\[\nf'(x +iy) = \\lim_{ (a,b) \\to (0,0) } \\frac{f(x + iy + a + ib) - f(x + iy)}{a + ib}\n\\] Now introduce a new function \\(F: \\mathbb{R}^{2} \\mapsto \\mathbb{C}\\) that \\(F(x,y) = f(x + iy)\\). \\(F\\) is a function of two real variables, \\(f\\) is a function of a single complex variable.\n\\[\nf'(x +iy) = \\lim_{ (a,b) \\to (0,0) } \\frac{F(x + a, y + b) - F(x, y)}{a + ib}\n\\] If that limit exists, then it is equal to the same limit when we just restrict to moving aong the real axis, i.e., when we approach \\((0,0)\\) just along the real axis. We set \\(b=0\\) and write \\[\nf'(x +iy) = \\lim_{ a \\to 0, b=0 } \\frac{F(x + a, y + b) - F(x, y)}{a + ib}\n\\] This is a restricted situation, but if the limit exists for \\((a,b) \\to (0,0)\\) then this limit must also exist and approach to the same quantity. \\[\nf'(x +iy) = \\lim_{ a \\to 0 } \\frac{F(x + a, y) - F(x, y)}{a} = \\frac{\\partial F}{\\partial x}(x,y)\n\\] Now we repeat the same story and instead of restricting to the real axis we restrict to the imaginary axis. \\[\nf'(x +iy) = \\lim_{ a =\\to= 0, b \\to 0 } \\frac{F(x + a, y + b) - F(x, y)}{a + ib}\n\\] \\[\nf'(x +iy) = \\lim_{ b \\to 0 } \\frac{F(x, y + b) - F(x, y)}{ib} = \\frac{1}{i}\\frac{\\partial F}{\\partial y}(x,y)\n\\] If these limits are the same, then \\[\n\\frac{\\partial F}{\\partial x}(x,y) = \\frac{1}{i} \\frac{\\partial F}{\\partial y}(x,y)\n\\] Now introduce two new functions: \\(u: \\mathbb{R}^{2} \\to \\mathbb{R}\\) and \\(v: \\mathbb{R}^{2} \\to \\mathbb{R}\\), such that \\[\nF(x,y) = u(x,y) + i v(x,y)\n\\] Now expand out the partial derivative \\[\n\\frac{\\partial u}{\\partial x} + i \\frac{\\partial v}{\\partial x} = \\frac{1}{i} \\frac{\\partial F}{\\partial y}(x,y) = \\frac{1}{i}\\left( \\frac{\\partial u}{\\partial y} + i \\frac{\\partial v}{\\partial y} \\right) = \\left( \\frac{1}{i}\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial y} \\right)\n\\] and equate the real and imaginary parts \\[\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial v}{\\partial y} \\qquad \\frac{1}{i} \\frac{\\partial u}{\\partial y} = i \\frac{\\partial v}{\\partial x}\n\\] which become the Cauchy-Riemann equations \\[\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial v}{\\partial y} \\qquad \\frac{\\partial u}{\\partial y} = - \\frac{\\partial v}{\\partial x}\n\\] A function is called holomorphic when these equation are satisfied. The stronger condition however is that \\(u\\) and \\(v\\) are real differentiable functions and they satisfy the CRE.",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Hilbert Transform</span>"
    ]
  },
  {
    "objectID": "hilbert.html#application-to-gravitational-potential",
    "href": "hilbert.html#application-to-gravitational-potential",
    "title": "13  Hilbert Transform",
    "section": "13.2 Application to Gravitational Potential",
    "text": "13.2 Application to Gravitational Potential\nLet \\(V_y(y,z) := \\partial_y V(y,z)\\), and \\(V_{yy} := \\partial^2_{yy}V(y,z)\\), etc., denote the partial derivatives of the gravitational potential in the respective coordinate directions.\nDue to the properties \\[\\nabla \\times \\mathbf{g} = \\mathbf{0},\\] and \\[\\Delta V = 0,\\] the Cauchy-Riemann differential equations \\[\nV_{yz} - V_{zy} = 0 \\qquad \\text{and} \\qquad V_{yy} + V_{zz} = 0\n\\] hold.\n\n\n\n\n\n\nNoteCorrespondence between CR and gravity\n\n\n\n\n\n\nCR equations\nGravity components\n\n\n\n\n\\(x+iy\\)\n\\(z+iy\\)\n\n\n\\(u+iv\\)\n\\(V_y + i V_z\\)\n\n\n\\(u_x\\)\n\\(V_{yz}\\)\n\n\n\\(u_y\\)\n\\(V_{yy}\\)\n\n\n\\(v_x\\)\n\\(V_{zz}\\)\n\n\n\\(v_y\\)\n\\(V_{zy}\\)\n\n\n\\(u_x = v_y\\)\n\\(V_{yz} = V_{zy}\\)\n\n\n\\(u_y = -v_x\\)\n\\(V_{yy} = -V_{zz}\\)\n\n\n\n\n\nWe may therefore assume that \\(V_y\\) and \\(V_z\\) are the real and imaginary parts of a complex function \\(G(s)\\).\nWe say that \\(G(s)\\) is regular or holomorphic.\nThe functions \\(V_y\\) and \\(V_z\\) depend on \\(y\\) and \\(z\\), i.e., \\(V_y = V_y(y, z)\\) and \\(V_z = V_z(y, z)\\).\nIn the complex plane, the real coordinates \\(y\\) and \\(z\\) are combined into a complex coordinate \\(s = z + iy\\).\nThus, we obtain the regular function \\(G : \\mathbb{C} \\to \\mathbb{C}\\) \\[\nG(s) = V_y(s) + i V_z(s).\n\\]\n\n13.2.1 Gravitational Acceleration in \\(\\mathbb{R}\\)\nWith \\(r^2 = (y - y')^2 + (z - z')^2\\), the components of the gravitational acceleration are given by \\[\nV_y(y, z) = - 2 f \\rho \\iint_A \\frac{y - y'}{r^2} \\, dy' \\, dz'\n\\] and \\[\nV_z(y, z) = - 2 f \\rho \\iint_A \\frac{z - z'}{r^2} \\, dy' \\, dz'.\n\\]\n\n\n13.2.2 Gravitational Acceleration in \\(\\mathbb{C}\\)\nThe gravitational acceleration in the complex plane can be expressed as \\[\nG(s) = -2 f \\rho i \\iint_A \\frac{1}{s - s'} \\, dy' \\, dz'.\n\\]\n\n\n\n\n\n\nNote\n\n\n\nNote that with \\(s = z + iy\\), \\(s' = z' + iy'\\) follows\n\\[\ns - s' = (z - z') + i(y - y').\n\\] With complex conjugation we get \\[\n\\overline{s - s'} = (z - z') - i(y - y'),\n\\] such that \\[\n|s|^2 = s \\cdot \\overline{s}.\n\\]\n\n\n\n\n13.2.3 Computation of \\(G\\) in a Source-Free Region\nUsing the Cauchy Integral Formula, we find: Let \\(G : \\Omega \\to \\mathbb{C}\\) be regular in a domain \\(\\Omega\\), and let \\(C : [a, b] \\to \\Omega \\setminus \\{z_0\\}\\) be a closed, positively oriented, piecewise \\(C^1\\)-continuous curve enclosing \\(z_0 \\in \\Omega\\). Then, \\[\nG(z_0) = \\frac{1}{2 \\pi i} \\oint_C \\frac{G(z)}{z - z_0} \\, \\mathrm{d}z.\n\\] The values on the boundary completely determine those inside \\(C\\).\nIf \\(z_0\\) is located on \\(C\\), then the CIF reduces to \\[\nG(z_0) = \\frac{1}{ \\pi i} \\oint_C \\frac{G(z)}{z - z_0} \\, \\mathrm{d}z.\n\\]\n\n\n13.2.4 How to Choose the Integration Path?\nBy the Cauchy Integral Theorem, the integration path can be chosen arbitrarily. Since \\(G(s) \\to 0\\) as \\(y^2 + z^2 \\to \\infty\\), \\(z &lt; 0\\), the integration path is chosen to fully encompass the \\(y\\)-axis, returning along an arc in the upper half-plane, extending to infinity.\n\n\n\n\n\n\nFigure 13.1: Choice of the integration path\n\n\n\n\n\n13.2.5 Derivation of the Hilbert Transform\nWe separate real and imaginary parts of \\(G\\) and obtain the Hilbert Transform Pair \\[\nV_y(y) = +\\frac{1}{\\pi} \\int\\limits_{-\\infty}^\\infty \\frac{V_z(y')}{y' - y} \\, dy'\n\\] and \\[\nV_z(y) = -\\frac{1}{\\pi} \\int\\limits_{-\\infty}^\\infty \\frac{V_y(y')}{y' - y} \\, dy'.\n\\]\nRecognizing these as convolution integrals: \\[\nV_y(y) = -\\frac{1}{\\pi y} \\ast V_z(y) = +\\mathcal{H}\\{V_z(y)\\},\n\\] and \\[\nV_z(y) = +\\frac{1}{\\pi y} \\ast V_y(y) = -\\mathcal{H}\\{V_y(y)\\}.\n\\]\nIn the frequency domain, convolution becomes multiplication.\n\n\n\n\n\n\nNote\n\n\n\nNote that \\[\n\\mathcal{H}(\\mathcal{H}(u))(t) = -u(t),\n\\] which follows from the effect of the Hilbert transform on the Fourier transform of \\(u(t)\\) (see next section).\n\n\n\n\n13.2.6 What is the Fourier Spectrum of \\(-\\frac{1}{\\pi y}\\)?\n\\[\n-\\frac{1}{\\pi} \\int\\limits_{-\\infty}^\\infty \\frac{e^{-i k y}}{y} \\, dy = i \\, \\mathrm{sign}(k).\n\\]\nDerivation using the Residue Theorem in Complex Analysis: Replace \\(\\frac{1}{y}\\) with \\(\\lim_{a \\to 0} \\frac{y}{y^2 + a^2}\\), \\(y = u + iv\\), apply the Residue Theorem, and integrate around poles \\(+ia\\) and \\(-ia\\).\n\n\n\n\n\n\nNoteFourier spectrum of the Hilbert transform operator\n\n\n\nThe goal is to find \\[\n\\mathcal F\\{ -\\frac{1}{\\pi y}, k\\} = -\\frac{1}{\\pi} \\int_{-\\infty}^\\infty \\frac{e^{-i k y}}{y}\\, \\dd y.\n\\] We replace \\(\\frac{1}{y}\\) with \\(\\frac{y}{y^2 + a^2}\\) and evaluate the integral in the limit \\[\n\\lim_{a \\to 0} \\int_{-\\infty}^\\infty \\frac{y}{y^2 + a^2} e^{-i k y}\\, \\dd y.\n\\] The integrand is a complex function of \\(y = u + iv\\), hence \\[\ne^{-iky}=e^{-iku}e^{+kv}\n\\] The roots of the polynomial in the denominator are at \\(y=\\pm ia\\).\nWe use the residual theorem for a simple pole \\[\n\\text{Res} f(y) = \\lim_{y \\to y_{\\text{pole}}}(y - y_{\\text{pole}}) f(y) = \\frac{1}{2 \\pi i} \\oint f(y) \\, \\dd y.\n\\] Since the path of integration is arbitrary, we choose a path such that \\[\nf(y) \\to 0 \\begin{cases}\nk&lt;0 \\text{ and } v \\to +\\infty \\\\\nk&lt;0 \\text{ and } v \\to -\\infty\n\\end{cases}\n\\]\nThis reduces the integration to the real \\(y\\)-axis from \\(-\\infty\\) to \\(+\\infty\\).\n\n\n\n\n\n\nFigure 13.2: Path of integration around the pole at \\(y=-ia\\).\n\n\n\nFor \\(k&lt;0\\) we enclose the pole at \\(y=-ia\\) and integrate clock-wise (sign!) \\[\n\\int_{-\\infty}^\\infty \\frac{y}{y^2 + a^2} e^{-i k y}\\, \\dd y =\n-\\oint \\frac{y}{y^2 + a^2} e^{-i k y}\\, \\dd y =\n-2 \\pi i \\text{Res} f(y).\n\\]\n\\[\n\\begin{align}\n-2 \\pi i \\text{Res}f(y) & = -2 \\pi i \\lim_{y \\to -ia} (y+ia)f(y) \\\\\n& = -2 \\pi i \\lim_{y \\to -ia} (y+ia) \\frac{y e^{-i k y}}{(y-ia)(y+ia)} \\\\\n& = -2 \\pi i \\frac{-ia e^{+i^2 k a}}{-ia -ia} \\\\\n& = -\\pi i e^{-ka}\n\\end{align}\n\\] Now \\[\n\\lim_{a\\to 0} (- \\pi i e^{-ka}) = -\\pi i,\n\\] which leads to the final result \\[\n-\\frac{1}{\\pi} \\int_{-\\infty}^\\infty \\frac{e^{-i k y}}{y}\\, \\dd y =\n\\begin{Bmatrix}\n+i \\qif k&gt;0 \\\\\n-i \\qif k&lt;0\n\\end{Bmatrix}\n= i \\, \\text{sign}(k).\n\\]\n\n\nThus, the spectrum of \\(-\\frac{1}{\\pi y}\\) is \\(i \\, \\mathrm{sign}(k)\\)!\n\n\n\n\n\n\nImportant\n\n\n\nFor negative and positive wave numbers \\(k\\), the spectrum of \\(V_y\\) (or \\(V_z\\)) is multiplied by \\(-i\\) and \\(+i\\), respectively.\n\n\nThe Hilbert transform is a multiplier operator. The multiplier is \\(\\Phi_H(k) = -i \\, \\mathrm{sign}(k)\\), where \\(\\mathrm{sign}\\) is the signum function.\nBy Euler’s formula, \\[\n\\Phi_H(k) =\n\\begin{cases}\n+i = e^{+i\\pi/2} & \\qfor k &lt; 0 \\\\\n0 & \\qfor k = 0 \\\\\n-i = e^{-i\\pi/2} & \\qfor k &gt; 0\n\\end{cases}\n\\]\nThe Hilbert transform has the effect of shifting the phase of the negative wavenumber components of the signal by +90\\(\\textdegree\\) and the phase of the positive wavenumber components by -90\\(\\textdegree\\).\nWhen applied twice, the phase of the negative and positive wavenumber components are shifted by +180\\(\\textdegree\\) and -180\\(\\textdegree\\), resp., which are equivalent amounts. The signal is negated, because \\[\n(\\Phi_H(k))^2 = e^{\\pm i \\pi} = -1 \\qfor k \\ne 0.\n\\]",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Hilbert Transform</span>"
    ]
  },
  {
    "objectID": "hilbert_implementation.html",
    "href": "hilbert_implementation.html",
    "title": "14  Implementation of the Hilbert transform",
    "section": "",
    "text": "14.0.1 Wavenumbers\nThe Hilbert transform \\(V_y(y) = \\mathcal H(V_z(y))\\) is defined by \\[\nV_y(y) = - \\frac{1}{\\pi} -\\!\\!\\!\\!\\!\\! \\int\\limits_{-\\infty}^\\infty \\frac{V_z(y')}{y - y'}\\, \\mathrm d y', \\qquad\\text{Cauchy principal value}\n\\] which can be interpreted as a convolutional integral with the abbreviation \\[\nV_y = -\\frac{1}{\\pi y} * V_z.\n\\] Exploiting the Fourier transform properties, we can equivalently replace the convolution in the spatial domain by a multiplication in the spectral domain, i.e., \\[\n\\mathcal F(V_y) = \\mathcal F\\left(-\\frac{1}{\\pi y}\\right) \\cdot \\mathcal F\\left(V_z\\right)\n\\] The spectrum of the Hilbert transform operator is \\[\n\\mathcal F\\left(-\\frac{1}{\\pi y}\\right) = i \\, \\text{sign}(k),\n\\] where \\(k\\) is the corresponding variable in the spectral domain. In our case, \\(k\\) is referred to as wave number.\nEssentially, the Hilbert transform can be obtained by \\[\nV_y(y) = \\mathcal H(V_z(y)) = \\mathcal F^{-1} \\left( i \\, \\text{sign}(k) \\mathcal F(V_z(y)) \\right)\n\\]\nSince two spectra have to be multiplied properly, we have to know the precise location of the wavenumbers associated with the implementation of the FFT for a given programming language and/or library.\nIn what follows we use the FFT implementation of the Python numpy library.\nFor a given signal length \\(N\\) and a sampling interval \\(\\Delta t\\), the Nyquist frequency is \\[\nf_{N} = \\frac{1}{2 \\Delta t}.\n\\] A signal of length \\(N\\) gets transformed into a spectrum of length \\(N\\). The location of the associated frequencies is\nWe construct a sinusoidal signal S with a frequency of \\(f=5\\) Hz, a period \\(T=0.2\\) s, and a signal length of \\(L=1\\) s. It holds \\[\nS(t) = \\sin(\\frac{2 \\pi}{T}t) = \\sin(2 \\pi f t)\n\\] The sampling frequency is \\(200\\) Hz, which corresponds to a sampling interval of \\(\\Delta t=0.005\\) s and a resulting window length of \\(n=200\\) samples.\nThe Nyquist frequency is \\(f_N = 100\\) Hz.\nShow the code\nL = 1\nf = 5\nT = 1 / f\ndf = 200\nt = np.arange(start = 0, stop = L, step = 1 / df, dtype=float)\nS = np.cos(2 * np.pi * t / T)\nn = len(S)\ndt = L / n\nfig, ax = plt.subplots(figsize=(6,4))\nax.plot(t, S)\nax.grid(True)\nax.set_xlabel(\"t in s\");\nNow we calculate the Fourier spectrum of the signal. We use the FFT implementation of numpy. The array X contains the spectrum of S. Note that X is a complex-valued array.\nWe recognize that the major Fourier component of the signal is associated with \\(f=\\pm 5\\) Hz.\nThe order of the fourier coefficients in X depends on the implementation. It can be calulated using fftfreq.\nShow the code\nX = fft(S)\npower = np.abs(X)**2 / n\nfig, ax = plt.subplots(figsize=(6,4))\nplt.vlines([-f, f], ymin=0, ymax=100, color='red', linewidth=1, label=\"f\")\nplt.plot(fftfreq(n, d=dt), power, 'o', markersize=2, label=\"spectrum\")\nplt.legend()\nplt.xlabel(\"f in Hz\")\nplt.grid(True);\nNow let us compute the Hilbert transform of this signal. To this end, we provide the Fourier spectrum of the Hilbert transform operator, i.e., \\[\n\\mathcal F(-\\frac{1}{\\pi t}, f) = i \\, \\text{sign}(f)\n\\] The Hilbert transform of the cosine is the sine function.\nShow the code\nfi = fftfreq(n, d=dt)\nk = -1j * np.sign(fi)\n\nH = ifft( k * X)\nfig, ax = plt.subplots(figsize=(6,4))\n\nplt.plot(t, S)\nplt.plot(t, H.real)\nplt.grid(True);\nA second application of the Hilbert transform reveals its property of an anti-self adjoint operator, i.e., \\[\n\\mathcal H(\\mathcal H(u(t))) = -u(t)\n\\]\nShow the code\nSH = ifft( k * fft(H)).real\nfig, ax = plt.subplots(figsize=(6,4))\n\nplt.plot(t, S)\nplt.plot(t, SH)\nplt.grid(True);",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Implementation of the Hilbert transform</span>"
    ]
  },
  {
    "objectID": "hilbert_implementation.html#application-to-the-2-d-gravity-problem",
    "href": "hilbert_implementation.html#application-to-the-2-d-gravity-problem",
    "title": "14  Implementation of the Hilbert transform",
    "section": "14.1 Application to the 2-D gravity problem",
    "text": "14.1 Application to the 2-D gravity problem\nWe provide a Python function that calculates the horizontal and vertical component of the gravitational attraction caused by a horizontal cylinder of radius \\(a\\). The function requires as argument the point of observation obs and the point axis where the axis of the cylinder meets the plane of observation. Further, the mass \\(m=\\pi a^2 \\rho\\) of the cylinder must be given.\n\n\nShow the code\ndef cylinder(obs, mass, axis):\n    g = -2 * 6.674e-11 * mass / np.linalg.norm(obs - axis)**2 * (obs - axis)\n    return g\n\n\n\n\nShow the code\ny = np.linspace(start=-1000, stop=1000, num=2001)\ng = np.zeros([len(y), 2])\ndy = (y[-1] - y[0]) / (len(y)-1)\na = 10\nrho = 500\ndepth = 20\nmass = np.pi * a**2 * rho\nfor i, p in enumerate(y):\n    g[i, :] = cylinder(np.array([p, 0]), mass, np.array([0, depth]))\n\n\nNow we take \\(V_z(y)\\) and compute the Hilbert transform. Further, we compare to \\(V_y(y)\\).\n\n\nShow the code\nk = fftfreq(len(y), d=dy)\nV_H = ifft(1j * np.sign(k) * fft(g[:, 1])).real\n\n\n\n\nShow the code\nfig, ax = plt.subplots(figsize=(6,4))\n\nplt.plot(y, g[:, 0], label=\"V_y\")\nplt.plot(y, g[:, 1], label=\"V_z\")\nplt.plot(y, V_H, label=\"V_y (Hilbert)\")\nplt.xlabel('y in m')\nplt.legend()\nplt.grid(True);\n\n\n\n\n\n\n\n\n\nWe note that the Hilbert transform exhibits larger approximation errors towards the boundaries of the observation window.",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Implementation of the Hilbert transform</span>"
    ]
  },
  {
    "objectID": "three-dimensional-problems.html",
    "href": "three-dimensional-problems.html",
    "title": "15  Gravitational Field Caused by a Density Distribution in \\(\\mathbb{R}^3\\)",
    "section": "",
    "text": "15.1 Cartesian Components of the Gravitational Field\nWe consider a density distribution \\(\\rho\\) in a volume within \\(\\mathbb{R}^3\\). The component of the gravitational field vector \\(\\mathbf{g}\\) induced by this density distribution in the direction of \\(\\mathbf{a}\\), at a distance \\(r\\) from the origin, can be expressed as a surface integral:\n\\[\n\\mathbf{g} \\cdot \\mathbf{a} = -\\nabla V \\cdot \\mathbf{a} = -f \\rho \\iint \\frac{\\mathbf{a} \\cdot \\mathbf{u}_n}{r} \\, \\mathrm{d}s\n\\]\nWe use the following identity: \\[\n\\mathbf{a} \\cdot \\nabla V = \\nabla \\cdot (V \\mathbf{a}) - V \\underbrace{\\nabla \\cdot \\mathbf{a}}_{= 0}.\n\\]\nThus: \\[\n-f \\rho \\int_V \\mathbf{a} \\cdot \\nabla \\frac{1}{r} \\, \\mathrm{d}V = -f \\rho \\int_V \\nabla \\cdot \\left( \\frac{1}{r} \\mathbf{a} \\right) \\, \\mathrm{d}V =\n-f \\rho \\iint_S \\frac{\\mathbf{a} \\cdot \\mathbf{u}_n}{r} \\, \\mathrm{d}s.\n\\]\nWe now consider a position vector \\(\\mathbf{r}\\) and project the field \\(\\mathbf{g}\\) onto the direction of \\(\\mathbf{r}\\), i.e., onto \\(\\frac{\\mathbf{r}}{r}\\).\nFor a surface element \\(\\mathrm{d}s\\), the integrand becomes: \\[\n-f \\rho \\mathbf{r} \\cdot \\mathbf{u}_n \\frac{1}{r^2} \\, \\mathrm{d}s = -f \\frac{m}{r^2} \\, \\mathrm{d}s,\n\\] where the surface element has the associated mass: \\[\nm(\\mathbf{r}) = \\rho \\mathbf{r} \\cdot \\mathbf{u}_n.\n\\]\nThe gravitational field \\(\\mathbf{g}\\) can be expressed as: \\[\n\\mathbf{g} = f \\rho \\iint \\frac{1}{r} \\frac{\\mathbf{r}}{r} \\cdot \\mathbf{u}_n \\, \\mathrm{d}s =\nf \\iint \\frac{\\rho \\mathbf{r} \\cdot \\mathbf{u}_n}{r^2} \\, \\mathrm{d}s =\nf \\iint \\frac{\\sigma'}{r^2} \\, \\mathrm{d}s.\n\\]\nThe gravitational effect of a body is equivalent to that of an artificial mass distribution on its surface, with surface density: \\[\n\\sigma'(\\mathbf{r}) = \\rho \\mathbf{r} \\cdot \\mathbf{u}_n.\n\\]\nThe surface density is a purely computational quantity. Unlike the constant volume density, it is position-dependent and can be positive or negative for the same body.\nThe components \\(g_x\\), \\(g_y\\), and \\(g_z\\) of the field \\(\\mathbf{g}\\) are obtained by projecting the field onto the Cartesian unit vectors. In general: \\[\na_b = \\mathbf{a} \\cdot \\frac{\\mathbf{b}}{|\\mathbf{b}|} = |\\mathbf{a}| \\cos \\theta,\n\\] where \\(\\theta\\) is the angle between the vector \\(\\mathbf{a}\\) and the direction of \\(\\mathbf{b}\\).\nThe \\(z\\)-component of \\(\\mathbf{g}\\) is: \\[\ng_z := \\mathbf{g} \\cdot \\mathbf{e}_z =\nf \\rho \\iint \\frac{\\mathbf{r} \\cdot \\mathbf{u}_n}{r^2} \\frac{z}{r} \\, \\mathrm{d}s =\nf \\rho \\iint \\mathbf{r} \\cdot \\mathbf{u}_n \\frac{z}{r^3} \\, \\mathrm{d}s.\n\\]\nBy dividing the surface of the body into a set of planar sub-areas, the integration can be performed separately for each sub-area. Summing the contributions from all sub-areas yields the gravitational acceleration.",
    "crumbs": [
      "Three-dimensional problems",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Gravitational Field Caused by a Density Distribution in $\\mathbb{R}^3$</span>"
    ]
  },
  {
    "objectID": "three-dimensional-problems.html#surface-density-for-sub-areas",
    "href": "three-dimensional-problems.html#surface-density-for-sub-areas",
    "title": "15  Gravitational Field Caused by a Density Distribution in \\(\\mathbb{R}^3\\)",
    "section": "15.2 Surface Density for Sub-Areas",
    "text": "15.2 Surface Density for Sub-Areas\nFor each \\(i\\)th sub-area, the surface density is position-dependent: \\[\n\\sigma_i'(\\mathbf{r}) = \\rho \\mathbf{r} \\cdot \\mathbf{u}_i.\n\\]\nSumming over all sub-areas gives: \\[\ng_z = f \\sum_i \\rho \\mathbf{r} \\cdot \\mathbf{u}_i \\iint_i \\frac{z}{r^3} \\, \\mathrm{d}s.\n\\]\nThe normal vector \\(\\mathbf{u}_n\\) has Cartesian components: \\[\n\\mathbf{u}_n = \\begin{pmatrix}\n\\ell \\\\\nm \\\\\nn\n\\end{pmatrix}.\n\\]\nThe normal direction of the \\(i\\)th sub-area can be computed in several ways. Let \\((x_1, y_1, z_1)\\) denote the Cartesian coordinates of one of the corners of the \\(i\\)th sub-area. Then: \\[\n\\mathbf{r} \\cdot \\mathbf{u}_n = \\ell x_1 + m y_1 + n z_1.\n\\]\nThe contribution to the solid angle under which the surface element appears from the origin is: \\[\n\\mathrm{d}\\Omega = \\frac{\\cos \\theta}{r^2} \\, \\mathrm{d}s.\n\\]\nAssuming unit surface density: \\[\n\\Omega = \\ell g_x + m g_y + n g_z.\n\\]",
    "crumbs": [
      "Three-dimensional problems",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Gravitational Field Caused by a Density Distribution in $\\mathbb{R}^3$</span>"
    ]
  },
  {
    "objectID": "three-dimensional-problems.html#curl-of-unit-vectors",
    "href": "three-dimensional-problems.html#curl-of-unit-vectors",
    "title": "15  Gravitational Field Caused by a Density Distribution in \\(\\mathbb{R}^3\\)",
    "section": "15.3 Curl of Unit Vectors",
    "text": "15.3 Curl of Unit Vectors\nThe scalar products of \\(\\mathbf{u}_n\\) with the curl of unit vectors are: \\[\n\\mathbf{u}_n \\cdot \\nabla \\times \\frac{\\mathbf{i}}{r} = \\frac{-mz + ny}{r^3},\n\\] \\[\n\\mathbf{u}_n \\cdot \\nabla \\times \\frac{\\mathbf{j}}{r} = \\frac{-nx + \\ell z}{r^3},\n\\] \\[\n\\mathbf{u}_n \\cdot \\nabla \\times \\frac{\\mathbf{k}}{r} = \\frac{mx - \\ell y}{r^3}.\n\\]\nIntegration gives: \\[\nP := \\iint \\mathbf{u}_n \\cdot \\nabla \\times \\frac{\\mathbf{i}}{r} \\, \\mathrm{d}s = n g_y - m g_z,\n\\] \\[\nQ := \\iint \\mathbf{u}_n \\cdot \\nabla \\times \\frac{\\mathbf{j}}{r} \\, \\mathrm{d}s = \\ell g_z - n g_x,\n\\] \\[\nR := \\iint \\mathbf{u}_n \\cdot \\nabla \\times \\frac{\\mathbf{k}}{r} \\, \\mathrm{d}s = m g_x - \\ell g_y.\n\\]\nAdditionally: \\[\n\\ell^2 + m^2 + n^2 = 1.\n\\]\nThus, the gravitational field components are: \\[\n\\begin{align}\ng_x & = \\ell \\Omega - n Q + m R, \\\\\ng_y & = m \\Omega - \\ell R + n P, \\\\\ng_z & = n \\Omega - m P + \\ell Q.\n\\end{align}\n\\]",
    "crumbs": [
      "Three-dimensional problems",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Gravitational Field Caused by a Density Distribution in $\\mathbb{R}^3$</span>"
    ]
  },
  {
    "objectID": "three-dimensional-problems.html#stokes-theorem",
    "href": "three-dimensional-problems.html#stokes-theorem",
    "title": "15  Gravitational Field Caused by a Density Distribution in \\(\\mathbb{R}^3\\)",
    "section": "15.4 Stokes’ Theorem",
    "text": "15.4 Stokes’ Theorem\nUsing Stokes’ Theorem: \\[\n\\iint (\\nabla \\times \\mathbf{F}) \\cdot \\mathrm{d}\\mathbf{S} = \\oint \\mathbf{F} \\cdot \\mathrm{d}\\mathbf{r},\n\\] with: \\[\n\\begin{align}\n\\mathrm{d}\\mathbf{S} & = \\mathbf{u}_n \\, \\mathrm{d}s, \\\\\n\\mathrm{d}\\mathbf{r} & = \\boldsymbol{\\tau} \\, \\mathrm{d}\\tau,\n\\end{align}\n\\] we convert surface integrals over the normal component of the curl of a vector field into line integrals over the vector field along the boundary of the domain: \\[\n\\iint \\mathbf{u}_n \\cdot \\nabla \\times \\frac{\\mathbf{i}}{r} \\, \\mathrm{d}s = \\oint \\frac{\\mathbf{i}}{r} \\, \\mathrm{d}\\tau.\n\\]",
    "crumbs": [
      "Three-dimensional problems",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Gravitational Field Caused by a Density Distribution in $\\mathbb{R}^3$</span>"
    ]
  },
  {
    "objectID": "three-dimensional-problems.html#contributions-of-polygonal-edges",
    "href": "three-dimensional-problems.html#contributions-of-polygonal-edges",
    "title": "15  Gravitational Field Caused by a Density Distribution in \\(\\mathbb{R}^3\\)",
    "section": "15.5 Contributions of Polygonal Edges",
    "text": "15.5 Contributions of Polygonal Edges\nThe contributions from the \\(i\\)th edge of the polygon are: \\[\n\\begin{align}\nP_i & = I L_x, \\\\\nQ_i & = I L_y, \\\\\nR_i & = I L_z,\n\\end{align}\n\\] where: \\[\n\\begin{align}\nL_x & = x_2 - x_1, \\\\\nL_y & = y_2 - y_1, \\\\\nL_z & = z_2 - z_1, \\\\\nL^2 & = L_x^2 + L_y^2 + L_z^2,\n\\end{align}\n\\]\n\\[\n\\begin{align}\nI & = L_x \\int_0^1 \\left(L^2 t^2 + b t + r_1^2 \\right)^{-\\frac{1}{2}} \\, \\mathrm{d}t, \\\\\nt & = \\frac{x - x_1}{x_2 - x_1}, \\\\\nr_1 & = \\sqrt{x_1^2 + y_1^2 + z_1^2}, \\\\\nb & = 2 (x_1 L_x + y_1 L_y + z_1 L_z).\n\\end{align}\n\\]\nFinally, we obtain \\(I\\) for two cases:\n\nIf \\(r_1 + \\dfrac{b}{2L} \\neq 0\\), then: \\[\nI = \\frac{1}{L} \\ln \\left[ \\frac{\\sqrt{L^2 + b + r_1^2} + L + \\frac{b}{2L}}{r_1 + \\frac{b}{2L}} \\right].\n\\]\nIf \\(r_1 + \\dfrac{b}{2L} = 0\\), then: \\[\nI = \\frac{1}{L} \\ln \\frac{|L - r_1|}{r_1}.\n\\]\n\n\n\n\n\n\n\nNote\n\n\n\nA MATLAB implementation of this approach can be downloaded at https://github.com/ruboerner/GravMag3D.",
    "crumbs": [
      "Three-dimensional problems",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Gravitational Field Caused by a Density Distribution in $\\mathbb{R}^3$</span>"
    ]
  },
  {
    "objectID": "electricaldipole.html",
    "href": "electricaldipole.html",
    "title": "16  Potential of an electrical dipole",
    "section": "",
    "text": "16.1 Derivation Using Taylor Series\nTwo charges \\(Q\\) with opposite signs are separated by a distance \\(\\mathbf{a}\\).\nThe electric dipole moment is defined as \\(\\mathbf{p} = Q \\mathbf{a}\\) and points from the negative to the positive charge.\nAccording to the principle of superposition, the potential is given by \\[\nU(\\mathbf{r}) = \\frac{Q}{4 \\pi \\varepsilon} \\left[\n\\frac{1}{|\\mathbf{r} - \\mathbf{a}|}\n-\n\\frac{1}{|\\mathbf{r}|}\n\\right].\n\\]\nFor \\(|\\mathbf{a}| \\ll |\\mathbf{r}|\\), the reciprocal distance (first term in the brackets) can be expanded into a series \\[\n\\begin{align}\n\\frac{1}{|\\mathbf{r} - \\mathbf{a}|} & \\approx\n\\frac{1}{|\\mathbf{r}|} \\left\\{\n1 - 2 \\frac{\\mathbf{a} \\cdot \\mathbf{r}}{|\\mathbf{r}|^2}\n\\right\\}^{-1/2} \\\\\n& \\approx \\frac{1}{|\\mathbf{r}|}\n\\left[\n1 + \\frac{\\mathbf{a} \\cdot \\mathbf{r}}{|\\mathbf{r}|^2}\n\\right].\n\\end{align}\n\\]\nThe dipole potential is thus \\[\nU(\\mathbf{r}) = \\frac{Q}{4 \\pi \\varepsilon}\n\\frac{\\mathbf{a} \\cdot \\mathbf{r}}{|\\mathbf{r}|^3}.\n\\]\nThe scalar product, using \\(r = |\\mathbf{r}|\\) and \\(p = |\\mathbf{p}|\\), leads to the equation \\[\nU(r) = \\frac{p}{4 \\pi \\varepsilon} \\frac{\\cos \\theta}{r^2}.\n\\]\nAdditionally, \\[\n\\nabla \\frac{1}{|\\mathbf{r}|} = - \\frac{\\mathbf{r}}{|\\mathbf{r}|^3}.\n\\]\nThe dipole potential is direction-dependent.\nWe see that the dipole potential can be derived from the single charge potential by differentiating with respect to the coordinates of the single potential along the dipole axis. The term \\(\\mathbf{p} \\cdot \\nabla\\) is understood as a directional derivative. It calculates the projection of the gradient onto the dipole axis. \\[\nU(\\mathbf{r}) = -\\frac{1}{4 \\pi \\varepsilon} \\mathbf{p} \\cdot \\nabla \\frac{1}{|\\mathbf{r}|}.\n\\]",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Potential of an electrical dipole</span>"
    ]
  },
  {
    "objectID": "electricaldipole.html#derivation-using-taylor-series",
    "href": "electricaldipole.html#derivation-using-taylor-series",
    "title": "16  Potential of an electrical dipole",
    "section": "",
    "text": "Figure 16.1: Sketch of an electrical dipole aligned with the \\(z\\)-axis.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nThis result is an approximate solution, as higher-order terms in the Taylor series expansion are neglected.",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Potential of an electrical dipole</span>"
    ]
  },
  {
    "objectID": "electricaldipole.html#field-components",
    "href": "electricaldipole.html#field-components",
    "title": "16  Potential of an electrical dipole",
    "section": "16.2 Field components",
    "text": "16.2 Field components\nThe electric field can be obtained from the potential by applying the gradient\n\\[\n\\mathbf E = -\\grad U.\n\\]\n\n\nShow the code\nimport numpy as np\nfrom sympy import *\nfrom IPython.display import display, Math\nU, r, theta = symbols(\"U r theta\")\nU = cos(theta) / r**2\ndisplay(Math('U(r, \\\\theta) = \\\\frac{p}{4 \\\\pi \\\\varepsilon} ' + latex(U)))\ngrad_sph = [diff(U, r), 1 / r * diff(U, theta)]\nE = [-grad_sph[i] for i in [0,1]]\ndisplay(Math('\\\\mathbf E(r, \\\\theta) = \\\\frac{p}{4 \\\\pi \\\\varepsilon}' + latex(E) + '^\\\\top'))\n\n\n\\(\\displaystyle U(r, \\theta) = \\frac{p}{4 \\pi \\varepsilon} \\frac{\\cos{\\left(\\theta \\right)}}{r^{2}}\\)\n\n\n\\(\\displaystyle \\mathbf E(r, \\theta) = \\frac{p}{4 \\pi \\varepsilon}\\left[ \\frac{2 \\cos{\\left(\\theta \\right)}}{r^{3}}, \\  \\frac{\\sin{\\left(\\theta \\right)}}{r^{3}}\\right]^\\top\\)",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Potential of an electrical dipole</span>"
    ]
  },
  {
    "objectID": "magneticdipole.html",
    "href": "magneticdipole.html",
    "title": "17  Potential of a magnetic dipole",
    "section": "",
    "text": "17.1 Derivation\nThe magnetic field \\(\\mathbf{B}\\) is curl-free outside the source distribution \\[\n\\nabla \\times \\mathbf{B} = \\mathbf{0}\n\\] and has a potential \\[\n\\mathbf{H} = - \\nabla \\Psi.\n\\]\nThe potential \\(\\Psi\\) satisfies the Laplace equation \\[\n\\Delta \\Psi = 0\n\\] since it holds \\(\\nabla \\cdot \\mathbf{B} = 0\\).\nInduction: \\[\n\\mathbf{B} = \\mu_{r} \\mu_{0} \\mathbf{H} = \\mu_{0}(\\mathbf{H} + \\mathbf{M}) = \\mu_{0}\\mathbf{H} + \\mathbf{J}\n\\] where \\(\\mathbf{J}\\) is the magnetic polarization.\nPotential: \\[\n\\begin{align}\n\\Psi(\\mathbf{r}) & = -\\frac{1}{4 \\pi} \\mathbf{m} \\cdot \\nabla \\frac{1}{| \\mathbf{r} - \\mathbf{r'}|} \\\\\n& = \\frac{1}{4 \\pi} \\mathbf{m} \\cdot \\frac{\\mathbf{r} - \\mathbf{r'}}{| \\mathbf{r} - \\mathbf{r'}|^{3}}.\n\\end{align}\n\\]\nIf \\(\\mathbf{m} = (0, 0, m)^\\top\\) and \\(\\mathbf{r'} = (0, 0, 0)^\\top\\), we refer to a vertical magnetic dipole at the origin. Then, with \\(r = |\\mathbf{r}|\\): \\[\n\\Psi(\\mathbf{r}) = \\frac{m}{4 \\pi} \\frac{z}{r^{3}} = \\frac{m}{4 \\pi} \\frac{\\cos \\theta}{r^{2}}.\n\\]",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Potential of a magnetic dipole</span>"
    ]
  },
  {
    "objectID": "magneticdipole.html#magnetic-field",
    "href": "magneticdipole.html#magnetic-field",
    "title": "17  Potential of a magnetic dipole",
    "section": "17.2 Magnetic Field",
    "text": "17.2 Magnetic Field\nThe magnetic field is given by: \\[\n\\begin{align}\n\\mathbf{H} & = - \\nabla \\Psi \\\\\n& = -\\frac{m}{4 \\pi} \\left( \\hat{\\mathbf{r}} \\frac{\\partial}{\\partial r} + \\frac{1}{r} \\hat{\\theta} \\frac{\\partial}{\\partial \\theta} + \\frac{1}{r \\sin \\theta} \\hat{\\phi} \\frac{\\partial}{\\partial \\phi} \\right) \\frac{\\cos \\theta}{r^{2}} \\\\\n& = +\\frac{m}{4 \\pi} \\left( \\hat{\\mathbf{r}} \\frac{2 \\cos \\theta}{r^{3}} + \\hat{\\theta} \\frac{\\sin \\theta}{r^{3}} \\right) \\\\\n& = (H_{r}, H_{\\theta}, 0)^\\top.\n\\end{align}\n\\]\nThe magnitude of the field is: \\[\nH = \\sqrt{H_{r}^{2} + H_{\\theta}^{2}} = \\frac{m}{4 \\pi r^{3}} \\sqrt{1 + 3 \\cos^{2} \\theta}.\n\\]\nThe field strength decreases as \\(r^{-3}\\), and the field direction depends on the angle \\(\\theta\\).\nThe magnitude of the field along the dipole axis is twice as large as that in the equatorial plane. At \\(\\theta = 0\\) and \\(\\theta = \\frac{\\pi}{2}\\), one of the components of \\(\\mathbf{H}\\) vanishes. These positions are known as the Gauss first and second principal axes, respectively.",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Potential of a magnetic dipole</span>"
    ]
  },
  {
    "objectID": "magneticdipole.html#spatial-distribution-of-the-dipole-moment",
    "href": "magneticdipole.html#spatial-distribution-of-the-dipole-moment",
    "title": "17  Potential of a magnetic dipole",
    "section": "17.3 Spatial Distribution of the Dipole Moment",
    "text": "17.3 Spatial Distribution of the Dipole Moment\nDipole density: Magnetization corresponds to the density of dipole moments: \\[\n\\mathbf{m} = \\int_{V} \\mathbf{M} \\, \\mathrm{d}{^3\\vb r}.\n\\]\nSubstituting the dipole moment into the potential equation gives: \\[\n\\Psi(\\mathbf{r}) = -\\frac{1}{4 \\pi} \\int \\mathbf{M} \\cdot \\nabla \\frac{1}{|\\mathbf{r} - \\mathbf{r'}|} \\, \\mathrm{d}{^3\\vb r}.\n\\]\nFor homogeneous magnetization: \\[\n\\Psi(\\mathbf{r}) = -\\frac{1}{4 \\pi} \\mathbf{M} \\cdot \\nabla \\int \\frac{1}{|\\mathbf{r} - \\mathbf{r'}|} \\, \\mathrm{d}{^3\\vb r}.\n\\]\n\n\n\n\n\n\nNoteThe Poisson-Eötvös relation\n\n\n\nWe depart from the magnetic potential \\(\\Psi\\) \\[\n\\Psi(\\vb{r}) = -\\frac{1}{4 \\pi} \\grad \\cdot \\int \\vb{M} \\frac{1}{|\\vb{ r}|} \\, \\dd {^3\\vb r}.\n\\] In the case of a homogeneous magnetization we write \\[\n\\Psi(\\vb{r}) = -\\frac{1}{4 \\pi} \\vb{M} \\cdot \\grad  \\int \\frac{1}{|\\vb{ r}|} \\, \\dd {^3\\vb r}\n\\] Recall the gravitational potential \\[\nV(\\vb{r}) = f \\rho \\int \\frac{1}{|\\vb{r}|} \\, \\dd {^3\\vb r}\n\\] which we insert into the magnetic dipole potential to obtain \\[\n\\Psi(\\vb{r}) = -\\frac{1}{4 \\pi} \\frac{\\vb{M}}{f \\rho} \\cdot \\grad V(\\vb{r}).\n\\] This is the Poisson formula. In a Cartesian coordinate system we write for the partial derivatives \\[\nV_{x} = \\frac{ \\partial V (\\vb r)}{ \\partial x} \\text{ etc.}\n\\] and \\[\n\\vb{M} = (M_{1}, M_{2}, M_{3})^\\top.\n\\] Now, with \\[\n\\Psi(\\vb r) = -\\frac{1}{4 \\pi f \\rho}(M_{1}V_{x}(\\vb r) + M_{2}V_{y}(\\vb r) + M_{3}V_{z}(\\vb r))\n\\]\nand \\[\n\\vb{B}(\\vb r) = -\\mu_{0}\\grad \\Psi(\\vb r)\n\\] we obtain \\[\n\\begin{align}\nB_{x}(\\vb r) &= \\frac{\\mu_{0}}{4 \\pi f \\rho} (M_{1}V_{xx}(\\vb r) + M_{2}V_{yx}(\\vb r) + M_{3}V_{zx}(\\vb r)) \\\\\nB_{y}(\\vb r) &= \\frac{\\mu_{0}}{4 \\pi f \\rho} (M_{1}V_{xy}(\\vb r) + M_{2}V_{yy}(\\vb r) + M_{3}V_{zy}(\\vb r)) \\\\\nB_{z}(\\vb r) &= \\frac{\\mu_{0}}{4 \\pi f \\rho} (M_{1}V_{xz}(\\vb r) + M_{2}V_{yz}(\\vb r) + M_{3}V_{zz}(\\vb r))\n\\end{align}\n\\] We introduce the Poisson-Eötvös tensor \\[\n\\tilde{G} = \\tilde{G}(\\vb r) = \\frac{\\mu_{0}}{4 \\pi f \\rho}\n\\begin{pmatrix}\nV_{x x} & V_{xy} & V_{xz} \\\\\nV_{y x} & V_{yy} & V_{yz} \\\\\nV_{z x} & V_{zy} & V_{zz}\n\\end{pmatrix}\n\\] and get \\[\n\\vb{B} = \\tilde{G} \\vb{M}.\n\\] It is therefore possible to calculate the components of the magnetic anomaly of a body with homogeneous magnetization by providing the second-order partial derivatives of the gravitational potential of the same body with assumed homogeneous mass density.",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Potential of a magnetic dipole</span>"
    ]
  },
  {
    "objectID": "magneticdipole.html#magnetic-dipole",
    "href": "magneticdipole.html#magnetic-dipole",
    "title": "17  Potential of a magnetic dipole",
    "section": "17.4 Magnetic Dipole",
    "text": "17.4 Magnetic Dipole\n\n\nShow the code\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sympy import *\n\n\nFor the dipole field of a magnetized sphere at position \\(\\mathbf{r'}\\) with dipole moment \\(\\mathbf{m}\\): \\[\n\\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}}{4 \\pi R^5} \\left( 3 (\\mathbf{m}^\\top (\\mathbf{r} - \\mathbf{r'})) (\\mathbf{r} - \\mathbf{r'}) - \\mathbf{m} R^2 \\right).\n\\]\n\n17.4.1 Derivation using SymPy\n\n\nShow the code\nm_x, m_y, m_z, x, y, z, mu = symbols('m_x m_y m_z x y z mu_0', real=True)\nr = symbols('r', positive=True)\nm = Matrix([m_x, m_y, m_z])\nV = -mu / 4 / pi * m.dot([diff(1 / sqrt(x**2 + y**2 + z**2), q) for q in [x,y,z]])\nV\n\n\n\\(\\displaystyle - \\frac{\\mu_{0} \\left(- \\frac{m_{x} x}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{3}{2}}} - \\frac{m_{y} y}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{3}{2}}} - \\frac{m_{z} z}{\\left(x^{2} + y^{2} + z^{2}\\right)^{\\frac{3}{2}}}\\right)}{4 \\pi}\\)\n\n\nThe field can be obtained by taking the negative gradient of the potential:\n\n\nShow the code\nB = [-diff(V, p) for p in [x,y,z]]\nsimplify(Matrix([B[0], B[1], B[2]])).subs(x**2+y**2+z**2, r**2)\n\n\n\\(\\displaystyle \\left[\\begin{matrix}\\frac{\\mu_{0} \\left(- m_{x} r^{2} + 3 x \\left(m_{x} x + m_{y} y + m_{z} z\\right)\\right)}{4 \\pi r^{5}}\\\\\\frac{\\mu_{0} \\left(- m_{y} r^{2} + 3 y \\left(m_{x} x + m_{y} y + m_{z} z\\right)\\right)}{4 \\pi r^{5}}\\\\\\frac{\\mu_{0} \\left(- m_{z} r^{2} + 3 z \\left(m_{x} x + m_{y} y + m_{z} z\\right)\\right)}{4 \\pi r^{5}}\\end{matrix}\\right]\\)\n\n\nThis result can be rewritten in compact form as \\[\n\\mathbf{B}(\\mathbf r)= \\frac{\\mu_0}{4 \\pi r^3}\n\\left(3({\\mathbf{m}} \\cdot {\\hat{\\mathbf{r}}}) {\\hat{\\mathbf{r}}}-{\\mathbf{m}}\\right)\n\\] with the radial unit vector \\[\n\\hat{\\mathbf r} = \\frac{\\mathbf r}{r}, \\quad r = |\\mathbf r|.\n\\]\nThe induced magnetization is caused by the magnetic field within the body: \\[\n\\mathbf{M}_{i} = (\\mu_{r} - 1) \\mathbf{H} = \\kappa \\mathbf{H} = \\frac{\\kappa}{\\mu_{0}} \\mathbf{B}.\n\\]\nThe susceptibility \\(\\kappa\\) is obtained from the magnetic permeability: \\[\n\\mu = \\mu_{0} \\mu_{r} = \\mu_{0}(1 + \\kappa),\n\\] hence: \\[\n\\kappa = \\mu_{r} - 1.\n\\]\nThe susceptibility is a dimensionless quantity, typically expressed in \\(10^{-5}\\) SI units.\nThe dipole moment of a sphere with radius \\(a\\) and susceptibility \\(\\kappa\\) in the geomagnetic main field \\(\\mathbf{T_{0}}\\) is: \\[\n\\mathbf{m} = \\frac{\\kappa}{\\mu_{0}} \\mathbf{T_{0}} \\frac{4 \\pi}{3} a^{3}.\n\\]",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Potential of a magnetic dipole</span>"
    ]
  },
  {
    "objectID": "magneticdipole.html#numerical-example",
    "href": "magneticdipole.html#numerical-example",
    "title": "17  Potential of a magnetic dipole",
    "section": "17.5 Numerical example",
    "text": "17.5 Numerical example\nWe consider a magnetized sphere of radius \\(a=5\\) m located at a depth of \\(z=15\\) m. The susceptibility is \\(\\kappa=0.126\\) SI.\nThe magnetic main field is \\(\\vb T_0 = (18400, 0, 43500)^\\top\\) nT.\nThe magnetization is \\[\n\\vb M = \\frac{ \\kappa }{ \\mu_0} \\vb T_0,\n\\]\nthe equivalet dipole moment is \\[\n\\vb m = \\vb M \\frac{ 4 \\pi a^3 }{3 }.\n\\]\nWe plot the total field anomaly\n\\[\n\\delta \\vb T = \\vb B \\cdot \\frac{ \\vb T_0 }{| \\vb T_0 | },\n\\] which is the projection of the anomaly \\(\\vb B\\) onto the direction of the main field \\(\\vb T_0\\).\n\n\n\n\n\n\nNoteTotal field anomaly\n\n\n\nWe denote \\(\\vb T_a\\) as the magnetic anomaly vector. Then the total field anomaly \\(\\delta T\\) is given by\n\\[\n\\begin{align}\n\\delta T & = |\\mathbf{T}_{0} + \\mathbf{T}_{a}| - | \\mathbf{T}_{0} | \\\\\n& =  |\\mathbf{T}_{0} + \\mathbf{T}_{a}|  - T_{0} \\\\\n& = \\sqrt{ (\\mathbf{T}_{0} + \\mathbf{T}_{a}) \\cdot (\\mathbf{T}_{0} + \\mathbf{T}_{a}) } - T_{0} \\\\\n& = \\sqrt{ T_{0}^{2} + 2 \\mathbf{T}_{0} \\cdot \\mathbf{T}_{a} + T_{a}^{2}} - T_{0}.\n\\end{align}\n\\]\nFor small anomalies with \\(T_a \\ll T_0\\) we can expand the root in a series\n\\[\n\\begin{align}\n\\delta T & \\approx T_{0} \\left( \\sqrt{ 1 + 2\\frac{\\mathbf{T}_{a} \\cdot \\mathbf{T}_{0}}{T_{0}^{2}} } - 1\\right) \\\\\n& \\approx T_{0} \\left( 1 +  \\frac{\\mathbf{T}_{a} \\cdot \\mathbf{T}_{0}}{T_{0}^{2}} - 1\\right)  \\\\\n& = \\mathbf{T}_{a} \\cdot \\frac{\\mathbf{T}_{0}}{T_{0}}.\n\\end{align}\n\\] We see that the total feld anomaly is the projection of the anomaly vector onto the direction of the inducing field.\nIIn the literature, the total field anomaly is often abbreviated as TMI anomaly (total magnetic field intensity anomaly).\n\n\n\n\nShow the code\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits import axes_grid1\n\ndef add_colorbar(im, aspect=20, pad_fraction=0.5, **kwargs):\n    \"\"\"Add a vertical color bar to an image plot.\"\"\"\n    divider = axes_grid1.make_axes_locatable(im.axes)\n    width = axes_grid1.axes_size.AxesY(im.axes, aspect=1./aspect)\n    pad = axes_grid1.axes_size.Fraction(pad_fraction, width)\n    current_ax = plt.gca()\n    cax = divider.append_axes(\"right\", size=width, pad=pad)\n    plt.sca(current_ax)\n    return im.axes.figure.colorbar(im, cax=cax, **kwargs)\n\ndef dipole(r, rp, m):\n    mu = np.pi * 4e-7\n    R = np.linalg.norm(r - rp)\n    B = mu / (4 * np.pi * R**3) * (\n        3 * np.dot(r - rp, m) * (r - rp) / R**2 - m)\n    return B\n\nT0 = np.array([18400, 0, 43500])\nmu = np.pi * 4e-7\nkappa = 0.126\nM = T0 / mu * kappa\na = 5\ndepth = 15\nvol = 4 * np.pi * a**3 / 3\n\nx = np.arange(start=-50,stop=51)\ny = np.arange(start=-30,stop=31)\nbz = np.zeros([len(y), len(x)])\nbt = np.zeros([len(y), len(x)])\nfor i, p in enumerate(x):\n    for j, q in enumerate(y):\n        B = dipole(np.array([p, q, 0]), np.array([0, 0, depth]), M * vol)\n        bz[j, i] = B[2]\n        bt[j, i] = B.dot(T0) / np.linalg.norm(T0)\n\nfig, ax = plt.subplots(figsize=(6,4))\nc = ax.pcolormesh(x, y, bz, cmap=\"RdBu_r\", vmin=-8, vmax=8)\nax.grid(True, alpha=0.4)\nxa, ya, arrow_length = 40, 25, 5\nax.arrow(x=xa, y=ya, dx=arrow_length, dy=0, width=0.5, head_length=1.5)\nax.annotate('N', xy=(xa-4,ya-1))\nadd_colorbar(c)\nax.set_aspect(1)\nax.set_title('Total field anomaly')\nax.set_xlabel('x')\nax.set_ylabel('y');\n\n\n\n\n\n\n\n\n\nProfile along the \\(x\\)-axis:\n\n\nShow the code\nBt = bt[30, :]\nfig, ax = plt.subplots(figsize=(6,4))\nplt.plot(x, Bt)\nplt.xlabel('x in m')\nplt.ylabel(r'$\\delta T$ in nT')\nax.set_title('Total field anomaly')\n#circle = Circle((0.0, 0.0), 2.0)\n#ax.add_patch(circle)\n\nplt.grid(True)\nplt.scatter([0], [0], color='r');\n\n\n\n\n\n\n\n\n\nWe recognize the minimum of the anomaly, which is characteristically shifted towards north for measurements in the mid-latitudes of the northern hemisphere.\n\n\n\n\n\n\nTip\n\n\n\nMore interesting examples can be generated by changing the components of the main field T0 in the code cell above.\nThe following two cases are of particular interest:\n\nT0 = np.array([0, 0, Z0])\nT0 = np.array([X0, 0, 0])\n\nwith X0, Z0 positive values given in nT.",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Potential of a magnetic dipole</span>"
    ]
  },
  {
    "objectID": "fieldline.html",
    "href": "fieldline.html",
    "title": "18  Equation of a dipole field line",
    "section": "",
    "text": "18.1 Visualization\nWe try to find an equation for the field lines of a dipole.\nIt holds for a field line that\n\\[\n\\mathbf{H} \\times \\mathrm{d} \\mathbf{s} = \\mathbf{0}\n\\]\nwhich means that both the field vector and the line element are tangential at any point along the field line.\nThe equation for the magnetostatic field of a magnetic dipole aligned with the \\(z\\)-axis is given by\n\\[\n\\mathbf H(r, \\theta) =\n\\left( {H_r \\atop H_\\theta} \\right) =\n\\frac{m}{4 \\pi r^3}\n\\left(\n{{2 \\cos\\theta} \\atop {\\sin\\theta} }\\right).\n\\]\nIn this case, the magnetic dipole moment is given by \\[\n\\mathbf{m} = (0, 0, m)^\\top,\n\\] and the tangential line element is \\[\n\\mathrm d \\mathbf s = (\\mathrm dr, r \\, \\mathrm d\\theta, 0)^\\top.\n\\]\nLet’s compute the cross product with the help of SymPy.\nWe arrive at \\[\nH_r r \\,\\mathrm{d}\\theta = H_\\theta \\,\\mathrm{d} r.\n\\] This is the differential equation of a field line. We need a parametric solution of the form \\(r = r(\\theta)\\).\nWe rearrange the ODE using the definition of \\(\\mathbf H\\) given above into the following form: \\[\n\\frac{\\mathrm{d}r}{\\mathrm{d}\\theta} = 2 r \\cot\\theta\n\\] To obtain a solution using SymPy, we recast r as a symbolic function (of \\(\\theta\\)):\nWe choose \\(C_1=r_0\\), where \\(r_0\\) is an arbitrary scale length. The parametric equation for a field line of a dipole is finally given by \\[\nr(\\theta) = r_0 \\sin^2 \\theta\n\\]\nWe choose an arbitrary scale length \\(r_0\\). Since \\(\\theta\\) is the pole distance angle, \\(\\sin\\theta=1\\) at the equator, i.e., on the plane perpendicular to the dipole. Hence, \\(r_0\\) can be interpreted as the distance to the field line at the equator, since \\(r(\\theta) = r_0\\) for \\(\\theta=\\pi/2\\).\nNote further, that we have to transform \\(r\\) and \\(\\theta\\) into a Cartesian coordinate system using the relations \\[\n\\begin{align}\nx & = r(\\theta) \\cos\\phi \\\\\nz & = r(\\theta) \\sin\\phi\n\\end{align}\n\\] where \\(\\phi = \\pi/2 - \\theta\\).\nShow the code\nn = 100\ntheta_n = np.linspace(start=0, stop=np.pi, num=n)\nr_0 = 1.0\nx = []\nz = []\nfor t in theta_n:\n    x.append(r_0 * np.sin(t)**2 * np.cos(np.pi/2 - t))\n    z.append(r_0 * np.sin(t)**2 * np.sin(np.pi/2 - t))\nShow the code\nfig, ax = plt.subplots(figsize=(6,4))\nplt.plot(x, z, marker='.', markersize=2, linewidth=0.5)\ncircle = mpatches.Circle((0,0), radius=0.1, alpha=0.5, fill=True)\nax.add_patch(circle)\nax.set_xlabel(r'x/r$_0$')\nax.set_ylabel(r'z/r$_0$')\nax.grid(True, alpha=0.3)\nax.set_aspect('equal', 'box')\nWe observe that the shape of the field line is invariant with respect to the ratio \\(r/r_0\\).\nIn planetary geophysics, the L-shell or L-value is a particular set of magnetic field lines. The L-value describes the field lines which cross the Earth’s magnetic equator at a number of Earth radii equal to the L-value.\nL-shells uniquely define regions of particular geophysical interest. For instance, auroral light displays are most common around \\(L=6\\), can reach \\(L=4\\) and even \\(L=2\\) during most severe geomagnetic storms.",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Equation of a dipole field line</span>"
    ]
  },
  {
    "objectID": "fieldline.html#visualization",
    "href": "fieldline.html#visualization",
    "title": "18  Equation of a dipole field line",
    "section": "",
    "text": "Figure 18.2: Planar view of magnetic field lines for L-shells \\(L=3\\) up to \\(L=7\\) (simplified).",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Equation of a dipole field line</span>"
    ]
  },
  {
    "objectID": "fieldline.html#properties-of-field-lines-derived-from-differential-geometry",
    "href": "fieldline.html#properties-of-field-lines-derived-from-differential-geometry",
    "title": "18  Equation of a dipole field line",
    "section": "18.2 Properties of field lines derived from differential geometry",
    "text": "18.2 Properties of field lines derived from differential geometry\nTwo questions are of particular interest:\n\nWhat is the curvature radius of the field line in the equatorial plane?\nAt which angle \\(\\theta\\) the tangential line is horizontal?\n\n\n18.2.1 Curvature\nFor the curvature \\(\\kappa(\\theta)\\) of a parametric curve defined in polar coordinates \\(r\\) and \\(\\theta\\) in the point \\(r(\\theta)\\) there holds (cf. this Wikipedia article)\n\\[\n\\kappa(\\theta) = \\frac{r(\\theta)^2 + 2 r'(\\theta)^2 - r(\\theta) r''(\\theta)}\n{\\left[r(\\theta)^2 + r'(\\theta)^2\\right]^{3/2}}\n\\]\nWe implement this equation to obtain the curvature radius in the equatorial plane where \\(\\theta=\\pi/2\\).\nFirst, we introduce a symbolic function R which defines \\(r(\\theta) = \\sin^2\\theta\\). Next, we implement the curvature function \\(\\kappa(\\theta)\\) using SymPy. Finally, in \\(\\kappa\\) we substitute \\(\\theta\\) by \\(\\pi/2\\).\n\n\nShow the code\nR = sin(theta)**2\nkappa = (R**2 + 2 * diff(R, theta)**2 - R * diff(R, theta, theta)) / (\n        sqrt(R**2 + diff(R, theta)**2)**3)\n\n\n\n\nShow the code\ndisplay(Math('\\\\kappa = ' + latex(kappa.subs(theta, pi/2))))\n\n\n\\(\\displaystyle \\kappa = 3\\)\n\n\nThe curvature evaluates to \\(\\kappa=3\\).\nWe note that the curvature radius is the inverse of the curvature. Hence, when \\(r_0 = 1\\), the curvature radius at the equator is \\(r_\\kappa = 1/3\\).\nLet’s check this:\nThe origin of a circle with curvature radius of \\(r_\\kappa=1/3\\) is at the point \\((2/3, 0)\\). We expect that the shape of this circle approximates the field line near the equatorial plane.\n\n\nShow the code\nfig, ax = plt.subplots(figsize=(6,4))\nplt.plot(x, z, marker='.', markersize=2, linewidth=0.5)\ncircle = mpatches.Circle((0,0), radius=0.1, alpha=0.1, fill=True)\ncheck = mpatches.Circle((2/3,0), radius=1/3, color='green', alpha=0.5, fill=True)\nplt.plot([2/3], [0], 'o', color='black', markersize=1)\nax.add_patch(circle)\nax.add_patch(check)\nax.set_xlabel(r'x/r$_0$')\nax.set_ylabel(r'z/r$_0$')\nax.grid(True, alpha=0.3)\nax.set_aspect('equal', 'box')\n\n\n\n\n\n\n\n\n\n\n\n18.2.2 Horizontal slope\nTo find the angle where the slope of the field line is horizontal, we have to form the parametric derivative of the function in the \\(x-z\\)-plane.\nLet \\(x(\\theta)\\) and \\(z(\\theta)\\) be the coordinates of the points of the curve expressed as functions of a variable \\(\\theta\\), i.e.,\n\\[\nz = z(\\theta), \\qquad x = x(\\theta).\n\\]\nThen the first derivative implied by these parametric equations is easily derived using the chain rule as\n\\[\n\\frac{\\mathrm{d}z}{\\mathrm{d}x} = \\frac{\\mathrm{d}z / \\mathrm{d \\theta}}{\\mathrm{d}x / \\mathrm{d \\theta}} = \\frac{z'(\\theta)}{x'(\\theta)}\n\\]\nwhere the notation \\(x'(\\theta)\\) denotes the derivative of \\(x\\) with respect to \\(\\theta\\).\nTo find the point where the slope of the field line is horizontal, the derivative of \\(z\\) with respect to \\(x\\) must be zero (necessary condition). i.e.,\n\\[\n\\frac{z'(\\theta)}{x'(\\theta)} = 0.\n\\]\nWe search all angles \\(\\theta\\) for which this condition is fulfilled.\n\n\nShow the code\nX = R * cos(pi/2 - theta)\nZ = R * sin(pi/2 - theta)\ntheta_star = np.take(solve(Z.diff(theta) / X.diff(theta)), [1, 3])\nangles = np.array([90 - p.evalf() * 180 / np.pi for p in theta_star])\nangles = angles.astype('float')\nprint('The two angles are at ', angles, ' degrees.')\n\n\nThe two angles are at  [ 35.26438968 -35.26438968]  degrees.\n\n\nAs seen from the dipole position, the field lines are horizontal at an angle of approx. \\(\\pm 35\\textdegree\\) below and above the equatorial plane.\n\n\nShow the code\nfig, ax = plt.subplots(figsize=(6,4))\nplt.plot(x, z, marker='.', markersize=2, linewidth=0.5)\ncircle = mpatches.Circle((0,0), radius=0.1, alpha=0.1, fill=True)\ncheck = mpatches.Circle((2/3,0), radius=1/3, color='green', alpha=0.1, fill=True)\ncheck_slope = mpatches.Wedge((0,0), r=2/3, theta1=360.0+angles[1], theta2=angles[0], color='red', alpha=0.5)\nax.add_patch(circle)\nax.add_patch(check)\nax.add_patch(check_slope)\nax.set_xlabel(r'x/r$_0$')\nax.set_ylabel(r'z/r$_0$')\nax.grid(True, alpha=0.3)\nax.set_aspect('equal', 'box')\n\n\n\n\n\n\n\n\n\nThe distance from the dipole to the points where the slope is horizontal is \\(r^* = r_0 \\sin^2 \\theta^*\\).\nIt is always \\(\\frac{2}{3}r_0\\).\n\n\nShow the code\n[sin(t.evalf())**2 for t in theta_star]\n\n\n[0.666666666666667, 0.666666666666667]",
    "crumbs": [
      "Dipole potential",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Equation of a dipole field line</span>"
    ]
  },
  {
    "objectID": "spherical-intro.html",
    "href": "spherical-intro.html",
    "title": "19  Introduction to Spherical Harmonic Analysis",
    "section": "",
    "text": "19.1 Basics of Spherical Harmonics\nSpherical harmonic analysis is a mathematical method used extensively in geophysics to represent functions on the surface of a sphere. This technique is particularly useful for modeling the global geomagnetic field, which is inherently complex and varies both spatially and temporally.\nIn this chapter, we will cover the following topics:\nFurther, we emphasize the value of spherical harmonics in the mathematical description of the global magnetic field of the Earth.\nSpherical harmonics are a set of orthogonal functions defined on the surface of a sphere. They are the spherical analogues of the Fourier series used in periodic functions. A spherical harmonic function\\(Y_{n}^{m}(\\theta, \\phi)\\)is defined by:\n\\[\nY_{n}^{m}(\\theta, \\phi) = \\sqrt{\\frac{(2n+1)(n-m)!}{4\\pi(n+m)!}} P_{n}^{m}(\\cos \\theta) e^{im\\phi}\n\\]\nwhere:",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Introduction to Spherical Harmonic Analysis</span>"
    ]
  },
  {
    "objectID": "spherical-intro.html#basics-of-spherical-harmonics",
    "href": "spherical-intro.html#basics-of-spherical-harmonics",
    "title": "19  Introduction to Spherical Harmonic Analysis",
    "section": "",
    "text": "\\(n\\) is the degree,\n\\(m\\) is the order,\n\\(\\theta\\) is the colatitude,\n\\(\\phi\\) is the longitude,\n\\(P_{n}^{m}\\) are the associated Legendre polynomials.\n\n\n19.1.1 Application to the Global Geomagnetic Field\nThe Earth’s magnetic field can be expressed as a potential field, which is the gradient of a scalar potential \\(V\\). This potential can be expanded in terms of spherical harmonics:\n\\[\nV(r, \\theta, \\phi) = a \\sum_{n=1}^{\\infty} \\left( \\frac{a}{r} \\right)^{n+1} \\sum_{m=0}^{n} \\left( g_{n}^{m} \\cos m\\phi + h_{n}^{m} \\sin m\\phi \\right) P_{n}^{m}(\\cos \\theta)\n\\]\nwhere:\n\n\\(a\\) is the Earth’s mean radius,\n\\(r\\) is the radial distance from the Earth’s center,\n\\(g_{n}^{m}\\) and \\(h_{n}^{m}\\) are the Gauss coefficients, which are determined from observations.\n\n\n\n19.1.2 Importance in Geophysics\n\nGlobal Representation: Spherical harmonics provide a global representation of the geomagnetic field, allowing for the analysis of its spatial variations.\nData Fitting: By fitting observational data to a spherical harmonic model, geophysicists can infer the distribution of magnetic sources within the Earth.\nTemporal Changes: The coefficients \\(g_{n}^{m}\\) and \\(h_{n}^{m}\\) can be monitored over time to study secular variation, which is the slow change in the Earth’s magnetic field.\n\n\n\n19.1.3 Challenges and Considerations\n\nResolution: The degree \\(n\\) determines the resolution of the model; higher degrees provide more detail but require more data and computational power.\nData Quality: Accurate spherical harmonic models depend on high-quality, globally distributed magnetic field measurements.",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Introduction to Spherical Harmonic Analysis</span>"
    ]
  },
  {
    "objectID": "legendre.html",
    "href": "legendre.html",
    "title": "20  Legendre Polynomials",
    "section": "",
    "text": "20.1 Gravitational Potential\nLegendre Polynomials are an important tool for modelling dipole and multi-pole potentials with axial-symmetric symmetry. In this chapter, we introduce some examples of their usefulness.\nKey applications include modeling the Earth’s oblateness, gravitational potential, tidal effects, satellite orbit perturbations, global circulation patterns, and large-scale geomagnetic and seismic phenomena. The simplification to axisymmetric phenomena is particularly useful when longitudinal variations are negligible or when studying global-scale effects.\nWe depart from the potential \\(V(\\mathbf r)\\) at a point \\(\\mathbf{r}\\) caused by a point mass \\(m\\) located at \\(\\mathbf{r}'\\).\nThe potential at \\(\\mathbf{r}\\) due to a point mass \\(m\\) at \\(\\mathbf{r}'\\) is given by: \\[\nV(\\mathbf{r}) = -f \\frac{m}{|\\mathbf{r} - \\mathbf{r}'|}.\n\\]\nSuppose the point mass is slightly displaced to \\(\\mathbf{r}' = (0, 0, s)^\\top\\) along the \\(z\\)-axis.",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Legendre Polynomials</span>"
    ]
  },
  {
    "objectID": "legendre.html#gravitational-potential",
    "href": "legendre.html#gravitational-potential",
    "title": "20  Legendre Polynomials",
    "section": "",
    "text": "Figure 20.1: Point mass displaced from the origin\n\n\n\n\n\n\n20.1.1 Expansion of the term \\(1/|\\mathbf{r} - \\mathbf{r}'|\\)\nThe frequently occurring term \\(1/|\\mathbf{r} - \\mathbf{r}'|\\) can be expanded into a power series when \\(|\\mathbf{r}'| \\ll |\\mathbf{r}|\\).\nLet \\(\\mathbf{r} = (x, y, z)^\\top\\) (observation point) and \\(\\mathbf{r}' = (0, 0, s)^\\top\\) (source point of the mass). The Euclidean distance between the observation and source points is \\(q = |\\mathbf{r} - \\mathbf{r}'|\\).\nUsing the magnitudes \\(r = |\\mathbf{r}|\\) and \\(s = |\\mathbf{r}'|\\), and applying the law of cosines, we have: \\[\n\\frac{1}{q} = f(r, \\theta) = \\frac{1}{r} \\left[1 + \\left(\\frac{s}{r}\\right)^2 - 2 \\frac{s}{r} \\cos \\theta \\right]^{-1/2}.\n\\]\n\n\n20.1.2 Binomial Expansion for Small Displacements\nFor a small displacement of the source point away from the origin, i.e., for \\(s \\ll r\\), the function \\(f(r, \\theta)\\) can be expanded as a binomial series \\[\nf(r, \\theta) = \\frac{1}{r} (1 + b)^{-1/2} = \\frac{1}{r} \\sum_{n=0}^\\infty \\binom{-1/2}{n} b^n,\n\\] where \\[\nb = \\left(\\frac{s}{r}\\right)^2 - 2 \\frac{s}{r} \\cos \\theta, \\quad |b| &lt; 1.\n\\]\nRearranging the series in powers of \\(\\frac{s}{r}\\) gives \\[\nf(r, \\theta) = \\frac{1}{r} \\sum_{n=0}^\\infty \\left(\\frac{s}{r} \\right)^n P_n(\\cos \\theta).\n\\]\nThe \\(P_n(\\cos \\theta)\\) are polynomials of degree \\(n\\) in \\(\\cos \\theta\\). They are known as Legendre Polynomials or zonal spherical harmonics. Since they are independent of the azimuthal angle \\(\\varphi\\), they have constant values over spherical zones (\\(\\theta = \\text{const}\\)).\n\n\n\n\n\n\nNoteLegendre polynomials\n\n\n\nThe Legendre polynomials can also be defined as the coefficients in a formal expansion in powers of \\(t\\) of the generating function\n\\[\n\\frac{1}{\\sqrt{1 - 2tx + t^2}} = \\sum\\limits_{n=0}^\\infty\nP_n(x)t^n.\n\\] The coefficient of \\(t^n\\) is a polynomial in \\(x\\) of degree \\(n\\) with \\(|x| \\le 1\\).\nThe first Legendre polynomials are\n\n\n\n\\(n\\)\n\\(P_n(x)\\)\n\n\n\n\n\\(0\\)\n\\(1\\)\n\n\n\\(1\\)\n\\(x\\)\n\n\n\\(2\\)\n\\(\\dfrac{1}{2}(3x^2 -1)\\)\n\n\n\nLegendre polynomials can be calculated using Rodrigues’ formula\n\\[\nP_n(x) = \\frac{1}{2^n n!} \\frac{\\mathrm d^n}{\\mathrm dx^n}(x^2 - 1)^n\n\\]\n\n\n\n\n20.1.3 Description of Latitudinal Variations in Potential\nThe superposition of Legendre polynomials can describe the latitude-dependent variations in potential.\nFor \\(r \\ll s\\), a similar result is obtained by factoring out \\(1/s\\) \\[\nf(r, \\theta) =\n\\begin{cases}\n\\dfrac{1}{s} \\sum_{n=0}^\\infty \\left(\\dfrac{r}{s}\\right)^n P_n(\\cos \\theta), & r \\leq s, \\\\\n\\dfrac{1}{r} \\sum_{n=0}^\\infty \\left(\\dfrac{s}{r}\\right)^{n+1} P_n(\\cos \\theta), & r \\geq s.\n\\end{cases}\n\\]\n\n\n20.1.4 Equivalence of Series Expansions\nFor \\(r \\geq s\\), the series satisfy \\[\n\\frac{1}{r} \\sum_{n=0}^\\infty \\left(\\frac{s}{r}\\right)^n P_n(\\cos \\theta) = \\frac{1}{s} \\sum_{n=0}^\\infty \\left(\\frac{s}{r}\\right)^{n+1} P_n(\\cos \\theta).\n\\]\n\n\n20.1.5 Special Case for \\(s = 0\\)\nWhen \\(s = 0\\), only the term for \\(n = 0\\) contributes a non-zero value. Thus \\[\nf(r, \\theta) = \\frac{1}{r}.\n\\]",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Legendre Polynomials</span>"
    ]
  },
  {
    "objectID": "legendre.html#electrostatic-potential",
    "href": "legendre.html#electrostatic-potential",
    "title": "20  Legendre Polynomials",
    "section": "20.2 Electrostatic potential",
    "text": "20.2 Electrostatic potential\nObservation point at \\(\\mathbf{r} = (x, y, z)^\\top\\), \\(r = |\\mathbf{r}|\\).\nSource points \\(\\pm \\mathbf{r}' = (0, 0, \\pm a)^\\top\\).\nTwo charges on the \\(z\\)-axis: \\(+Q\\) at \\(z = a\\) and \\(-Q\\) at \\(z = -a\\).\n\n\n\n\n\n\nFigure 20.2: Electrostatic dipole aligned with the \\(z\\)-axis\n\n\n\nThe distances between the charges and the observation point are obtained using the law of cosines.\n\nDistance to the charge \\(+Q\\): \\[\n| \\mathbf{r} - \\mathbf{r}'| = \\sqrt{r^2 + a^2 - 2ar \\cos \\theta}\n= r \\sqrt{1 - 2 \\frac{a}{r} \\cos \\theta + \\left( \\frac{a}{r} \\right)^2}.\n\\]\nUsing \\(\\cos \\theta = -\\cos(\\pi - \\theta)\\) (complementary angle), the distance to the charge \\(-Q\\) is: \\[\n| \\mathbf{r} + \\mathbf{r}'| = \\sqrt{r^2 + a^2 + 2ar \\cos \\theta}\n= r \\sqrt{1 + 2 \\frac{a}{r} \\cos \\theta + \\left( \\frac{a}{r} \\right)^2}.\n\\]\n\n\n20.2.1 Substitution into the Potential\nSubstituting these distances into the potentials: \\[\nU(r) = \\frac{Q}{4 \\pi \\varepsilon r}\n\\left\\{\n\\left[1 - 2 \\frac{a}{r} \\cos \\theta + \\left( \\frac{a}{r} \\right)^2\n\\right]^{-1/2} -\n\\left[1 + 2 \\frac{a}{r} \\cos \\theta + \\left( \\frac{a}{r} \\right)^2\n\\right]^{-1/2}\n\\right\\}.\n\\]\n\n\n20.2.2 Expansion Using Legendre Polynomials\nWe apply Legendre polynomials, defined as: \\[\nP_n(x) = \\frac{1}{2^n n!} \\frac{\\mathrm{d}^n}{\\mathrm{d}x^n} \\left( x^2 - 1 \\right)^n,\n\\] with \\(t := \\frac{a}{r}\\) and \\(x := \\cos \\theta\\).\nFor \\(tx := -\\frac{a}{r} \\cos \\theta\\), the sign propagates through \\(t^n = \\left(-\\frac{a}{r}\\right)^n = (-1)^n \\left(\\frac{a}{r}\\right)^n\\): \\[\nU(r) = \\frac{Q}{4 \\pi \\varepsilon r}\n\\left[\n\\sum_{n=0}^\\infty P_n(\\cos \\theta) \\left( \\frac{a}{r} \\right)^n -\n\\sum_{n=0}^\\infty P_n(\\cos \\theta) (-1)^n \\left( \\frac{a}{r} \\right)^n\n\\right].\n\\]\n\n\n20.2.3 Simplification\nTerms with even powers cancel because \\((-1)^{2n} = 1\\).\nThus, the potential simplifies to: \\[\nU(r) = \\frac{2Q}{4 \\pi \\varepsilon r}\n\\left[\nP_1(\\cos \\theta) \\left( \\frac{a}{r} \\right) +\nP_3(\\cos \\theta) \\left( \\frac{a}{r} \\right)^3 + \\ldots\n\\right].\n\\]\nFor \\(r \\gg a\\), the term with \\(P_1(\\cos \\theta)\\) dominates.\nThis leads to the electric dipole potential: \\[\nU(r) = \\frac{2aQ}{4 \\pi \\varepsilon}\n\\cdot\n\\frac{P_1(\\cos \\theta)}{r^2}.\n\\]\n\n\n20.2.4 Legendre Polynomial for \\(n = 1\\)\nThe Legendre polynomial of degree \\(n=1\\) is: \\[\nP_1(\\cos \\theta) = \\cos \\theta.\n\\]\nThis corresponds to the equation (with the electric dipole moment \\(p = 2aQ\\)) derived using the electric dipole and the superposition principle.",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Legendre Polynomials</span>"
    ]
  },
  {
    "objectID": "legendre-intro.html",
    "href": "legendre-intro.html",
    "title": "21  Numerical computation of Legendre polynomials",
    "section": "",
    "text": "21.1 Visualization on a sphere\nThe Legendre polynomials were first introduced in 1782 by Adrian-Marie Legendre as the coefficients in the expansion of the Newtonian potential.\nIn this section we demonstrate how the Legendre polynomials can be computed.\nA very handy and especially compact expression for the Legendre polynomials is given by the formula of Rodrigues\n\\[\nP_n(x) = \\frac{1}{2^n n!} \\frac{\\mathrm d^n}{\\mathrm dx^n} (x^2 - 1)^n.\n\\]\nIt is straightforward to compute these polynomials with the help of SymPy.\nWe implement the above equation and later substitute \\(x=:\\cos\\theta\\).\nFirst, we introduce symbolic variables.\nNext, we define a symbolic expression which provides (not evaluates) the formula of Rodrigues. Note that we introduce a symbolic differentiation (up to order n) by using the Derivative function. The differentiation can later be carried out explicitly by calling the method .doit().\nLet’s evaluate the Legendre polynomials \\(P_n(\\cos\\theta)\\) for a small range of order \\(n\\), say \\(0 \\le n \\le 5\\).\nNote: - First, we iterate through a list of orders n (for i in range(0,5):) and substitute the desired value of n with i (subs(n, i)) - Second, with the fixed order of the derivative, we carry out the differentiation by calling doit() - Finally, we substitute x with cos(theta) and expand the expression.\nWe observe that Legendre polynomials are polynomials in \\(\\cos\\theta\\).\nLet’s visualize:\nIn the following we reproduce these results by expanding the inverse distance \\(1/r\\), which is the main feature of, e.g., the potential of a point mass in \\(\\mathbb R^3\\).\nThe gravity potential due to a point mass \\(m\\) located at the point \\(\\mathbf r'\\) observed at the point \\(\\mathbf r\\) is given by\n\\[\nV(\\mathbf r) = -f \\frac{m}{|\\mathbf r - \\mathbf r'|}\n\\]\nNote that the point mass is not in the center of a sphere, but has been moved slightly along the \\(z\\)-axis to the point \\(\\mathbf r' = (0, 0, s)^\\top\\).\nThe term \\(1/|\\mathbf r - \\mathbf r'|\\) can be expanded in a Taylor series when \\(|\\mathbf r'| \\ll |\\mathbf r|\\).\nLet \\(\\mathbf r = (x, y, z)^\\top\\) and \\(\\mathbf r' = (0, 0, s)^\\top\\). The Euclidean distance between the point mass and the point of observation is \\(q = |\\mathbf r - \\mathbf r'|\\). With \\(r = |\\mathbf r|\\) and \\(s = |\\mathbf r'|\\) we can rewrite the term \\(1/q\\) using the Theorem of Cosines as\n\\[\n\\frac{1}{q}=f(r, \\theta)=\\frac{1}{r}\\left[1+\\left(\\frac{s}{r}\\right)^{2}-2 \\frac{s}{r} \\cos \\theta\\right]^{-1 / 2}\n\\]\nWhen \\(s \\ll r\\), we can expand \\(f(r, \\theta)\\) in a binomial series as\n\\[\nf(r, \\theta) = \\frac{1}{r} (1 + b)^{-1/2} = \\frac{1}{r}\\sum\\limits_{n=0}^\\infty \\left( -1/2 \\atop n \\right)b^n\n\\] with \\[\nb = \\left(\\frac{s}{r}\\right)^2 - 2 \\frac{s}{r}\\cos\\theta, \\quad |b| &lt; 1\n\\]\nRearranging after powers of \\(s/r\\) we arrive at\n\\[\nf(r, \\theta) = \\frac{1}{r} \\sum\\limits_{n=0}^\\infty\\left(\\frac{s}{r} \\right)^n P_n(\\cos\\theta)\n\\]\nThe \\(P_n(\\cos\\theta)\\) are polynomials of degree \\(n\\) in \\(\\cos\\theta\\).\nThe polynomial coefficients in the binomial series are binomial coefficients given by \\[\n\\left( -1/2 \\atop n \\right)\n\\] The binomial coefficients for \\(0 \\le n \\le 4\\) are:\nNext, we expand \\[\nf(r, \\theta) = \\frac{1}{r \\sqrt{1 + \\left(\\dfrac{s}{r}\\right)^2 - 2 \\dfrac{s}{r}\\cos\\theta}}\n\\] into a series. To this end, we define a symbolic expression for \\(f\\).\nWe expand in a power series of \\(b\\):\nWe repeat this step, but replace b to obtain the following result:\nThis is a polynomial in \\(\\cos\\theta\\). The coefficients have the form \\(\\dfrac{1}{r}\\left(\\dfrac{s}{r}\\right)^n\\).\nThe following cell forms the expression \\[\n\\sum_{n=0}^\\infty \\left( -1/2 \\atop n \\right) b^n\n\\] (Note that we have omitted the leading term \\(1/r\\)).\nThis is — up to the leading term — the same expression that we have derived above by a series expansion of \\(f(r, \\theta)\\).\nIt can be demonstrated that similar results can be obtained when we form the summation \\[\n\\sum_{n=0}^\\infty \\left( \\frac{s}{r}\\right)^n \\, P_n(\\cos\\theta)\n\\]\n(Note that the number of terms differs when we stop the summation for a finite value of \\(n\\).)\nWe illustrate the Legendre polynomials on the surface of a sphere, i.e., for \\(r=const\\). The potential function is a function of \\(\\theta\\) only. Hence, Legendre polynomials are referred to as zonal spherical harmonics.\nLet’s plot \\(P_4(\\cos\\theta)\\):\nShow the code\ndeg2rad = lambda x: x * np.pi / 180.0\n\nm = 4\nex = Pn.subs(n, m).doit().subs(x, cos(theta))\nlegendreP = lambdify(theta, ex, \"numpy\")\n\nlon = np.linspace(0, 360.0, 180) - 180.0\nlat = np.linspace(-90.0, 90.0, 90)\ncolat = lat + 90.0\nd = np.zeros((len(lon), len(colat)), dtype = np.float64)\nfor j, yy in enumerate(colat):\n    for i in range(len(lon)):\n        d[i, j] = legendreP(deg2rad(yy))\ndrm = np.transpose(d)\nShow the code\nfig = plt.figure(figsize=(3, 3),tight_layout = {'pad': 0})\nplotcrs = ccrs.Orthographic(0, 0)\nax = plt.subplot(projection=plotcrs)\ncf = ax.pcolormesh(lon, lat, drm,\n    transform=ccrs.PlateCarree(),\n    cmap='RdBu_r', vmin=-1, vmax=1)\nplt.colorbar(cf)\nax.relim()\nax.autoscale_view()",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Numerical computation of Legendre polynomials</span>"
    ]
  },
  {
    "objectID": "legendre-intro.html#summary",
    "href": "legendre-intro.html#summary",
    "title": "21  Numerical computation of Legendre polynomials",
    "section": "21.2 Summary",
    "text": "21.2 Summary\nThe Legendre polynomials can be defined as the coefficients in a formal expansion in powers of \\(t\\) of the generating function \\[\n\\frac{1}{\\sqrt{1-2xt+t^2}} = \\sum_{n=0}^\\infty P_n(x) t^n.\n\\] The coefficient of \\(t^n\\) is a polynomial in \\(x\\) of degree \\(n\\) with \\(|x| \\le 1\\).\nIn our approach outlined above, we have set \\[\nt =: \\frac{s}{r}\n\\] and \\[\nx =: \\cos\\theta.\n\\]\nA further definiton of the Legendre polynomials is given in terms of solutions to Legendre’s differential equation \\[\n(1 - t^2) P_n''(x) - 2 x P_n'(x) + n(n+1) P_n(x) = 0.\n\\]",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Numerical computation of Legendre polynomials</span>"
    ]
  },
  {
    "objectID": "laplace-in-sph-coord.html",
    "href": "laplace-in-sph-coord.html",
    "title": "22  Solution of the Laplace equation in spherical coordinates",
    "section": "",
    "text": "22.1 Representations of the Laplace operator\nLet \\(u: \\mathbb R^3 \\mapsto \\mathbb R\\) be a function defined in an open subset \\(\\Omega \\subset \\mathbb R^3\\).\nThen \\(u\\) is a solution to the Laplace equation, if \\[\n\\Delta u = 0\n\\] holds in \\(\\Omega\\).\nWe refer to \\(\\Delta\\) as the Laplace operator.\nIn different coordinate systems, \\(\\Delta\\) has different representations.",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Solution of the Laplace equation in spherical coordinates</span>"
    ]
  },
  {
    "objectID": "laplace-in-sph-coord.html#representations-of-the-laplace-operator",
    "href": "laplace-in-sph-coord.html#representations-of-the-laplace-operator",
    "title": "22  Solution of the Laplace equation in spherical coordinates",
    "section": "",
    "text": "22.1.1 Cartesian coordinates\n\\[\n\\frac{\\partial^2 u}{\\partial x^2}\n+\\frac{\\partial^2 u}{\\partial y^2}\n+\\frac{\\partial^2 u}{\\partial z^2}\n= 0\n\\tag{22.1}\\]\n\n\n22.1.2 Spherical coordinates\n\n\n\n\n\n\nFigure 22.1: Spherical coordinate system\n\n\n\nWe transform from a Cartesian to a spherical system with \\[\n\\begin{align}\nx & = r \\cos \\phi \\sin \\theta \\\\\ny & = r \\sin \\phi \\sin \\theta \\\\\nz & = r \\cos \\theta \\\\\nr^2 & = x^2 + y^2 + z^2\n\\end{align}\n\\]\n\\[\n\\frac{1}{r^2} \\frac{\\partial}{\\partial r}\n  \\left( r^2 \\frac{\\partial u}{\\partial r} \\right)\n+ \\frac{1}{r^2 \\sin \\theta} \\frac{\\partial}{\\partial \\theta}\n  \\left( \\sin \\theta {\\partial u \\over \\partial \\theta} \\right)\n+ \\frac{1}{r^2 \\sin^2 \\theta} \\frac{\\partial^2 u}{\\partial \\varphi^2} = 0\n\\tag{22.2}\\]\n\n\n22.1.3 Cylindrical coordinates\n\\[\n\\frac{1}{\\rho} \\frac{\\partial}{\\partial \\rho}\n  \\left( \\rho \\frac{\\partial u}{\\partial \\rho} \\right)\n+ \\frac{1}{\\rho^2} \\frac{\\partial^2 u}{\\partial \\varphi^2}\n+ \\frac{\\partial^2 u}{\\partial z^2 } = 0\n\\tag{22.3}\\]\n\\(\\rho^2 = x^2 + y^2\\)\n\n\n22.1.4 Polar coordinates\n\\[\n\\frac{1}{\\rho} \\frac{\\partial}{\\partial \\rho}\n  \\left( \\rho \\frac{\\partial u}{\\partial \\rho} \\right)\n+ \\frac{1}{\\rho^2} \\frac{\\partial^2 u}{\\partial \\varphi^2} =0\n\\tag{22.4}\\]\n\\(\\rho^2 = x^2 + y^2\\)",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Solution of the Laplace equation in spherical coordinates</span>"
    ]
  },
  {
    "objectID": "laplace-in-sph-coord.html#the-radial-part-of-the-laplace-equation",
    "href": "laplace-in-sph-coord.html#the-radial-part-of-the-laplace-equation",
    "title": "22  Solution of the Laplace equation in spherical coordinates",
    "section": "22.2 The radial part of the Laplace equation",
    "text": "22.2 The radial part of the Laplace equation\nWe consider the Laplace equation in spherical coordinates as defined in 22.2.\nFor now, we assume that \\(u = u(r)\\) is a function of the radial distance.\nThus, the Laplace equation reduces to an ordinary differential equation\n\\[\n\\frac{\\mathrm d}{\\mathrm d r}\n  \\left( r^2 \\frac{\\mathrm d u}{\\mathrm d r} \\right) =\n  2r \\frac{\\mathrm d u}{\\mathrm d r} + r^2\n  \\frac{\\mathrm d^2 u}{\\mathrm d r^2} = 0.\n\\]\nThis equation is referred to as Euler’s differential equation.\nWe solve this ODE with the ansatz \\[\nu(r) = r^\\alpha, \\quad u'(r) = \\alpha r ^{\\alpha - 1}, \\quad\nu''(r) = (\\alpha-1)\\alpha r^{\\alpha - 2}.\n\\]\nIt follows \\[\n\\begin{align}\n2r \\alpha r^{\\alpha-1} + r^2 (\\alpha-1)\\alpha r^{\\alpha - 2} &= 0 \\\\\n2 \\alpha u + (\\alpha-1)\\alpha u &= 0 \\\\\n\\alpha(\\alpha+1)u &= 0 \\quad\\text{(characteristic equation)}\n\\end{align}\n\\]\nThe characteristic equation has the solution \\[\nu(r) = C_0 r^{-1} + C_1 r^0.\n\\]\nAt this point, we introduce the\n\n\n\n\n\n\nNoteHomogeneous function\n\n\n\nWe call a function homogeneous of degree \\(\\lambda\\), if under a proportional scaling of the variables \\(x\\) by a factor \\(t\\) the function scales with a factor \\(t^\\lambda\\):\n\\[\nf(t \\mathbf x ) = t^\\lambda f(\\mathbf x)\n\\]\nExample:\n\\(f(x,y) = x^2 + y^2\\) is a homogeneous function.\nWe replace \\(x\\) and \\(y\\) by \\(tx\\) and \\(ty\\), factor out powers of \\(t\\), i.e., \\[\nf(tx, ty) = (tx)^2 + (ty)^2 = t^2(x^2 + y^2)\n\\] and recognize that \\(f(x,y)\\) is a homogeneous function of degree \\(2\\).\n\n\nNow we make the following ansatz:\nWe assume that \\(u\\) can be defined as a homogeneous function \\(u_n\\) of degree \\(n\\). This is a valid choice, since homogeneous functions are solutions to Laplace’s equation.\nWe set \\[\n\\begin{align}\nu_n(x,y,z) & = u_n(r \\cos\\phi \\sin\\theta, r \\sin\\phi \\sin\\theta, r \\cos\\theta) \\\\\n& = r^n u_n(\\cos\\phi \\sin\\theta, \\sin\\phi \\sin\\theta,  \\cos\\theta) \\\\\n& = r^n S_n(\\phi, \\theta)\n\\end{align}\n\\]\n\\(u_n = r^n S_n(\\phi, \\theta)\\) is called a solid spherical harmonic.\nFurther, \\[\n\\begin{align}\n2r  \\frac{ \\partial u_{n} }{ \\partial r }\n+ r^2 \\frac{ \\partial^{2} u_{n} }{ \\partial r^{2} }\n   & = 2 r n r^{n-1} S_n\n  + r^2 n(n-1)r^{n-2} S_n \\\\\n  & = 2 n u_n + n(n-1) u_n \\\\\n  & = n(n+1) u_n\n\\end{align}\n\\]\nWe recognize that \\(f(r) = u_n(r)\\) and \\(\\lambda = n(n+1)\\) are eigenfunctions and eigenvalues of the eigenvalue problem\n\\[\n\\Delta f(r) = \\lambda f(r).\n\\]\nWe see that the radial part of the Laplace equation for \\(u_n\\) can be equivalently replaced by \\[\nn (n+1) u_n,\n\\] which we insert back into the full Laplace equation 22.2 to obtain\n\\[\nn(n+1) S_n + \\frac{1}{\\sin \\theta} \\frac{\\partial}{\\partial \\theta}\n  \\left( \\sin \\theta {\\partial S_n \\over \\partial \\theta} \\right)\n+ \\frac{1}{\\sin^2 \\theta} \\frac{\\partial^2 S_n}{\\partial \\varphi^2} = 0.\n\\]\nNote that the equation has no dependence on \\(r\\).",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Solution of the Laplace equation in spherical coordinates</span>"
    ]
  },
  {
    "objectID": "laplace-in-sph-coord.html#zonal-spherical-harmonics",
    "href": "laplace-in-sph-coord.html#zonal-spherical-harmonics",
    "title": "22  Solution of the Laplace equation in spherical coordinates",
    "section": "22.3 Zonal spherical harmonics",
    "text": "22.3 Zonal spherical harmonics\nNow we seek solutions \\(S_n(\\theta)\\). These functions are referred to as zonal spherical harmonics. On a surface of a sphere they only vary with the polar angle \\(\\theta\\). Their zeros are parallel to the equator of the sphere.\nThe Laplace equation 22.2 reduces to \\[\n\\frac{1}{\\sin \\theta} \\frac{\\mathrm d}{\\mathrm d \\theta}\n  \\left( \\sin \\theta {\\mathrm d S_n \\over \\mathrm d \\theta} \\right)\n+ n(n+1) S_n = 0\n\\]\nWe substitute \\(\\cos\\theta\\) and set \\(S_n(\\theta)=P_n(t)\\):\n\\[\n\\begin{align}\nt & = \\cos\\theta \\\\\n\\mathrm{d}t & = -\\sin \\theta \\,\\mathrm{d}\\theta \\\\\nS_n(\\theta) & = P_n(\\cos\\theta) = P_n(t)\n\\end{align}\n\\] With the chain rule we obtain \\[\n\\begin{align}\n\\frac{\\mathrm d P_n(t)}{\\mathrm d \\theta} & = \\frac{\\mathrm d P_n(t)}{\\mathrm d t} \\frac{\\mathrm d t}{\\mathrm d \\theta} \\\\\n& = -\\frac{\\mathrm d P_n(t)}{\\mathrm d t} \\sin\\theta \\\\\n\\sin^2\\theta & = 1 - t^2\n\\end{align}\n\\]\nUseful steps: \\[\n\\frac{1}{\\sin \\theta} \\frac{\\mathrm{d}}{\\mathrm{d}\\theta} =  \n\\frac{1}{\\sin \\theta} \\left( -\\frac{\\sin \\theta}{\\mathrm{d}t} \\right) = -\\frac{\\mathrm{d}}{\\mathrm{d}t}\n\\]\n\\[\n\\sin \\theta \\frac{\\mathrm{d}}{\\mathrm{d}\\theta} =\n\\sin \\theta \\left( -\\sin \\theta \\frac{\\mathrm{d}}{\\mathrm{d}t}  \\right) = -\\sin ^{2}\\theta \\frac{\\mathrm{d}}{\\mathrm{d}t}\n\\]\nFinally, we end at the Legendre differential equation\n\\[\n\\frac{\\mathrm d}{\\mathrm d t}\n\\left[\n(1-t^2) \\frac{\\mathrm d P_n(t)}{\\mathrm d t}\n\\right] + n(n+1) P_n(t) = 0\n\\]\nThe functions \\(P_n(t) = P_n(\\cos\\theta)\\) are the Legendre polynomials.\nWhen a pure dependency of \\(\\theta\\) is assumed, then \\[\nr^{n} S_{n}(\\theta) = r^{n} P_{n}(\\cos \\theta)\n\\] and \\[\nr^{-(n+1)}S_n = r^{-(n+1)}P_{n}(\\cos \\theta)\n\\] are solid spherical harmonics. Note that we have arrived at these two equations by replacing \\(n\\) with \\(-(n+1)\\).",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Solution of the Laplace equation in spherical coordinates</span>"
    ]
  },
  {
    "objectID": "laplace-in-sph-coord.html#the-angular-component-of-the-laplace-equation",
    "href": "laplace-in-sph-coord.html#the-angular-component-of-the-laplace-equation",
    "title": "22  Solution of the Laplace equation in spherical coordinates",
    "section": "22.4 The angular component of the Laplace equation",
    "text": "22.4 The angular component of the Laplace equation\nPreviously, we have encountered zonal spherical harmonics or Legendre polynomials as solutions to the Laplace equation.\nFormally, the zonal spherical harmonics \\(S_n(\\theta) = P_n(\\cos\\theta)\\) correspond to the Legendre polynomials.\nTo arrive at \\(S_n(\\theta, \\phi)\\), we use a separation of variables approach of the form:\n\\[S_n(\\theta, \\phi) = \\Theta(\\theta)\\Phi(\\phi)\\]\nand write:\n\\[\n\\underbrace{ n(n+1)\\Theta\\Phi + \\frac{\\Phi}{\\sin\\theta}\\frac{\\mathrm d}{\\mathrm d \\theta}\\left(\\sin\\theta \\frac{\\mathrm d \\Theta}{\\mathrm d \\theta}\\right) }_{ =m^{2} } +\n\\underbrace{ \\frac{\\Theta}{\\sin^2\\theta}\\frac{\\mathrm d^2 \\Phi}{\\mathrm d \\phi^2} }_{ =-m^{2} }\n=0\n\\]\nor, after multiplying by \\(\\dfrac{\\sin^{2}\\theta}{\\Theta \\Phi}\\):\n\\[\nn(n+1) \\sin^2\\theta + \\frac{\\sin\\theta}{\\Theta} \\frac{\\mathrm d}{\\mathrm d \\theta}\n\\left(\\sin\\theta \\frac{\\mathrm d \\Theta}{\\mathrm d \\theta}\\right) = m^2\n\\]\n\\[\\frac{1}{\\Phi} \\frac{\\mathrm d^2 \\Phi}{\\mathrm d \\phi^2} = -m^2\\]\nSolutions can be provided for both equations.\nFirst, we consider:\n\\[\\Phi''+m^2 \\Phi = 0\\]\nThis is a harmonic differential equation with the solution:\n\\[\n\\Phi(\\phi) = A_m \\cos m \\phi + B_m \\sin m \\phi\n\\]\nThe other equation is:\n\\[\\dfrac{1}{\\sin\\theta}\\frac{\\mathrm d}{\\mathrm d \\theta}\n\\left(\\sin\\theta \\frac{\\mathrm d \\Theta}{\\mathrm d \\theta}\\right) +\n\\left[\nn(n+1) - \\frac{m^2}{\\sin^2\\theta}\n\\right]\\Theta = 0\\]\nWe seek the solution \\(\\Theta(\\theta)\\), substitute \\(t = \\cos\\theta\\), \\(\\mathrm d t = -\\sin\\theta \\mathrm d\\theta\\), and assume \\(\\Theta(\\theta) = P_n^m(\\cos\\theta) = P_n^m(t)\\). Thus:\n\\[\\frac{\\mathrm d}{\\mathrm d t}\n\\left[\n(1-t^2) \\frac{\\mathrm d P_n^m(t)}{\\mathrm d t}\n\\right] +\n\\left[\nn(n+1) - \\frac{m^2}{1-t^2}\n\\right] P_n^m(t) = 0\\]\nThe desired \\(P_n^m(t)\\) are associated Legendre functions of order \\(m\\) and degree \\(n\\).\nThe associated Legendre functions can be most easily defined through the derivatives of the Legendre polynomials with \\(0 \\le m \\le n\\):\n\\[\n\\begin{align}\nP_n^m(t) & = (1 - t^2)^{\\frac{m}{2}} \\frac{\\mathrm d^m}{\\mathrm dt^m}P_n(t)  \\\\\nP_n^m(\\cos \\theta)  & = \\sin ^{m}\\theta P_n^{(m)}(\\cos \\theta)\n\\end{align}\n\\]\nwhere \\(P_{n}^{(m)}\\) is the \\(m\\)-th derivative of \\(P_{n}\\) with respect to \\(\\cos \\theta\\).\n\n22.4.1 Properties\nOrthogonality:\n\\[\n\\int\\limits_{-1}^{+1} P_n^m(t) P_{n'}^m(t) \\, \\dd t =\n\\begin{cases}\n0 & n \\ne n' \\\\\n\\frac{2 (n+m)!}{(2n+1)(n-m)!} & n = n'\n\\end{cases}\n\\]\nSymmetry: Follows from properties of Legendre polynomials \\(P_n\\), i.e., from \\(P_n(-t) = (-1)^n P_n(t)\\) we obtain\n\\[\nP_n^m(-t) = (-1)^{n+m} P_n^m(t)\n\\]\nFor \\(m=0\\), the associated Legendre functions are Legendre polynomials, i.e.,\n\\[\nP_n^m(t) = P_n(t) \\text{ for } m=0.\n\\]\nWhen \\(m&gt;0\\), the order represents the index \\(m\\) of the associated azimuthal Fourier coefficient in \\(\\sin m \\varphi\\) and \\(\\cos m \\varphi\\).\nThe magnitude of the \\(P_n^m\\) strongly varies with \\(m\\), e.g.,\n\\[\n\\frac{P_4^1}{P_4^4} = \\frac{1}{2016}.\n\\]",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Solution of the Laplace equation in spherical coordinates</span>"
    ]
  },
  {
    "objectID": "laplace-in-sph-coord.html#schmidt-semi-normalized-legendre-functions",
    "href": "laplace-in-sph-coord.html#schmidt-semi-normalized-legendre-functions",
    "title": "22  Solution of the Laplace equation in spherical coordinates",
    "section": "22.5 Schmidt semi-normalized Legendre functions",
    "text": "22.5 Schmidt semi-normalized Legendre functions\nTo better reflect the relative weight of the spherical harmonic coefficients, A. Schmidt has introduced a normalization, such that\n\\[\nY_n^m(t) =\n\\begin{cases}\nP_n^m(t) & m = 0 \\\\\n\\sqrt{2 \\frac{(n-m)!}{(n+m)!}} P_n^m(t) & m&gt;0.\n\\end{cases}\n\\]",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Solution of the Laplace equation in spherical coordinates</span>"
    ]
  },
  {
    "objectID": "laplace-in-sph-coord.html#summary",
    "href": "laplace-in-sph-coord.html#summary",
    "title": "22  Solution of the Laplace equation in spherical coordinates",
    "section": "22.6 Summary",
    "text": "22.6 Summary\nThe variations in latitude can be described by associated Legendre functions, while longitudinal variations can be represented by a Fourier series.\nWe can therefore write\n\\[\nf(\\theta, \\varphi) = \\sum\\limits_{n=0}^\\infty \\sum\\limits_{m=0}^n \\underbrace{(g_n^m \\cos m \\varphi + h_n^m \\sin m \\varphi)}_{\\text{Fourier series in longitude}} \\underbrace{P_n^m(\\cos\\theta)}_{\\text{assoc. LF in latitude}}\n\\]",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Solution of the Laplace equation in spherical coordinates</span>"
    ]
  },
  {
    "objectID": "igrf.html",
    "href": "igrf.html",
    "title": "23  Mathematical description of the Earth’s global magnetic field",
    "section": "",
    "text": "23.1 The geomagnetic components\nThe goal of this section is to describe the main geomagnetic field \\(\\vb B(r, \\theta, \\varphi, t)\\) produced primarily by internal sources inside Earth’s core.\nThe description in terms of a potential is valid on and above Earth’s surface, where the main magnetic field can be represented by the gradient of a scalar function, i.e., \\(\\vb B = -\\grad V\\).\nThe potential function \\(V(r, \\theta, \\varphi, t)\\) is represented as a finite series expansion in terms of spherical harmonic coefficients, \\(g_n^m\\) and \\(h_n^m\\), also known as Gauss coefficients:\n\\[\nV(r, \\theta, \\varphi, t) = a \\sum\\limits_{n=1}^N \\sum\\limits_{m=0}^n \\left( \\frac{a}{r} \\right)^{n+1}\n\\left[\ng_n^m(t) \\cos m \\varphi + h_n^m(t) \\sin m \\varphi\n\\right]\nP_n^m(\\cos\\theta).\n\\tag{23.1}\\]\nHere, \\(r, \\theta\\) and \\(\\varphi\\) refer to coordinates in a geocentric spherical coordinate system with \\(r\\) being the radial distance from the center of the Earth, and \\(\\theta, \\varphi\\) being geocentric co-latitude and longitude, resp.\nAs reference radius, the approximate mean radius of the Earth of \\(a=6371.2\\) km is chosen. The factor \\(a^{n+2}\\) is chosen so that the Gauss coefficients will have units of magnetic flux density.\nThe \\(P_n^m(\\cos\\theta)\\) are Schmidt semi-normalized associated Legendre functions of degree \\(n\\) and order \\(m\\).\nThe parameter \\(N\\) specifies the maximum spherical harmonic degree of expansion.\nThe Gauss coefficients change in time.\nThe magnetic field on or above the Earth is usually described in terms of its Cartesian components \\(X, Y\\) and \\(Z\\).\nThe coordinate system is oriented such that \\(X\\) is pointing towards true magnetic North, \\(Y\\) is pointing eastwards, \\(Z\\) is pointing downwards.\nThe projection of the magnetic field line onto the horizontal plane tangential to the Earth’s surface is called \\(H\\). The angle between \\(H\\) and true North is referred to as magnetic declination.\nThe geomagnetic field of internal origin is\n\\[\n\\vb B(r, \\theta, \\varphi) = -\\pdv{V}{r}\\vb e_r - \\frac{1}{r}\\pdv{V}{\\theta}\\vb e_\\theta\n-\\frac{1}{r \\sin\\theta} \\pdv{V}{\\varphi}\\vb e_\\varphi,\n\\]\nin which \\(\\vb e_r\\), \\(\\vb e_\\theta\\), \\(\\vb e_\\varphi\\) are unit vectors in spherical coordinates.\nThe following table shows the relation between the field components in Cartesian and spherical coordinates:\nFor the components in spherical coordinates we find\n\\[\nB_r = -Z = -\\frac{\\partial V}{\\partial r} =+\\sum_{n=1}^{\\infty} \\sum_{m=0}^{n}(n+1)\n\\left(\n\\frac{a}{r}\\right)^{n+2}\n\\left[g_{n}^{m} \\cos m \\varphi+h_{n}^{m} \\sin m \\varphi\\right] P_{n}^{m}(\\cos \\theta)\n\\]\n\\[\nB_\\theta = -X = -\\frac{1}{r}\\dfrac{\\partial V}{\\partial \\theta} = -\\sum_{n=1}^{\\infty} \\sum_{m=0}^{n}\\left( \\frac{a}{r} \\right)^{n+2} \\left[g_{n}^{m} \\cos m \\varphi+h_{n}^{m} \\sin m \\varphi\\right] \\frac{\\partial P_{n}^{m}(\\cos \\theta)}{\\partial \\theta}\n\\]\n\\[\nB_\\varphi = +Y =  -\\frac{1}{r \\sin\\theta}\\dfrac{\\partial V}{\\partial \\varphi}\n=-\\sum_{n=1}^{\\infty} \\sum_{m=0}^{n}\\left( \\frac{a}{r} \\right)^{n+2}\\left[-g_{n}^{m} \\sin m \\varphi+h_{n}^{m} \\cos m \\varphi\\right] \\frac{1}{\\sin \\theta} P_{n}^{m}(\\cos \\theta)\n\\]",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Mathematical description of the Earth's global magnetic field</span>"
    ]
  },
  {
    "objectID": "igrf.html#the-geomagnetic-components",
    "href": "igrf.html#the-geomagnetic-components",
    "title": "23  Mathematical description of the Earth’s global magnetic field",
    "section": "",
    "text": "\\(\\mathbf B(x,y,z)=\\)\n\\(\\mathbf B(r, \\varphi, \\theta)=\\)\n\\(-\\nabla V=\\)\n\n\n\n\n\\(X \\mathbf e_x\\)\n\\(-B_\\theta \\mathbf e_\\theta\\)\n\\(+\\dfrac{1}{r}\\dfrac{\\partial V}{\\partial \\theta}\\mathbf e_\\theta\\)\n\n\n\\(Y \\mathbf e_y\\)\n\\(+B_\\varphi \\mathbf e_\\varphi\\)\n\\(-\\dfrac{1}{r \\sin\\theta}\\dfrac{\\partial V}{\\partial \\varphi}\\mathbf e_\\varphi\\)\n\n\n\\(Z \\mathbf e_z\\)\n\\(-B_r \\mathbf e_r\\)\n\\(+\\dfrac{\\partial V}{\\partial r}\\mathbf e_r\\)",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Mathematical description of the Earth's global magnetic field</span>"
    ]
  },
  {
    "objectID": "igrf.html#the-international-geomagnetic-reference-field-igrf",
    "href": "igrf.html#the-international-geomagnetic-reference-field-igrf",
    "title": "23  Mathematical description of the Earth’s global magnetic field",
    "section": "23.2 The International Geomagnetic Reference Field (IGRF)",
    "text": "23.2 The International Geomagnetic Reference Field (IGRF)\nLink to the Gauss coefficients and general information about the 14th generation of the IGRF is here.\nThe IGRF provides Gauss coefficients \\(g_n^m, h_n^m\\) and their respective time derivatives \\(\\dot{g}_n^m, \\dot{h}_n^m\\) (in units of nT and nT/year, resp.) for a truncated spherical harmonic expansion up to degree \\(N=13\\). The IGRF is valid for a 5-year interval referred to as epoch.\nThe Gauss coefficients have a linear time dependency valid for one epoch. In the case of IGRF-14, the epoch starts with Jan 1st, 2025, and ends Jan 1st, 2030. Starting from \\(T_0=2025\\), we can extrapolate\n\\[\ng_n^m(t) = g_n^m(T_0) + \\dot{g}_n^m(T_0)(t - T_0)\n\\] and \\[\nh_n^m(t) = h_n^m(T_0) + \\dot{h}_n^m(T_0)(t - T_0).\n\\]",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Mathematical description of the Earth's global magnetic field</span>"
    ]
  },
  {
    "objectID": "igrf.html#the-dipole-field",
    "href": "igrf.html#the-dipole-field",
    "title": "23  Mathematical description of the Earth’s global magnetic field",
    "section": "23.3 The dipole field",
    "text": "23.3 The dipole field\nThe first three Gauss coefficients \\(g_1^0, g_1^1, h_1^1\\) can be used to calculate the contribution to the dipole field of the Earth.\nFrom the IGRF-14, we get\n\n\n\ng/h\nn\nm\ncoeff. in nT\n\n\n\n\ng\n1\n0\n-29350.0\n\n\ng\n1\n1\n-1410.3\n\n\nh\n1\n1\n4545.5\n\n\n\nWe see from 23.1, that for \\(n=1\\) we can write the dipole potential as\n\\[\nV^D(r, \\theta, \\varphi) = \\frac{a^3}{r^2} \\left[\n    g_1^0 P_1^0(\\cos\\theta) + (g_1^1 \\cos\\varphi + h_1^1 \\sin\\varphi)P_1^1(\\cos\\theta)\n\\right].\n\\]\nNote that\n\\[\nP_1^0(\\cos\\theta) = \\cos\\theta, \\quad P_1^1(\\cos\\theta) = \\sin\\theta,\n\\]\nwhich yields\n\\[\nV_D = \\frac{a^3}{r^2} \\left[\n    g_1^0 \\cos\\theta + g_1^1 \\cos\\varphi \\sin\\theta + h_1^1 \\sin\\varphi \\sin\\theta\n    \\right].\n\\]\nChange from spherical to Cartesian coordinates gives\n\\[\nV^D = \\frac{a^3}{r^2} \\left[  g_1^0 \\frac{z}{r} + g_1^1 \\frac{x}{r} + h_1^1 \\frac{y}{r}\n\\right].\n\\]\nWe compare this result with the well-known potential for a magnetic dipole with dipole moment \\(\\vb m = [m_x, m_y, m_z]^\\top\\):\n\\[\n\\begin{align}\nV & = \\frac{\\mu_0}{4 \\pi} \\frac{\\vb m \\cdot \\vb e_r}{r^2} \\\\\n& = \\frac{\\mu_0}{4 \\pi} \\left[  m_x \\frac{x}{r} + m_y \\frac{y}{r} + m_z \\frac{z}{r} \\right]\n\\end{align}\n\\]\nWe identify, e.g., that\n\\[\n\\frac{a^3}{r^2}g_1^0 = \\frac{\\mu_0}{4 \\pi} m_z,\n\\]\nwhich enables us to calculate the magnetic dipole moment of the Earth in units of A\\(\\cdot\\)m\\(^2\\) component-wise:\n\\[\n\\begin{align}\nm_x & = \\frac{4 \\pi}{\\mu_0} a^3 g_1^1 =  -0.37 \\times 10^{22} \\\\\nm_x & = \\frac{4 \\pi}{\\mu_0} a^3 g_1^1 = 1.18 \\times 10^{22} \\\\\nm_x & = \\frac{4 \\pi}{\\mu_0} a^3 g_1^1 = -7.59 \\times 10^{22}\n\\end{align}\n\\]\nThe magnititude of the dipole moment is \\(m = 7.69 \\times 10^{22}\\) A\\(\\cdot\\)m\\(^2\\).\nFrom the components of the dipole moment we can infer the axis of the dipole in terms of the angles of orientation.\nWe get\n\\[\n\\theta_S = \\arccos\\frac{m_z}{m} = 170.7\\textdegree\n\\] and \\[\n\\varphi_S = \\arccos\\frac{m_x}{\\sqrt{m_x^2 + m_y^2}} = 107.4\\textdegree.\n\\]\nThis refers to the point where the dipole axis intersects the surface of the Earth ain the southern hemisphere. In the northern hemisphere, we have\n\\[\n\\theta_N = 9.3\\textdegree \\text{ and } \\varphi_N = 72.6\\textdegree.\n\\]\nWe refer to these points as the geomagnetic pole.\nThe magnetic poles are located at the points where the observed magnetic field is purely vertical with respect to the surface of the Earth, i.e., where we observe \\(H=0\\) and an inclination angle of 90\\(\\textdegree\\).",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Mathematical description of the Earth's global magnetic field</span>"
    ]
  },
  {
    "objectID": "igrf.html#estimation-of-the-gauss-coefficients",
    "href": "igrf.html#estimation-of-the-gauss-coefficients",
    "title": "23  Mathematical description of the Earth’s global magnetic field",
    "section": "23.4 Estimation of the Gauss coefficients",
    "text": "23.4 Estimation of the Gauss coefficients\nIn the spherical harmonics expansion 23.1, the Gauss coefficients appear as linear coefficients.\nGiven suffiently many observations of the field components, the coefficients can be estimated using the Method of Least Squares.",
    "crumbs": [
      "Spherical harmonics",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Mathematical description of the Earth's global magnetic field</span>"
    ]
  },
  {
    "objectID": "bvp-intro.html",
    "href": "bvp-intro.html",
    "title": "24  Introduction",
    "section": "",
    "text": "24.1 Classification of Boundary Value Problems (BVP)\nIn the previous chapters we have studied solutions to the Poisson and Laplace equations for simple geometries with homogeneous density distributions.\nThe following chapters introduce techniques which will enable us to calculate potentials and their gradients in a subdomain \\(\\Omega\\) that does not contain the sources.\nThe ultimate goal is to find a solution of the Poisson (or similar) PDE.\nThe Poisson equation\n\\[\n\\Delta U(\\vb r) = f(\\vb r)\n\\]\nwith \\(\\vb r \\in \\Omega \\subset \\mathbb R^3\\) has no unique solution, if no further conditions on \\(U(\\vb r)\\) are enforced.\nIn potential theory we will study the following boundary value problems:\nFor the solution of these problems, we will use the following tools:",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "bvp-intro.html#classification-of-boundary-value-problems-bvp",
    "href": "bvp-intro.html#classification-of-boundary-value-problems-bvp",
    "title": "24  Introduction",
    "section": "",
    "text": "Dirichlet problem\nNeumann problem\nRobin or Mixed Dirichlet-Neumann problem\n\n\n\n\n\n\n\nNoteTypical problems\n\n\n\n\nPoint source within a conducting half-space\nPoint source embedded in one of two adjacent conducting half-spaces\nPoint source in the top layer of a 2-layer case\nPotential of a conductive semi-sphere embedded in a homogeneous half-space\nHorizontal cylinder in a homogeneous electrical field\nDC resistivity sounding over a half-space consisting of \\(N\\) horizontal layers\n\n\n\n\n\nGreen’s function\nMethod of images\nFinite Element Method",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "bvp-intro.html#notation",
    "href": "bvp-intro.html#notation",
    "title": "24  Introduction",
    "section": "24.2 Notation",
    "text": "24.2 Notation\nDomain: \\(\\Omega\\)\nBoundary: \\(\\partial\\Omega\\)\n\nWe distinguish between the open domain \\(\\Omega\\) and its boundary \\(\\partial\\Omega\\).\nThe closed domain \\(\\overline\\Omega\\) is the union of the interior and the boundary.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "bvp-dirichlet.html",
    "href": "bvp-dirichlet.html",
    "title": "25  Dirichlet problems",
    "section": "",
    "text": "25.1 Objective\nThe Dirichlet problem in mathematics is a classic boundary value problem that seeks to find a function which solves a partial differential equation (PDE) within a domain, subject to specific boundary conditions. In the context of the Poisson equation, the Dirichlet problem can be stated as follows:\nThe Poisson equation is given by\n\\[\n\\Delta u(\\vb r) = f(\\vb r) \\text{ in } \\Omega,\n\\]\nwhere \\(\\Omega\\) is an open, bounded domain in \\(\\mathbb R^3\\) with sufficiently smooth boundary \\(\\partial\\Omega\\).\nThe Dirichlet problem specifies the value of \\(u\\) on the boundary of the domain\n\\[\nu = g \\text{ on } \\partial\\Omega\n\\]\nwhere \\(g\\) is a given continuous function defined on the boundary \\(\\partial\\Omega\\).\nThe goal is to find a function \\(u\\) such that",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Dirichlet problems</span>"
    ]
  },
  {
    "objectID": "bvp-dirichlet.html#objective",
    "href": "bvp-dirichlet.html#objective",
    "title": "25  Dirichlet problems",
    "section": "",
    "text": "\\(u\\) satisfies the Poisson equation \\(\\Delta u = f\\) in the domain \\(\\Omega\\)\n\\(u\\) matches the given boudary values, \\(u = g\\), on \\(\\partial\\Omega\\).",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Dirichlet problems</span>"
    ]
  },
  {
    "objectID": "bvp-dirichlet.html#formal-definition",
    "href": "bvp-dirichlet.html#formal-definition",
    "title": "25  Dirichlet problems",
    "section": "25.2 Formal definition",
    "text": "25.2 Formal definition\nFind a function \\(u: \\overline{\\Omega} \\mapsto \\mathbb R\\) such that \\[\n\\begin{align}\n\\Delta u & = f \\text{ in } \\Omega \\\\\nu & = g \\text{ on } \\partial\\Omega\n\\end{align}\n\\]",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Dirichlet problems</span>"
    ]
  },
  {
    "objectID": "bvp-dirichlet.html#existence-and-uniqueness",
    "href": "bvp-dirichlet.html#existence-and-uniqueness",
    "title": "25  Dirichlet problems",
    "section": "25.3 Existence and uniqueness",
    "text": "25.3 Existence and uniqueness\nUnder appropriate conditions, such as:\n\n\\(\\Omega\\) being a bounded domain with a sufficiently regular (e.g., Lipschitz continuous) boundary,\n\\(f \\in L^2(\\Omega)\\) or another appropriate function space,\n\\(g\\) being a continuous function on \\(\\partial\\Omega\\),\n\nthere exists a unique solution \\(u\\) to the Dirichlet problem for the Poisson equation, often obtained using variational methods, Green’s functions, or numerical approximations like finite element methods.\nThe Dirichlet problem is fundamental in physics, as it models phenomena such as heat conduction, electromagnetics, and potential flows where boundary conditions dictate the behavior of the solution within the domain.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Dirichlet problems</span>"
    ]
  },
  {
    "objectID": "bvp-neumann.html",
    "href": "bvp-neumann.html",
    "title": "26  Neumann problems",
    "section": "",
    "text": "26.1 Objective\nThe Neumann problem is another classic boundary value problem for partial differential equations, particularly for the Poisson equation. Instead of prescribing the value of the function on the boundary (as in the Dirichlet problem), the Neumann problem specifies the value of the derivative (or normal derivative) of the function on the boundary.\nThe Neumann problem specifies the value of the normal derivative of \\(u\\) on the boundary:\n\\[\n\\pdv{u}{n} = h \\text{ on } \\partial\\Omega\n\\]\nwhere\nThe goal is to find a function \\(u\\) such that",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Neumann problems</span>"
    ]
  },
  {
    "objectID": "bvp-neumann.html#objective",
    "href": "bvp-neumann.html#objective",
    "title": "26  Neumann problems",
    "section": "",
    "text": "\\(u\\) satisfies the Poisson equation \\(\\Delta u = f\\) in the domain \\(\\Omega\\),\nthe normal derivative \\(\\pdv{u}{n}\\) matches the given boundary values \\(h\\) on \\(\\partial\\Omega\\).",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Neumann problems</span>"
    ]
  },
  {
    "objectID": "bvp-neumann.html#formal-definition",
    "href": "bvp-neumann.html#formal-definition",
    "title": "26  Neumann problems",
    "section": "26.2 Formal definition",
    "text": "26.2 Formal definition\nFind a function \\(u: \\overline{\\Omega} \\mapsto \\mathbb R\\) such that \\[\n\\begin{align}\n\\Delta u & = f \\text{ in } \\Omega \\\\\n\\pdv{u}{n} & = h \\text{ on } \\partial\\Omega\n\\end{align}\n\\]\nThe Neumann problem is commonly encountered in physics, particularly in scenarios involving conservation laws, such as heat flux or electric currents, where the flux across the boundary is specified.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Neumann problems</span>"
    ]
  },
  {
    "objectID": "bvp-robin.html",
    "href": "bvp-robin.html",
    "title": "27  Robin problems",
    "section": "",
    "text": "27.1 Objective\nThe Robin problem is a boundary value problem for partial differential equations, where the boundary condition is a combination of the function value and its normal derivative. It is a generalization of both the Dirichlet and Neumann problems.\nThe Robin boundary condition combines the function value \\(u\\) and its normal derivative \\(\\pdv{u}{n}\\) on the boundary:\n\\[\n\\alpha u + \\beta \\pdv{u}{n} = w \\text{ on } \\partial\\Omega,\n\\]\nwhere\nThe goal is to find a function \\(u\\) such that",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Robin problems</span>"
    ]
  },
  {
    "objectID": "bvp-robin.html#objective",
    "href": "bvp-robin.html#objective",
    "title": "27  Robin problems",
    "section": "",
    "text": "\\(u\\) satisfies the Poisson equation \\(\\Delta u = f\\) in the domain \\(\\Omega\\),\n\\(u\\) satisfies the Robin boundary condition \\(\\alpha u + \\beta \\pdv{u}{n} = w\\) on \\(\\partial\\Omega\\).",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Robin problems</span>"
    ]
  },
  {
    "objectID": "bvp-robin.html#formal-definition",
    "href": "bvp-robin.html#formal-definition",
    "title": "27  Robin problems",
    "section": "27.2 Formal definition",
    "text": "27.2 Formal definition\nFind a function \\(u: \\overline{\\Omega} \\mapsto \\mathbb R\\) such that \\[\n\\begin{align}\n\\Delta u & = f \\text{ in } \\Omega \\\\\n\\alpha u + \\beta \\pdv{u}{n} & = w \\text{ on } \\partial\\Omega\n\\end{align}\n\\]",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Robin problems</span>"
    ]
  },
  {
    "objectID": "bvp-robin.html#special-cases",
    "href": "bvp-robin.html#special-cases",
    "title": "27  Robin problems",
    "section": "27.3 Special cases",
    "text": "27.3 Special cases\n\nIf \\(\\beta=0\\), the Robin condition reduces to the Dirichlet boundary condition \\(u = w/\\alpha\\),\nIf \\(\\alpha=0\\), the Robin condition reduces to the Neumann boundary condition \\(\\pdv{u}{n} = w/\\beta\\),",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Robin problems</span>"
    ]
  },
  {
    "objectID": "bvp-robin.html#applications",
    "href": "bvp-robin.html#applications",
    "title": "27  Robin problems",
    "section": "27.4 Applications",
    "text": "27.4 Applications\nThe Robin problem is used in various physical contexts, such as:\n\nHeat transfer, where the boundary condition represents a combination of conduction and convection,\nDC resistivity problems, where Robin conditions model the behaviour of the problem at the boundary.\n\nThe Robin problem provides a more flexible model that can interpolate between purely Dirichlet or Neumann conditions and model more complex boundary interactions.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Robin problems</span>"
    ]
  },
  {
    "objectID": "bvp-uniqueness.html",
    "href": "bvp-uniqueness.html",
    "title": "28  The uniqueness theorem",
    "section": "",
    "text": "28.1 Proof\nThe uniqueness theorem for Poisson’s equation states that, for a large class of boundary conditions, the equation may have many solutions, but the gradient of every solution is the same. In the case of electrostatics, this means that there is a unique electric field derived from a potential function satisfying Poisson’s equation under the boundary conditions.\nConsider the general case of Poisson’s equation in electrostatics over some region \\(\\Omega\\) with boundary \\(\\partial\\Omega\\):\n\\[\n-\\Delta \\varphi = \\frac{\\rho_E}{\\varepsilon_0}\n\\]\nSuppose that there are two solutions, \\(\\varphi_1\\) and \\(\\varphi_2\\). Then\n\\[\n\\begin{align}\n-\\Delta \\varphi_1 = \\frac{\\rho_E}{\\varepsilon_0} \\\\\n-\\Delta \\varphi_2 = \\frac{\\rho_E}{\\varepsilon_0}\n\\end{align}\n\\]\nIt follows that \\(\\varphi = \\varphi_2 - \\varphi_1\\) is a solution of the Laplace equation.\nSubtracting these equations gives\n\\[\n\\Delta \\varphi = \\Delta \\varphi_1 - \\Delta \\varphi_2 = 0.\n\\]\nWe know that\n\\[\n\\div (\\varphi \\grad \\varphi) = \\grad\\varphi\\cdot\\grad\\varphi + \\varphi \\Delta \\varphi.\n\\]\nSince \\(\\Delta\\varphi=0\\), we find that\n\\[\n\\div (\\varphi \\grad \\varphi) = \\grad\\varphi\\cdot\\grad\\varphi\n\\]\nIntegrate over \\(\\Omega\\): \\[\n\\int_\\Omega\n\\div (\\varphi \\grad \\varphi) \\,\\dd V = \\int_\\Omega (\\grad\\varphi)^2\\,\\dd V\n\\]\nWe rewrite using the divergence theorem as\n\\[\n\\int_{\\partial\\Omega}\n(\\varphi \\grad \\varphi) \\cdot \\dd {\\vb S} = \\int_\\Omega \\grad\\varphi\\cdot\\grad\\varphi\\,\\dd V\n\\tag{28.1}\\]\nWe now consider the boundary conditions.\nFirst, consider a Dirichlet boundary condition as \\(\\varphi=0\\) on the boundary of the region.\nSince this condition is satisfied on the boundary, i.e., on \\(\\partial\\Omega\\), the left-hand is zero.\nWe find that\n\\[\n\\int_\\Omega (\\grad\\varphi)^2\\,\\dd V =\n\\int_\\Omega \\grad\\varphi\\cdot\\grad\\varphi\\,\\dd V = 0\n\\]\nIt follows that \\(\\grad\\varphi = 0\\) at all points in \\(\\Omega\\). Further, since the gradient is zero and \\(\\varphi\\) is zero on the boundary, \\(\\varphi\\) must be zero everywhere throughout the region. Therefore, \\(\\varphi_1 = \\varphi_2\\) throughout the whole region. \\(\\square\\)\nSecond, we consider Neumann boundary conditions specified as \\(\\grad\\varphi = 0\\) on \\(\\partial\\Omega\\).\nThe left-hand side of (28.1) is zero. We find that\n\\[\n\\int_\\Omega \\grad\\varphi\\cdot\\grad\\varphi\\,\\dd V = 0\n\\]\nAgain, we must have \\(\\grad\\varphi = 0\\) at all points in \\(\\Omega\\). The gradient of \\(\\varphi\\) is zero within the volume, and because the gradient is zero on the boundary, it follows that \\(\\varphi\\) must be constant throughout the whole region. Therefore, since \\(\\varphi = \\varphi_2 - \\varphi_1 = k\\),\n\\[\n\\varphi_1 = \\varphi_2 - k\n\\]\nThe solution is unique up to an additive constant. \\(\\square\\)",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>28</span>  <span class='chapter-title'>The uniqueness theorem</span>"
    ]
  },
  {
    "objectID": "bvp-uniqueness.html#summary",
    "href": "bvp-uniqueness.html#summary",
    "title": "28  The uniqueness theorem",
    "section": "28.2 Summary",
    "text": "28.2 Summary\nIn all cases, the gradient \\(\\grad\\varphi\\) is unique. This is the only relevant quantity as seen from the physics perspective.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>28</span>  <span class='chapter-title'>The uniqueness theorem</span>"
    ]
  },
  {
    "objectID": "bvp-domains.html",
    "href": "bvp-domains.html",
    "title": "29  Domains",
    "section": "",
    "text": "The domain \\(\\Omega\\) in which we seek the solution to the Poisson equation, consists of \\(n\\) subdomains \\(\\Omega_i\\), where the union of the subdomains is\n\\[\n\\Omega = \\Omega_1 \\cup \\Omega_2 \\cup \\dots \\cup \\Omega_n\n\\]\nand the intersection of two subdomains is always\n\\[\n\\Omega_i \\cap \\Omega_k = \\emptyset, \\quad i \\ne k.\n\\]\nAcross the individual \\(\\Omega_i\\) the physical parameters, e.g., conductivity, density, are usually constant.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>29</span>  <span class='chapter-title'>Domains</span>"
    ]
  },
  {
    "objectID": "bvp-examples.html",
    "href": "bvp-examples.html",
    "title": "30  Examples",
    "section": "",
    "text": "30.1 Conductive sphere in homogeneous field\nWe consider an electrically conductive sphere embedded in a full-space of uniform conductivity. The sphere is exposed to a uniform electrical field \\(\\vb E_0\\).\nFind the total electrical potential inside and outside of the sphere.\nWe distinguish two potentials: one for the interior and one for the exterior of the sphere. In each subdomain the potential is composed of a primary and a secondary potential.\n\\[\n\\begin{align}\nU_{ex}(r, \\theta) & = U_0 + U_{1}(r, \\theta) \\\\\nU_{in}(r, \\theta) & = U_0 + U_{2}(r, \\theta)\n\\end{align}\n\\]\nIn \\(r=R\\) we enforce continuity of the potential and the current density across the surface of the sphere.\n\\[\n\\begin{align}\nU_{ex}(R, \\theta) & = U_{in}(R, \\theta) \\\\\n\\sigma_1 \\pdv{U_{ex}}{r} & = \\sigma_2 \\pdv{U_{in}}{r}\n\\end{align}\n\\]\nFor the secondary potentials \\(U_i\\) we make the following ansatz\n\\[\nU_{i}(r, \\theta) = \\sum_{n=0}^\\infty f_i(r) P_n(\\cos\\theta), \\quad i=1,2\n\\]",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Examples</span>"
    ]
  },
  {
    "objectID": "bvp-examples.html#conductive-sphere-in-homogeneous-field",
    "href": "bvp-examples.html#conductive-sphere-in-homogeneous-field",
    "title": "30  Examples",
    "section": "",
    "text": "\\(\\vb E_0 = \\vb e_z E_0 = -\\grad U_0\\)\n\\(U_0 = -z E_0 + C_0\\)\nWith \\(C_0 = 0\\) we have:\n\\(U_0(r, \\theta) = -E_0 \\underbrace{r \\cos\\theta}_{=z}\\)",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Examples</span>"
    ]
  },
  {
    "objectID": "bvp-examples.html#choice-of-expansion-degree-n1",
    "href": "bvp-examples.html#choice-of-expansion-degree-n1",
    "title": "30  Examples",
    "section": "30.2 Choice of expansion degree \\(n=1\\)",
    "text": "30.2 Choice of expansion degree \\(n=1\\)\n\nThe external electric field is uniform and introduces only a linear angular dependence proportional to \\(\\cos\\theta\\) which corresponds to the \\(n=1\\) term in the spherical harmonic expansion.\nThe spherical symmetry of the conductive sphere ensures that higher-order terms \\(n \\geq 2\\), which represent quadrupole, octupole, and higher moments, are not induced. The uniform field cannot create these complex angular variations because the sphere’s response is limited to the simplest, symmetric redistribution of charges.\nThe \\(n=0\\) term corresponds to a monopole potential, however, the sphere is neutral as a whole, no net monopole charge is present.\nA homogeneous external field does not induce a monopole moment, as it creates a dipole-like separation of charges.\n\nWe obtain \\(f_i(r)\\) from the conditions\n\n\\(U_i\\) is a solution of the Laplace equation \\(\\Delta U_i = 0\\) in \\(\\Omega_i\\)\n\\(f_1(r) \\to 0\\) for \\(r \\to \\infty\\)\n\\(f_2\\) finite for \\(r \\le R\\)\n\nWe solve the problem using the method of separation of variables and obtain\n\\[\nf_1(r) = a_1 r + b r^{-2}\n\\]\nThe conditions are fulfilled with \\(a_1 = 0\\) in the exterior and \\(b=0\\) in the interior of the sphere.\nWe get from the conditions of continuity the following system\n\\[\n\\begin{align}\n-R E_0 + b R^{-2} & = R a \\\\\n-\\sigma_1 (E_0 + 2 b R^{-3}) & = \\sigma_2 a\n\\end{align}\n\\]\nwith the solutions \\[\na = \\frac{3 \\sigma_1}{2 \\sigma_1 + \\sigma_2} E_0 ,\n\\qquad b = \\frac{\\sigma_2 - \\sigma_1}{2 \\sigma_1 + \\sigma_2} R^3 E_0\n\\]\nThe potentials are\n\\[\n\\begin{align}\nU_{ex} & = \\left(- E_{0} r + \\frac{E_{0} R^{3} \\left(\\sigma_{2} - \\sigma_{1}\\right)}{r^{2} \\left(2 \\sigma_{1} + \\sigma_{2}\\right)} \\right) \\cos\\theta \\\\\nU_{in} & = -E_0 r\\cos\\theta \\frac{3  \\sigma_1 }{2\\sigma_1 + \\sigma_2}\n\\end{align}\n\\]",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Examples</span>"
    ]
  },
  {
    "objectID": "bvp-green.html",
    "href": "bvp-green.html",
    "title": "31  Green’s identities",
    "section": "",
    "text": "31.1 Divergence theorem\nIf \\(U\\) is harmonic in a domain \\(\\Omega\\), i.e., \\(U\\) satisfies Laplace’s equation \\[\n\\nabla^{2}U = 0\n\\] then the surface integral of the normal derivative of  \\(U\\) over the boundary of \\(\\Omega\\) has a special property. Specifically, this integral evaluates to zero under certain conditions.\nFor a harmonic function \\(U\\), the surface integral of its normal derivative over the boundary  \\(\\partial\\Omega\\)  is \\[\n\\int _{\\partial\\Omega} \\frac{ \\partial U }{ \\partial n }  \\, \\dd S = 0\n\\]",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Green's identities</span>"
    ]
  },
  {
    "objectID": "bvp-green.html#divergence-theorem",
    "href": "bvp-green.html#divergence-theorem",
    "title": "31  Green’s identities",
    "section": "",
    "text": "31.1.1 Explanation\nThis results follows from the divergence theorem (or Gauss’ theorem), from which we obtain \\[\n\\int_{\\Omega} \\nabla^{2}U \\, \\dd V = \\int_{\\partial \\Omega} \\nabla U \\cdot \\vb{n} \\, \\dd S\n\\] Since \\(U\\) is harmonic, the volume integral on the left-hand side vanishes. Therefore \\[\n\\int _{\\partial\\Omega} \\frac{ \\partial U }{ \\partial n }  \\, \\dd S = 0\n\\]\n\n\n31.1.2 Implications\nThis result has important consequences in potential theory and physics:\n\nMass Conservation Analogy: The integral represents the net “flux” of  \\(U\\)  through the boundary. For a harmonic function, the flux is zero, analogous to conservation laws.\nBoundary Conditions: If  \\(U\\)  and  \\(\\frac{\\partial U}{\\partial n}\\)  are known on the boundary, they are often constrained by this zero-flux condition.\n\nThis property is a fundamental characteristic of harmonic functions and is widely used in solving boundary value problems.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Green's identities</span>"
    ]
  },
  {
    "objectID": "bvp-green.html#greens-identity",
    "href": "bvp-green.html#greens-identity",
    "title": "31  Green’s identities",
    "section": "31.2 Green’s identity",
    "text": "31.2 Green’s identity\nGreen’s identity can be used to evaluate the value of a potential  \\(U\\)  at a point  \\(\\mathbf{r}_0\\)  in terms of a surface integral over the boundary of a domain. This is commonly referred to as Green’s third identity, which relates the potential  \\(U\\)  at  \\(\\mathbf{r}_0\\)  to its values and normal derivatives on the boundary surface.\nGreen’s third identity is expressed as: \\[\nU(\\mathbf{r}_0) = \\frac{1}{4\\pi} \\int_{\\partial\\Omega} \\left[ U(\\mathbf{r}) \\frac{\\partial G(\\mathbf{r}, \\mathbf{r}_0)}{\\partial n} - G(\\mathbf{r}, \\mathbf{r}_0) \\frac{\\partial U(\\mathbf{r})}{\\partial n} \\right] \\, \\dd S\n\\] where\n\n\\(\\Omega\\) is the surface bounding the domain\n\\(U(\\mathbf{r})\\) is the potential function\n\\(G(\\mathbf{r}, \\mathbf{r}_0)\\) is the Green’s function, which satisfies the Laplace equation and has a singularity at \\(\\mathbf{r} = \\mathbf{r}_0\\)\n\\(\\frac{\\partial}{\\partial n}\\) denotes the derivative in the direction of the outward normal to the surface \\(\\partial\\Omega\\)\n\\(\\dd{S}\\) is the infinitesimal surface element\n\n\n31.2.1 Key points\nGreen’s function: For the Laplace equation, \\(G(\\mathbf{r}, \\mathbf{r}_0)\\) is typically chosen as:\n\\[\nG(\\mathbf{r}, \\mathbf{r}_0) = \\frac{1}{|\\mathbf{r} - \\mathbf{r}_0|}.\n\\]\nInterpretation: Green’s third identity provides a way to reconstruct the potential \\(U(\\mathbf{r}_0)\\) inside the domain if \\(U\\) and its normal derivative \\(\\frac{\\partial U}{\\partial n}\\) are known on the boundary \\(\\partial \\Omega\\) .\nThis identity is particularly useful in solving boundary value problems in electrostatics, fluid mechanics, and other fields where the Laplace equation governs the potential.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Green's identities</span>"
    ]
  },
  {
    "objectID": "bvp-green.html#mean-value-theorem",
    "href": "bvp-green.html#mean-value-theorem",
    "title": "31  Green’s identities",
    "section": "31.3 Mean value theorem",
    "text": "31.3 Mean value theorem\nGauss’ mean value theorem is a fundamental result in potential theory and the study of harmonic functions. It states that the value of a harmonic function at a point is equal to the average of its values over the surface of a sphere centered at that point.\nLet \\(U\\) be a harmonic function in a domain \\(\\Omega\\). For any point \\(\\mathbf{r}_0\\) in \\(\\Omega\\) and any sphere \\(S\\) of radius \\(R\\) centered at \\(\\mathbf{r}_0\\) (with the sphere lying entirely within \\(\\Omega\\)), we have:\n\\[\nU(\\mathbf{r}_0) = \\frac{1}{4\\pi R^2} \\int_{\\partial\\Omega} U(\\mathbf{r}) \\, \\dd{S},\n\\]\nwhere:\n\n\\(\\mathbf{r}_0\\) is the center of the sphere,\n\\(R\\) is the radius of the sphere,\n\\(\\partial \\Omega\\) is the surface of the sphere,\n\\(\\dd{S}\\) is the surface area element on \\(\\partial \\Omega\\),\n\\(U(\\mathbf{r})\\) is the harmonic function.\n\n\n31.3.1 Interpretation\n\nThe theorem says that the value of a harmonic function at the center of a sphere equals the average value of the function over the sphere’s surface.\nThis property characterizes harmonic functions and is often used to prove uniqueness and regularity results for solutions to Laplace’s equation.\n\n\n\n31.3.2 Consequences\n\nMaximum Principle: Since the value at the center of the sphere is an average, a harmonic function cannot have a maximum or minimum inside a domain unless it is constant.\nUniqueness: If two harmonic functions agree on the boundary of a domain, they must agree throughout the domain.\nPhysical Interpretation: In electrostatics, the theorem reflects the fact that the potential at a point inside a charge-free region depends only on its surrounding values, not on interior contributions.\n\n\n\n31.3.3 Uniqueness\nWe consider a sphere \\(\\Omega\\) of radius \\(a\\) and a homogeneous charge density \\(\\rho_{E}\\). For any point inside \\(\\Omega\\) the Poisson equation holds \\[\n\\nabla^{2} U(r) = -\\frac{\\rho_{E}}{\\varepsilon_{0}}, \\quad r \\le a\n\\] On the surface \\(\\partial\\Omega\\) we fix the potential and its normal derivative, such that \\[\nU = 0, \\qquad \\frac{ \\partial U }{ \\partial n } = 0\n\\]\nInside the sphere, we obtain for the potential \\[\nU(r) = \\frac{\\rho_{E}}{2\\varepsilon_{0}}a^{2} - \\frac{\\rho_{E}}{6\\varepsilon_{0}}r^{2}\n\\] whereas for \\(r &gt; a\\) we find \\[\nU(r) = \\frac{\\rho_{E}a^{3}}{3\\varepsilon_{0}r}\n\\]\nFor \\(r=a\\) we obtain \\[\nU(a) = \\frac{\\rho_{E}}{3\\varepsilon_{0}}a^{2} \\qquad \\frac{ \\partial U }{ \\partial n } \\bigg|_{r=a} = -\\frac{\\rho_{E}}{3\\varepsilon_{0}}a\n\\] which is not consistent with the assumption. It follows that the values at the boundary are determined by \\(\\nabla^{2}U\\) alone. A simultaneous choice of \\(U\\) and \\(\\frac{ \\partial U }{ \\partial n }\\) at the boundary overdetermines the problem and typically leaves no room for a solution. Imposing both Dirichlet and Neumann conditions on the same boundary can result in inconsistencies.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Green's identities</span>"
    ]
  },
  {
    "objectID": "bvp-green.html#first-boundary-value-problem",
    "href": "bvp-green.html#first-boundary-value-problem",
    "title": "31  Green’s identities",
    "section": "31.4 First boundary value problem",
    "text": "31.4 First boundary value problem\n\n31.4.1 How can we eliminate the Neumann term in the Green’s third identity?\nWe consider the function \\(U\\) defined on an open domain \\(\\Omega \\subset \\mathbb{R}^{3}\\) \\[\n\\nabla^{2} U(r) = 0\n\\] The goal is to eliminate the term \\(\\dfrac{\\partial U}{\\partial n}\\) from Green’s third identity. \\[\nU(\\mathbf{r}_0) = \\frac{1}{4\\pi} \\int_{\\partial\\Omega} \\left[ U(\\mathbf{r}) \\frac{\\partial }{\\partial n} \\frac{1}{r} -  \\frac{1}{r}  \\frac{\\partial U(\\mathbf{r})}{\\partial n} \\right] \\, \\dd S\n\\]\nWe introduce a harmonic auxiliary function \\(g(\\vb{r},\\vb{r_{0}})\\) such that for any \\(\\vb{r} \\in \\Omega\\) \\[\n\\nabla^{2} g(\\vb{r},\\vb{r_{0}}) = 0\n\\] Further, \\[\ng(\\vb{r},\\vb{r_{0}}) = \\frac{1}{|\\vb{r} - \\vb{r_{0}|}} = \\frac{1}{r}, \\quad \\vb{r_{0}}\\in \\partial\\Omega\n\\]\nGreen’s second identity states \\[\n\\frac{1}{4\\pi}\\int_\\Omega \\left( u \\nabla^2 v - v \\nabla^2 u \\right) \\,\\dd{V} = \\frac{1}{4\\pi} \\int_{\\partial \\Omega} \\left( u \\frac{\\partial v}{\\partial n} - v \\frac{\\partial u}{\\partial n} \\right) \\,\\dd{S}\n\\]\nIf both \\(u\\) and \\(v\\) are harmonic functions, then \\[\n\\frac{1}{4\\pi}\\int_{\\partial \\Omega} \\left( u \\frac{\\partial v}{\\partial n} - v \\frac{\\partial u}{\\partial n} \\right) \\,\\dd{S} = 0\n\\] For \\(u=U\\) and \\(v=g\\) we obtain \\[\n\\frac{1}{4\\pi} \\int_{\\partial \\Omega} \\left( U \\frac{\\partial g}{\\partial n} - g \\frac{\\partial U}{\\partial n} \\right) \\,\\dd{S} = 0\n\\]\nWe subtract this from equation to \\(U(\\vb{r_{0}})\\): \\[\n\\begin{align}\nU(\\vb{r_{0}}) & = \\frac{1}{4\\pi} \\int_{\\partial \\Omega} \\left( U \\frac{\\partial}{\\partial n}\\left( g - \\frac{1}{r} \\right)  - \\left( g - \\frac{1}{r} \\right)  \\frac{\\partial U}{\\partial n} \\right) \\,\\dd{S} \\\\\n& =  \\frac{1}{4\\pi} \\int_{\\partial \\Omega} \\left( U \\frac{\\partial}{\\partial n}\\left( g - \\frac{1}{r} \\right) \\right) \\,\\dd{S}\n\\end{align}\n\\] We denote \\[\nG_{1}(\\vb{r},\\vb{r_{0}})=g(\\vb{r},\\vb{r_{0}})-\\frac{1}{r}\n\\] as Green’s function which satisfies \\[\n\\begin{align}\n\\nabla^{2}G_{1} & = 0 \\text{ in } \\Omega \\\\\nG_{1} & = 0 \\text{ on } \\partial\\Omega\n\\end{align}\n\\]\nNote that for \\(\\vb{r}=\\vb{r_{0}}\\), the Green’s function \\(G_{1}\\) has a singularity.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Green's identities</span>"
    ]
  },
  {
    "objectID": "bvp-green.html#second-exterior-boundary-value-problem",
    "href": "bvp-green.html#second-exterior-boundary-value-problem",
    "title": "31  Green’s identities",
    "section": "31.5 Second (exterior) boundary value problem",
    "text": "31.5 Second (exterior) boundary value problem\nWe restrict \\(\\dfrac{\\partial U}{\\partial n}\\) at the boundary \\(\\partial\\Omega\\). With the Green’s third identity, we are able to find a solution \\(U\\) in the exterior of \\(\\Omega\\) by construction of an auxiliary function \\[\nG_{2} = g - \\frac{1}{r}\n\\] such that \\[\n\\begin{align}\n\\nabla^{2}G_{2} &= 0 \\text{ in } \\Omega \\\\\n\\frac{ \\partial  }{ \\partial n }G_{2} & = 0 \\text{ on } \\partial\\Omega  \n\\end{align}\n\\]\nThe solution in the exterior is \\[\nU(\\vb{r_{0}}) = \\frac{1}{4 \\pi} \\int _{\\partial\\Omega } G_{2}(\\vb{r, \\vb{r_{0}}}) \\frac{\\partial U}{\\partial n}  \\, \\dd S\n\\]",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Green's identities</span>"
    ]
  },
  {
    "objectID": "bvp-green.html#second-interior-bvp",
    "href": "bvp-green.html#second-interior-bvp",
    "title": "31  Green’s identities",
    "section": "31.6 Second (interior) BVP",
    "text": "31.6 Second (interior) BVP\nFor the interior BVP the derivative at the boundary cannot be defined arbitrarily, since both \\[\n\\nabla^{2}U = 0 \\text{ in } \\Omega\n\\] and \\[\n\\int \\frac{\\partial U}{\\partial n}  \\, \\dd S = 0\n\\] must be fulfilled. The same restriction holds for \\(g\\).\nTo eliminate the boundary values of \\(U\\) in Green’s third identity, it is required that \\[\n\\frac{\\partial g}{\\partial n} = \\frac{\\partial }{\\partial n} \\frac{1}{r}\n\\]\nbecause of the property of \\(G_{2}\\) [[#^31751b]]. However, with \\(\\dd{S} = r^{2}\\sin \\theta \\,\\dd{\\theta}\\,\\dd{\\varphi}\\), \\[\n\\int \\frac{\\partial }{\\partial n} \\frac{1}{r} \\, \\dd S = -\\int \\frac{\\cos(\\vb{r},\\vb{n})}{r^{2}} \\, \\dd S = -\\int  \\, \\dd \\Omega = -4 \\pi  \n\\]\nWe have to force that the condition \\[\n\\frac{\\partial g}{\\partial n} = \\frac{\\partial }{\\partial n} \\frac{1}{r} + K\n\\] is fulfilled such that \\[\n\\int \\frac{\\partial g}{\\partial n}   \\, \\dd S = \\int \\frac{\\partial }{\\partial n} \\frac{1}{r} \\, \\dd S = 0\n\\]\nIt follows \\[\nK = \\frac{4 \\pi}{\\int  \\, \\dd S } = \\frac{4 \\pi}{A_{0}}\n\\] and \\[\nU(\\vb{r_{0}}) = \\frac{1}{A_{0}} \\int U \\, \\dd S - \\frac{1}{4\\pi} \\int G_{2}(\\vb{r},\\vb{r_{0}})   \\frac{\\partial U}{\\partial n}  \\, \\dd S   \n\\] The solution of the second BVP is \\[\nU(\\vb{r_{0}}) = C - \\frac{1}{4\\pi} \\int G_{2}(\\vb{r},\\vb{r_{0}})   \\frac{\\partial U}{\\partial n}  \\, \\dd S\n\\] which is uniquely determined up to a constant.\nThe Green’s function \\(G_{2}\\) \\[\nG_{2}(\\vb{r, \\vb{r_{0}}}) = g_{2}(\\vb{r, \\vb{r_{0}}})-\\frac{1}{r}\n\\] is harmonic for \\(\\vb{r} \\ne \\vb{r_{0}}\\), such that it holds \\[\n\\begin{align}\n\\nabla^{2}G_{2}(\\vb{r},\\vb{r_{0}}) & = 0 \\text{ for } \\vb{r} \\ne \\vb{r_{0}} \\\\\n\\frac{\\partial G_{2}}{\\partial n} & = \\frac{4 \\pi}{A_{0}}\n\\end{align}\n\\]",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Green's identities</span>"
    ]
  },
  {
    "objectID": "bvp-applications.html",
    "href": "bvp-applications.html",
    "title": "32  Applications",
    "section": "",
    "text": "32.1 Method of mirrors\nWe consider the second BVP (Neumann problem) for the half-space. Because of \\(\\sigma_{air} \\approx 0\\) we set at \\(z=0\\) (Air-Earth interface) \\[\n\\frac{\\partial U}{\\partial n} = 0\n\\] A point electrode carrying a current of \\(I\\) located at the point \\(\\vb{r_{0}}=(x_{0}, y_{0}, 0)^\\top\\) causes a potential at point \\(\\vb{r}\\) \\[\nU(\\vb{r}) = \\frac{\\rho I}{2 \\pi |\\vb{r} - \\vb{r_{0}} |}\n\\] where \\(\\rho\\) is the resistivity of the homogeneous half-space.\nWhen the current electrode is at a depth \\(t\\) inside the half-space, i.e., at the point \\(\\vb{r_{1}} = (x_{0}, y_{0}, t)^\\top, t &gt; 0\\), we can calculate the potential by means of the method of mirrors.\nIn \\(z=0\\) we observe \\[\n\\vb{e}_{z} \\cdot \\vb{E} = -\\vb{e}_{z} \\cdot \\nabla U = - \\frac{\\partial U}{\\partial z} = 0\n\\]\nWe can construct an auxiliary Green’s function that generates the desired behavior in \\(z=0\\) by introducing a mirror source at \\(\\vb{r_{2}} = (x_{0}, y_{0}, -t)^\\top\\). We follow these steps:\nThe potential function \\[\nU(\\vb{r}) = \\frac{\\rho I}{4 \\pi} \\left( \\frac{1}{|\\vb{r}-\\vb{r_{1}} |}+\\frac{1}{|\\vb{r}-\\vb{r_{2}} |} \\right)\n\\] satisfies the Neumann condition in \\(z=0\\) as well as \\(\\nabla^{2}U=0\\), Further, \\(U(\\vb{r}) \\to 0\\) for \\(| \\vb{r}| \\to \\infty\\).\nQuestion: May we apply the method of mirrors when the upper half-space is a conductor?\nWhen observing the potential in the lower half-space \\(z&gt;0\\), we introduce a fictitious current source with current \\(I'\\) at \\(z=-t\\). We observe a superposition of both sources in \\(z&gt;0\\): \\[\nU_{1}(P_{1}) = \\frac{\\rho_{1}I}{4 \\pi |\\vb{r} - \\vb{r}_{1}|} + \\frac{\\rho I'}{4 \\pi |\\vb{r} - \\vb{r}_{2}|}\n\\] with \\[\n\\begin{align}\nR_{1} & = |\\vb{r} - \\vb{r}_{1}| = \\sqrt{ (x - x_{1})^{2} + (y - y_{1})^{2} + (z - t)^{2}} \\\\\nR_{2} & = |\\vb{r} - \\vb{r}_{2}| = \\sqrt{ (x - x_{2})^{2} + (y - y_{2})^{2} + (z + t)^{2}}\n\\end{align}\n\\]\nWhen the point of observation is in the upper half-space, we introduce another fictitious source with strength \\(I''\\) at \\(z=t\\) and obtain \\[\nU_{2}(P_{2}) = \\frac{\\rho_{2}I''}{4 \\pi |\\vb{r} - \\vb{r}_{3}|}\n\\] The two currents \\(I'\\) and \\(I''\\) are still unknown. We need the conditions of contnuity in \\(z=0\\) to determine these two currents.\nIn \\(z=0\\) there holds \\[\n\\begin{align}\nU_{1} & = U_{2} \\\\\n\\sigma_{1} \\frac{ \\partial U_{1} }{ \\partial z }  & = \\sigma_{2} \\frac{ \\partial U_{2} }{ \\partial z }\n\\end{align}\n\\] If we move the observation point into the plane \\(z=0\\), then \\(R_{1} = R_{2} = R_{3}\\). It follows \\[\n\\rho_{1}I' - \\rho_{2}I'' = -\\rho_{1}I\n\\] From the second condition we obtain \\[\nI' + I'' = I\n\\]\nFinally, we get \\[\n\\begin{align}\nI' & = \\frac{\\rho_{2}-\\rho_{1}}{\\rho_{1}+\\rho_{2}}I = k_{12}I \\\\\nI'' & = \\frac{2\\rho_{1}}{\\rho_{1}+\\rho_{2}}I = t_{12}I\n\\end{align}\n\\] The coefficients \\(k_{12}\\) and \\(t_{12}\\) are referred to as coefficient of reflection and coefficient of transmission, resp. It holds \\[\nt_{12} = 1 - k_{12}, \\quad -1 \\le k_{12} \\le 1\n\\] If the upper half-space is an ideal conductor, i.e., \\(\\rho_{2}=0\\), then \\(k_{12}=-1\\). When \\(\\rho_{2} \\to \\infty\\), then \\(k_{12}=1\\).\nWe conclude that \\[\n\\begin{align}\nU_{1} & = \\frac{\\rho_{1}I}{4 \\pi} \\left( \\frac{1}{R_{1}} + \\frac{k_{12}}{R_{2}} \\right)  \\\\\nU_{2} & = \\frac{\\rho_{2}I}{4 \\pi R_{3}} \\frac{2 \\rho_{1}}{\\rho_{1}+\\rho_{2}} = \\frac{\\rho_{m}I}{4 \\pi R_{3}}\n\\end{align}\n\\] with \\[\n\\rho_{m} = \\frac{2 \\rho_{1} \\rho_{2}}{\\rho_{1} + \\rho_{2}} = \\left[ \\frac{\\sigma_{1}+\\sigma_{2}}{2}  \\right] ^{-1}\n\\] The potential in the upper half-space is that of a homogeneous full-space with a resistivity \\(\\rho_{m}\\).",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Applications</span>"
    ]
  },
  {
    "objectID": "bvp-applications.html#method-of-mirrors",
    "href": "bvp-applications.html#method-of-mirrors",
    "title": "32  Applications",
    "section": "",
    "text": "mirror the source in \\(z=t &lt; 0\\) at plane \\(z=0\\)\nresulting in mirror source at \\(z=-t\\)\nreplace the resistivity of the insulating half-space by the resistivity of the lower half-space\ninject the same current \\(I\\) at both (real and mirrored) sources\nobserve no-flow through \\(z=0\\)",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Applications</span>"
    ]
  },
  {
    "objectID": "bvp-applications.html#a-conducting-semi-sphere-as-an-electrode",
    "href": "bvp-applications.html#a-conducting-semi-sphere-as-an-electrode",
    "title": "32  Applications",
    "section": "32.2 A conducting semi-sphere as an electrode",
    "text": "32.2 A conducting semi-sphere as an electrode\nWe consider a uniform halfspace with resistivity \\(\\rho_2\\). There is a point source \\(I\\) located at the origin. The semi-sphere of radius \\(a\\) has a resistivity of \\(\\rho_1\\). The semi-sphere is aligned with the \\(z\\)-axis. The upper half-space is insulating, we impose a Neumann boundary condition in \\(z=0\\).\nGoal: Find the potential inside and outside of the semi-sphere.\n\nWe make the ansatz:\n\\[\n\\begin{align}\nU_1(r) &= \\frac{\\rho_1 I}{2 \\pi r} + U_{0} \\qquad & r &lt; a \\\\\nU_2(r) &= \\frac{\\rho_2 I'}{2 \\pi r} \\qquad & r &gt; a\n\\end{align}\n\\]\nQ: What’s the rationale behind this ansatz?\nTo solve for the unknowns \\(U_{0}\\) and \\(I'\\) we need the conditions of continuity at the surface of the semisphere, where \\(r=a\\):\n\\[\n\\begin{align}\nU_1 & = U_2 \\\\\n\\frac{1}{\\rho_1} \\partial_r U_1 & = \\frac{1}{\\rho_2} \\partial_r U_2\n\\end{align}\n\\]\nWe first carry out the differentiation and then replace \\(r\\) with \\(a\\) to find \\[\n\\begin{align}\n\\frac{\\rho_{1}I}{2 \\pi a} + U_{0} & = \\frac{\\rho_{2}I'}{2 \\pi a} \\\\\n-\\frac{I}{2 \\pi a^{2}} & = -\\frac{I'}{2 \\pi a^{2}}\n\\end{align}\n\\] which simplifies to \\[\nI' = I\n\\] and \\[\nU_{0} = \\frac{(\\rho_{2}-\\rho_{1})I}{2 \\pi a}\n\\]\n\n32.2.1 Summary of the result\n\\[\n\\begin{align}\nU_{1}(r)  & = \\frac{\\rho_{1}I}{2 \\pi r} + \\frac{(\\rho_{2}-\\rho_{1})I}{2 \\pi a} \\\\\nU_{2}(r) & = \\frac{\\rho_{2}I}{2 \\pi r}\n\\end{align}\n\\]\n\n\n32.2.2 Explanation\nThe potential inside the semi-sphere is composed of two contributions:\n\nthe potential due to the point source\nthe potential caused by charge accumulation across the surface of the semi-sphere\n\nThe latter is constant.\n\n\n32.2.3 Visualization\n\n\nShow the code\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nrho1 = 1.0\nrho2 = 100.0\na = 1.0\ndef U1(r):\n    u = rho1 / (2 * np.pi * r) + (rho2 - rho1) / (2 * np.pi * a)\n    return u\n\ndef U2(r):\n    u = rho2 / ( 2 * np.pi * r)\n    return u\nR1 = np.linspace(start=0.1, stop=a, num=41)\nR2 = np.linspace(start=a, stop=10.0, num=41)\n\nplt.plot(R1, [U1(r) for r in R1])\nplt.plot(R2, [U2(r) for r in R2])\nplt.grid(True)\nplt.title('Potential')\nplt.xlabel('r in m');\n\n\n\n\n\n\n\n\n\nWe observe that the potential is continuous in \\(r=a\\).\n\n\nShow the code\nplt.plot(R1, [1 / (2 * np.pi * r**2) for r in R1])\nplt.plot(R2, [1 / (2 * np.pi * r**2) for r in R2])\nplt.grid(True)\nplt.title('Current density')\nplt.xlabel('r in m');\n\n\n\n\n\n\n\n\n\n\n\nShow the code\nplt.plot(R1, [rho1 / (2 * np.pi * r**2) for r in R1])\nplt.plot(R2, [rho2 / (2 * np.pi * r**2) for r in R2])\nplt.grid(True)\nplt.title('Electric field')\nplt.xlabel('r in m');\n\n\n\n\n\n\n\n\n\nThe field only has a normal component w.r.t. the surface of the semi-sphere. Therefore, we observe a discontinuity in the order of the jump in resistivities.",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Applications</span>"
    ]
  },
  {
    "objectID": "bvp-applications.html#the-two-layer-case",
    "href": "bvp-applications.html#the-two-layer-case",
    "title": "32  Applications",
    "section": "32.3 The two-layer case",
    "text": "32.3 The two-layer case\nWe consider the case when the half-space is composed of two layers with distinct resistivities \\(\\rho_1\\) and \\(\\rho_2\\). The thickness of layer 1 is \\(h\\).\n\nWe calculate the potential \\(V\\) at the surface of the half-space.\nLet’s first assume that \\(h \\to \\infty\\). Then the potential in the top-layer is that of a homogeneous half-space\n\\[\nV(r) = \\frac{\\rho_{1} I}{2 \\pi r}\n\\]\nHowever, when the thickness of the top-layer is finite, we observe a superposition of the potential of a homogeneous half-space and a potential caused by the basement layer.\n\nWe introduce a mirror source at \\(z=2h\\) and get\n\\[\nV'(r) = \\frac{I \\rho_{1}}{2 \\pi} \\left( \\frac{1}{r} + \\frac{k_{12}}{r_{1}}\\right)\n\\]\nwith\n\\[\nk_{12} = \\frac{\\rho_{2} - \\rho_{1}}{\\rho_{2} + \\rho_{1}}\n\\]\nThe mirror source is not consistent with the Neumann boundary condition at \\(z=0\\).\nWe introduce a further mirror at \\(z=-2h\\) and obtain\n\\[\nV'' = \\frac{I \\rho_{1}}{2 \\pi} \\left( \\frac{k_{12} \\cdot k_{10}}{r_{1}} \\right) \\approx \\frac{I \\rho_{1}}{2 \\pi} \\frac{k_{12}}{r_{1}}\n\\]\nwith\n\\[\nk_{10} = \\frac{\\rho_{0} - \\rho_{1}}{\\rho_{0} + \\rho_{1}} \\approx 1\n\\]\n\\[\nV' + V'' = \\frac{I \\rho_{1}}{2 \\pi} \\left( \\frac{1}{r} + \\frac{2 k_{12}}{r_{1}} \\right)\n\\]\n\\[\nV''' = \\frac{I \\rho_{1}}{2 \\pi} \\left( \\frac{k_{12} \\cdot k_{12}}{r_{2}} \\right)\n\\]\nwith\n\\[\n\\begin{align}\nr_{1} & = \\sqrt{ r^{2} + (2z)^{2} } \\\\\nr_{2} & = \\sqrt{ r^{2} + (4z)^{2} } \\\\\nr_{m} & = \\sqrt{ r^{2} + (2mz)^{2} }\n\\end{align}\n\\]\nThe mirror at \\(z=-4h\\) results in\n\\[\nV''' + V^{(4)} = \\frac{I \\rho_{1}}{2 \\pi} \\left( \\frac{k_{12} \\cdot k_{12}}{r_{2}} + \\frac{k_{12} \\cdot k_{12} \\cdot k_{10}}{r_{2}} \\right) \\approx \\frac{I \\rho_{1}}{2 \\pi} \\left( \\frac{2k_{12}^{2}}{r_{2}} \\right)\n\\]\nThe resulting potential is\n\\[\nV = \\frac{I \\rho_{1}}{2 \\pi} \\left( \\frac{1}{r} + \\frac{2k_{12}}{r_{1}} + \\frac{2 k_{12}^{2}}{r_{2}} + \\dots + \\frac{2 k_{12}^{m}}{r_{m}} + \\dots \\right)\n\\]\nor in compact form\n\\[\nV = \\frac{I \\rho_{1}}{2 \\pi} \\left( \\frac{1}{r} + 2 \\sum_{m=1}^{\\infty} \\frac{k_{12}^{m}}{\\sqrt{ r^{2} + (2 m z)^{2} }} \\right)\n\\]\nThe first term represents the normal potemtial, while the summation provides the effect of the anomalous potential caused by the finite thickness \\(h\\).\nThe series converges because \\(|k_{12}|&lt;1\\).\nFurther, the denominator increases with increasing \\(m\\).\nNumerical implementation: The amount of terms in the summation depends on \\(k_{12}\\) and \\(z/r\\).",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Applications</span>"
    ]
  },
  {
    "objectID": "bvp-applications.html#resistivity-sounding-over-an-n-layered-half-space",
    "href": "bvp-applications.html#resistivity-sounding-over-an-n-layered-half-space",
    "title": "32  Applications",
    "section": "32.4 Resistivity sounding over an \\(N\\)-layered half-space",
    "text": "32.4 Resistivity sounding over an \\(N\\)-layered half-space\nWe consider the \\(N\\)-layered case for DC resistivity applications.\nFor the solution of the problem, the method of mirrors seems tedious due to the vast amount of mirror sources to be considered.\nA more practical method is based on the solution of the Laplace equation in an appropriate coordinate system. We choose a cylindrical coordinate system.\n\nIn cylindrical coordinates with axial symmetry, the Laplace equation reads \\[\n\\Delta U = \\frac{1}{r} \\frac{ \\partial U }{ \\partial r } \\left(r \\frac{ \\partial U }{ \\partial r }\\right) + \\frac{ \\partial^{2} U }{ \\partial z^{2} } = 0\n\\] We choose the method of separation of variables: \\[\nU(r,z) = F(r, \\lambda) \\cdot Z(z, \\lambda)\n\\] and enforce \\[\nU \\to 0 \\text{ for } R \\to \\infty\n\\] where \\(R^{2} = r^{2} + z^{2}\\).\nInserting into the Laplace equation yields \\[\n\\underbrace{ \\frac{1}{rF} \\frac{ \\mathrm d }{ \\mathrm dr }  \\left( r \\frac{ \\mathrm dF }{ \\mathrm dr }   \\right) }_{ =-\\lambda^{2} } + \\underbrace{ \\frac{1}{Z}  \\frac{ \\mathrm d^{2} Z }{ \\mathrm dz^{2} } }_{ =+\\lambda^{2} } = 0\n\\tag{32.1}\\]\nwith the separation parameter \\(\\lambda\\). The first term is \\[\nF'' + \\frac{1}{r} F' + \\lambda^{2} F = 0\n\\] which is referred to as Bessel differential equation, which has the solution \\[\nF(r, \\lambda) = C(\\lambda)J_{0}(\\lambda r) + D(\\lambda)N_{0}(\\lambda r)\n\\] Since \\(N_{0}(\\lambda r)\\) has a singularity at \\(r=0\\), we discard it by setting \\(D(\\lambda)=0\\) for all \\(\\lambda\\).\nThe second term in 32.1 describes an exponential decay: \\[\nZ'' - \\lambda^{2}Z = 0\n\\] Its solution is \\[\nZ(z, \\lambda) = A(\\lambda) e^{ -\\lambda z } + B(\\lambda) e^{ +\\lambda z }\n\\] Finally, \\[\nU_{i}(r,z) = \\frac{\\rho_{1}I}{2 \\pi } \\int_{0}^{\\infty} \\left( A_{i} e^{ -\\lambda z } + B_{i}e^{ +\\lambda z } \\right) J_{0}(\\lambda r) \\, \\dd \\lambda\n\\] This is the secondary potential function of layer \\(i\\) which is caused by the layered half-space and adds to the primary potential \\(U_{0}(r,z)\\) of a homogeneous half-space of resistivity \\(\\rho_{1}\\).\nFor \\(U_{0}\\) it holds \\[\n\\begin{align}\nU_{0}(r,z) & = \\frac{\\rho_{1}I}{2 \\pi R} = \\frac{\\rho_{1}I}{2 \\pi} \\frac{1}{\\sqrt{ r^{2}+z^{2} }} \\\\\n& = \\frac{\\rho_{1}I}{2 \\pi} \\int_{0}^{\\infty} e^{ -\\lambda z } J_{0}(\\lambda r) \\, \\dd \\lambda\n\\end{align}\n\\] The integral is the well-known Weber-Lipschitz integral.\nFor \\(n=1\\) we find for the total potential \\[\nU_{1}(r,z) = U_{0}(r,z) + \\frac{\\rho_{1}I}{2 \\pi} \\int_{0}^{\\infty} \\left[ A_{1}(\\lambda)e^{ -\\lambda z } + B_{1}(\\lambda)e^{ +\\lambda z }) \\right] J_{0}(\\lambda r) \\, \\dd \\lambda\n\\] Inside the basement layer with index \\(i=n\\) it holds for the secondary potential \\[\nU_{n}(r,z) = \\frac{\\rho_{1}I}{2 \\pi} \\int_{0}^{\\infty} A_{n}(\\lambda)e^{ -\\lambda z } J_{0}(\\lambda r)\\, \\dd \\lambda\n\\] Here we restrict the solution such that \\[\nU_{n} \\to 0 \\text{ for } (r,z) \\to \\infty\n\\] which holds for \\(B_{n}(\\lambda)=0\\).\nIt remains to determine the \\(2n-1\\) unknowns \\(A_{1}, B_{1}, \\dots, A_{n}\\).\nAt the layer boundaries \\(z=z_{i}, i=1,2,\\dots,n-1\\) we apply the usual conditions of continuity for the potential and the vertical component of the current density. These \\(2n-2\\) conditions have to be completed with the condition \\[\n\\frac{ \\partial U_{1} }{ \\partial z } = 0 \\text{ in } z=0\n\\] from which we obtain from the secondary potential \\[\nA_{1}(\\lambda) = B_{1}(\\lambda)\n\\]\nWe consider now the case \\(n=2\\). The layer boundary is in \\(z=h\\).\nThe potential in the first layer is \\[\nU_{1}(r,z) = \\frac{\\rho_{1}I}{2 \\pi} \\int_{0}^{\\infty} \\left[ (1 + A_{1}(\\lambda))e^{ -\\lambda z } + A_{1}(\\lambda)e^{ +\\lambda z }) \\right] J_{0}(\\lambda r) \\, \\dd \\lambda\n\\] For the second layer we obtain \\[\nU_{2}(r,z) = \\frac{\\rho_{1}I}{2 \\pi} \\int_{0}^{\\infty} A_{2}(\\lambda)e^{ -\\lambda z } J_{0}(\\lambda r)\\, \\dd \\lambda\n\\]\nThe conditions in \\(z=h\\) are \\[\n\\begin{align}\nU_{1} & = U_{2} \\\\\n\\frac{1}{\\rho_{1}} \\frac{ \\partial U_{1} }{ \\partial z }  & = \\frac{1}{\\rho_{2}} \\frac{ \\partial U_{2} }{ \\partial z }\n\\end{align}\n\\] from which we obtain \\[\nA_{1}(\\lambda) = k_{12} \\frac{e^{ -2 h \\lambda }}{1 - k_{12}e^{ -2 h \\lambda }}\n\\] and \\[\nA_{2}(\\lambda) = t_{12} \\frac{1}{1 - k_{12}e^{ -2 h \\lambda }}\n\\] where \\[\nk_{12} = \\frac{\\rho_{2}-\\rho_{1}}{\\rho_{2}+\\rho_{1}}\n\\] and \\[\nt_{12} = \\frac{2 \\rho_{2}}{\\rho_{1}+\\rho_{2}}\n\\] For \\(z=0\\) we find \\[\n\\begin{align}\nU_{1}(r,0)  & = \\frac{\\rho_{1}I}{2 \\pi} \\int_{0}^{\\infty} \\left( 1 + 2 A_{1}(\\lambda) \\right) J_{0}(\\lambda r)  \\, \\dd \\lambda   \\\\\n& = \\frac{\\rho_{1}I}{2 \\pi} \\left\\{ \\frac{1}{r} +  2\\int_{0}^{\\infty} A_{1}(\\lambda)  J_{0}(\\lambda r)  \\, \\dd \\lambda\\right\\}\n\\end{align}\n\\] The integral is known as Stefanescu integral. The kernel function \\[\nA_{1} = A_{1}(\\lambda, \\rho_{1}, \\rho_{2}, h)\n\\] contains all information about the subsurface.\nRecall that \\(|k_{12}| &lt; 1\\). With \\[\nx:= k_{12}e^{ -2 h \\lambda }\n\\] we can rewrite the kernel function as \\[\nA_{1} = \\frac{x}{1-x}\n\\] For small \\(x\\) we expand this into a series \\[\n\\frac{x}{1-x} \\approx x + x^{2} + x^{3} \\dots = \\sum_{m=1}^{\\infty}x^{m} \\quad\\text{ for } |x|&lt;1\n\\] We recognize \\[\nA_{1} = \\sum_{m=1}^{\\infty} \\left( k_{12}e^{ -2 h \\lambda } \\right) ^{m}\n\\] For \\(U_{1}\\) we obtain \\[\nU_{1}(r,z) = \\frac{\\rho_{1}I}{2 \\pi} \\left\\{ \\frac{1}{r} + 2 \\int_{0}^{\\infty} J_{0}(\\lambda r) \\sum_{m=1}^{\\infty} \\left( k_{12}e^{ -2 h \\lambda } \\right) ^{m} \\, \\dd \\lambda  \\right\\}\n\\] From the Weber-Lipschitz integral we know that, with \\(z=2 h m\\), \\[\n\\frac{1}{\\sqrt{ r^{2} + 4 h^{2} m^{2}}} = \\int_{0}^{\\infty} e^{ -2 h m \\lambda } J_{0}(\\lambda r) \\, \\dd \\lambda\n\\] It follows after rearranging the order of integration and summation, that \\[\nU_{1}(r,z) = \\frac{\\rho_{1}I}{2 \\pi} \\left\\{ \\frac{1}{r} + 2 \\sum_{m=1}^{\\infty} \\frac{k_{12}^{m}}{\\sqrt{ r^{2}+4 m^{2}h^{2} }} \\right\\}\n\\]\nThis reproduces the result obtained formerly with the help of the method of mirrors for the two-layered case.\n\nFor \\(n&gt;2\\) we can exploit a recursion algorithm. We define \\[\nT_{1} = \\rho_{1}(1+2A_{1})\n\\] with \\[\n\\begin{align}\nT_{n} & = \\rho_{n} \\\\\nT_{i} & = \\frac{T_{i+1} + \\rho_{i}\\tanh(\\lambda d_{i})}{1 + \\sigma_{i}T_{i+1}\\tanh(\\lambda d_{i})} \\\\\nd_{i} & = z_{i} - z_{i-1}\n\\end{align}\n\\] It follows \\[\nU_{1}(r,0) = \\frac{I}{2 \\pi} \\int_{0}^{\\infty} T_{1}(\\lambda) J_{0}(\\lambda r)\\, \\dd \\lambda\n\\tag{32.2}\\]\n\n32.4.1 Apparent resistivity\nIn the Schlumberger array we have \\[\n\\rho_{a} = -\\frac{2\\pi r^{2}}{I} \\frac{ \\mathrm dU }{ \\mathrm dr } \\bigg|_{r=s}\n\\tag{32.3}\\]\nwhere \\(s = \\dfrac{L}{2}\\) is the half electrode spacing. Obtaining the gradient from 32.2 and substituting in 32.3 we have \\[\n\\rho_{a} = s^{2} \\int_{0}^{\\infty} T_{1}J_{1}(\\lambda s) \\lambda \\, \\dd \\lambda\n\\]\nThis integral can be evaluated after applying a transformation of the variables \\[\n\\begin{align}\nr & = r_{0}e^{ x } \\\\\n\\lambda r_{0} & = e^{ -y } \\\\\n\\lambda r  & = e^{ x-y }\n\\end{align}\n\\] which yields a convolutional integral \\[\n\\rho_{a}(x) = \\int_{-\\infty}^{\\infty} \\hat{T}(y) \\hat{J}(x-y) \\, \\dd y\n\\] The numerical quadrature can be evaluated by a truncated sum \\[\n\\rho_{a,k} = \\sum_{i=-n_{1}}^{n_{2}} a_{i}T_{k-i}\n\\] where the \\(a_{i}\\) are pre-calculated filter coefficients approximating the action of \\(\\hat{J}\\) on \\(\\hat{T}\\).",
    "crumbs": [
      "Boundary value problems",
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Applications</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "Summary",
    "section": "",
    "text": "WIP",
    "crumbs": [
      "Summary"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Blakely, R.J., 1995. Potential Theory in\nGravity and Magnetic Applications, 1st\ned., Cambridge University Press. doi:10.1017/CBO9780511549816\n\n\nDziewonski, A.M. & Anderson, D.L., 1981. Preliminary reference\nEarth model. Physics of the Earth and Planetary\nInteriors, 25, 297–356. doi:10.1016/0031-9201(81)90046-7",
    "crumbs": [
      "References"
    ]
  }
]